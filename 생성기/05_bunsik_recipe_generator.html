<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>분식 레시피 생성</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        .download-btn {
            background-color: #FF4500;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 10px;
            transition: background-color 0.3s;
        }
        .download-btn:hover {
            background-color: #FF6347;
        }
        .download-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .status {
            margin: 20px 0;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .processing {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>분식 상세 레시피</h1>
        <div id="status" class="status processing">레시피 파일을 생성 중입니다...</div>
        <button id="downloadBtn" class="download-btn" disabled onclick="downloadRecipe()">
            분식_상세레시피.xlsx 다운로드
        </button>
    </div>

    <script>
        // 분식 상세메뉴 데이터
        const detailMenus = [
            {name: "국물떡볶이", category: "떡볶이", visual: "빨간 국물, 떡, 어묵, 뜨거운 김"},
            {name: "로제떡볶이", category: "떡볶이", visual: "크림색 분홍 국물, 부드러운 맛"},
            {name: "치즈떡볶이", category: "떡볶이", visual: "치즈 토핑, 쭉쭉 늘어나는 치즈"},
            {name: "참치김밥", category: "김밥", visual: "둥근 김밥, 참치 노란색"},
            {name: "불고기김밥", category: "김밥", visual: "둥근 김밥, 갈색 불고기"},
            {name: "야채김밥", category: "김밥", visual: "둥근 김밥, 다양한 색깔 야채"},
            {name: "오징어튀김", category: "튀김류", visual: "바삭한 튀김옷, 노란색"},
            {name: "야채튀김", category: "튀김류", visual: "바삭한 튀김옷, 야채 색깔"},
            {name: "만두", category: "튀김류", visual: "바삭한 튀김만두, 노란색"},
            {name: "잔치국수", category: "국수", visual: "맑은 육수, 가느다란 소면"},
            {name: "멸치국수", category: "국수", visual: "맑은 멸치육수, 소면"},
            {name: "온면", category: "국수", visual: "따뜻한 국물, 면"}
        ];

        // 레시피 데이터 생성 함수들
        function generateIngredients() {
            const ingredients = [
                ["식재료"].concat(detailMenus.map(m => m.name))
            ];

            const ingredientData = {
                "떡볶이떡": ["400g", "400g", "400g", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "어묵": ["200g", "200g", "200g", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "김": ["-", "-", "-", "10장", "10장", "10장", "-", "-", "-", "-", "-", "-"],
                "밥": ["-", "-", "-", "3공기", "3공기", "3공기", "-", "-", "-", "-", "-", "-"],
                "참치캔": ["-", "-", "-", "1캔", "-", "-", "-", "-", "-", "-", "-", "-"],
                "불고기": ["-", "-", "-", "-", "200g", "-", "-", "-", "-", "-", "-", "-"],
                "오징어": ["-", "-", "-", "-", "-", "-", "1마리", "-", "-", "-", "-", "-"],
                "만두": ["-", "-", "-", "-", "-", "-", "-", "-", "10개", "-", "-", "-"],
                "소면": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "300g", "300g", "300g"],
                "양파": ["1/2개", "1/2개", "1/2개", "1/2개", "1/2개", "1/2개", "1/4개", "1/2개", "-", "1/4개", "1/4개", "1/4개"],
                "대파": ["2대", "2대", "2대", "1대", "1대", "1대", "-", "-", "-", "2대", "2대", "2대"],
                "당근": ["-", "-", "-", "1/2개", "1/2개", "1/2개", "-", "1/2개", "-", "-", "-", "-"],
                "시금치": ["-", "-", "-", "1봉", "1봉", "1봉", "-", "-", "-", "-", "-", "-"],
                "단무지": ["-", "-", "-", "적당량", "적당량", "적당량", "-", "-", "-", "-", "-", "-"],
                "계란": ["-", "-", "-", "3개", "3개", "3개", "-", "-", "-", "1개", "1개", "1개"],
                "치즈": ["-", "-", "100g", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "우유": ["-", "1/2컵", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "양배추": ["-", "-", "-", "-", "-", "1/4개", "-", "1/4개", "-", "-", "-", "-"],
                "호박": ["-", "-", "-", "-", "-", "-", "-", "1/2개", "-", "-", "-", "-"],
                "고구마": ["-", "-", "-", "-", "-", "-", "-", "1개", "-", "-", "-", "-"],
                "마늘": ["3쪽", "3쪽", "3쪽", "2쪽", "3쪽", "2쪽", "2쪽", "2쪽", "-", "2쪽", "3쪽", "2쪽"]
            };

            Object.keys(ingredientData).forEach(ingredient => {
                ingredients.push([ingredient].concat(ingredientData[ingredient]));
            });

            return ingredients;
        }

        function generateSauces() {
            const sauces = [
                ["양념/소스"].concat(detailMenus.map(m => m.name))
            ];

            const sauceData = {
                "고추장": ["3큰술", "2큰술", "3큰술", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "고춧가루": ["1큰술", "1작은술", "1큰술", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "간장": ["2큰술", "1큰술", "2큰술", "1큰술", "2큰술", "1큰술", "1큰술", "1큰술", "-", "1큰술", "2큰술", "1큰술"],
                "설탕": ["2큰술", "1큰술", "2큰술", "1작은술", "1큰술", "1작은술", "-", "-", "-", "-", "-", "-"],
                "올리고당": ["1큰술", "1큰술", "1큰술", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "참기름": ["1큰술", "1큰술", "1큰술", "2큰술", "2큰술", "2큰술", "-", "-", "-", "-", "-", "-"],
                "식용유": ["2큰술", "2큰술", "2큰술", "적당량", "적당량", "적당량", "튀김용", "튀김용", "튀김용", "-", "-", "-"],
                "소금": ["적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "-", "적당량", "적당량", "적당량"],
                "다진마늘": ["1큰술", "1큰술", "1큰술", "1큰술", "2큰술", "1큰술", "1큰술", "1큰술", "-", "1큰술", "1큰술", "1큰술"],
                "마요네즈": ["-", "-", "-", "2큰술", "-", "1큰술", "-", "-", "-", "-", "-", "-"],
                "생크림": ["-", "1/2컵", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "튀김가루": ["-", "-", "-", "-", "-", "-", "1컵", "1컵", "-", "-", "-", "-"],
                "물": ["2컵", "2컵", "2컵", "-", "-", "-", "적당량", "적당량", "-", "6컵", "6컵", "6컵"],
                "국간장": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "1큰술", "1큰술", "1큰술"],
                "후추": ["-", "-", "-", "조금", "조금", "조금", "조금", "조금", "-", "조금", "조금", "조금"]
            };

            Object.keys(sauceData).forEach(sauce => {
                sauces.push([sauce].concat(sauceData[sauce]));
            });

            return sauces;
        }

        function generateBroth() {
            const broth = [
                ["육수/베이스"].concat(detailMenus.map(m => m.name))
            ];

            const brothData = {
                "물": ["2컵", "2컵", "2컵", "-", "-", "-", "-", "-", "-", "6컵", "6컵", "6컵"],
                "멸치": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "10마리", "15마리", "10마리"],
                "다시마": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "2조각", "2조각", "2조각"],
                "떡볶이육수": ["기본", "기본", "기본", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "사골육수": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "선택사항"]
            };

            Object.keys(brothData).forEach(item => {
                broth.push([item].concat(brothData[item]));
            });

            return broth;
        }

        function generateCookingSteps() {
            const steps = [];
            
            // 메뉴별로 개별 조리순서 생성 (단계 수가 다름)
            const cookingSteps = {
                "국물떡볶이": [
                    "1단계: 떡볶이떡 400g을 찬물에 10분간 불려 부드럽게 만든다",
                    "2단계: 어묵 200g을 적당한 크기로 썰고, 양파 1/2개와 대파 2대를 썬다",
                    "3단계: 냄비에 물 2컵을 넣고 멸치와 다시마로 간단한 육수를 우린다",
                    "4단계: 고추장 3큰술, 고춧가루 1큰술, 간장 2큰술, 설탕 2큰술, 올리고당 1큰술을 섞어 양념장을 만든다",
                    "5단계: 육수에 양념장을 풀고 떡을 넣어 중불에서 끓인다",
                    "6단계: 떡이 말랑해지면 어묵과 양파를 넣고 5분 더 끓인다",
                    "7단계: 국물이 적당히 졸아들면 대파와 참기름을 넣어 완성한다"
                ],
                "로제떡볶이": [
                    "1단계: 기본 떡볶이와 동일하게 떡과 어묵을 준비한다",
                    "2단계: 고추장 2큰술(기본보다 적게), 간장, 설탕으로 양념장을 만든다",
                    "3단계: 떡볶이를 기본 방법으로 끓인다",
                    "4단계: 떡이 익으면 생크림 1/2컵과 우유 1/2컵을 넣는다",
                    "5단계: 크림이 잘 섞이도록 저으며 2-3분 더 끓인다",
                    "6단계: 크림색 핑크빛이 나면 완성한다"
                ],
                "치즈떡볶이": [
                    "1단계: 기본 국물떡볶이를 만든다",
                    "2단계: 떡볶이가 거의 완성되면 치즈 100g을 올린다",
                    "3단계: 뚜껑을 덮고 1-2분간 두어 치즈가 녹게 한다",
                    "4단계: 치즈가 적당히 녹으면 젓지 말고 바로 서빙한다"
                ],
                "참치김밥": [
                    "1단계: 밥 3공기에 참기름 2큰술, 소금을 넣고 섞어 김밥용 밥을 만든다",
                    "2단계: 참치캔 1캔의 기름을 빼고 마요네즈 2큰술과 섞어 참치샐러드를 만든다",
                    "3단계: 계란 3개로 두툼한 계란말이를 만들어 식힌 후 길게 썬다",
                    "4단계: 당근과 시금치를 데쳐서 참기름과 소금으로 무친다",
                    "5단계: 단무지를 길게 썬다",
                    "6단계: 김 위에 밥을 얇게 펴고 참치샐러드, 계란말이, 당근, 시금치, 단무지를 올린다",
                    "7단계: 김발을 이용해 단단히 말아 완성한다",
                    "8단계: 적당한 크기로 썰어 접시에 담는다"
                ],
                "불고기김밥": [
                    "1단계: 김밥용 밥을 준비한다",
                    "2단계: 불고기 200g을 간장 2큰술, 설탕 1큰술, 다진마늘 2큰술로 양념한다",
                    "3단계: 팬에 양념한 불고기를 볶아 완전히 익힌다",
                    "4단계: 계란말이와 각종 야채를 준비한다",
                    "5단계: 김에 밥을 펴고 불고기와 야채를 올린다",
                    "6단계: 김발로 단단히 말아 완성한다"
                ],
                "야채김밥": [
                    "1단계: 김밥용 밥을 준비한다",
                    "2단계: 시금치, 당근, 양배추를 각각 데치거나 볶아 준비한다",
                    "3단계: 각 야채에 참기름과 소금으로 간을 한다",
                    "4단계: 계란말이를 만든다",
                    "5단계: 김에 밥을 펴고 야채들을 색깔 맞춰 예쁘게 올린다",
                    "6단계: 김발로 말아 완성한다"
                ],
                "오징어튀김": [
                    "1단계: 오징어 1마리를 손질하여 링 모양으로 썬다",
                    "2단계: 썬 오징어에 소금, 후추, 다진마늘로 밑간한다",
                    "3단계: 튀김가루 1컵에 찬물을 넣어 튀김옷을 만든다",
                    "4단계: 기름을 170도로 달군다",
                    "5단계: 오징어에 튀김옷을 입혀 바삭하게 튀긴다",
                    "6단계: 기름을 빼고 뜨거울 때 바로 서빙한다"
                ],
                "야채튀김": [
                    "1단계: 호박 1/2개, 고구마 1개, 양배추 1/4개를 적당한 크기로 썬다",
                    "2단계: 야채에 소금을 뿌려 10분간 절인 후 물기를 뺀다",
                    "3단계: 튀김가루로 튀김옷을 만든다",
                    "4단계: 기름을 170도로 달군다",
                    "5단계: 야채에 튀김옷을 입혀 바삭하게 튀긴다",
                    "6단계: 기름을 빼고 바로 서빙한다"
                ],
                "만두": [
                    "1단계: 냉동만두 10개를 준비한다",
                    "2단계: 기름을 170도로 달군다",
                    "3단계: 만두를 넣고 노릇하게 튀긴다",
                    "4단계: 기름을 빼고 뜨거울 때 서빙한다"
                ],
                "잔치국수": [
                    "1단계: 멸치 10마리와 다시마 2조각으로 육수를 우린다",
                    "2단계: 소면 300g을 끓는 물에 삶는다",
                    "3단계: 삶은 면을 찬물에 헹궈 전분기를 제거한다",
                    "4단계: 육수에 국간장과 소금으로 간을 맞춘다",
                    "5단계: 그릇에 면을 담고 뜨거운 육수를 부어 완성한다"
                ],
                "멸치국수": [
                    "1단계: 멸치 15마리로 진한 육수를 우린다",
                    "2단계: 소면을 삶아 준비한다",
                    "3단계: 육수에 간장과 소금으로 간을 맞춘다",
                    "4단계: 대파를 송송 썰어 고명으로 준비한다",
                    "5단계: 그릇에 면을 담고 육수를 부은 후 대파를 올려 완성한다"
                ],
                "온면": [
                    "1단계: 기본 육수를 만든다",
                    "2단계: 소면을 삶아 준비한다",
                    "3단계: 간단한 고명(계란, 대파)을 준비한다",
                    "4단계: 따뜻한 육수에 면을 담아 완성한다"
                ]
            };

            // 각 메뉴별 조리순서를 테이블 형태로 변환
            const maxSteps = Math.max(...Object.values(cookingSteps).map(steps => steps.length));
            
            for (let i = 1; i <= maxSteps; i++) {
                const stepRow = [`${i}단계`];
                detailMenus.forEach(menu => {
                    const menuSteps = cookingSteps[menu.name];
                    const stepText = menuSteps && menuSteps[i-1] ? menuSteps[i-1].replace(`${i}단계: `, '') : '-';
                    stepRow.push(stepText);
                });
                steps.push(stepRow);
            }

            return [["조리순서"].concat(detailMenus.map(m => m.name))].concat(steps);
        }

        function generateCookingInfo() {
            const info = [
                ["조리정보"].concat(detailMenus.map(m => m.name))
            ];

            const infoData = {
                "조리시간": ["25분", "30분", "25분", "40분", "35분", "30분", "15분", "20분", "10분", "20분", "20분", "15분"],
                "난이도": ["초급", "중급", "초급", "중급", "중급", "중급", "초급", "초급", "초급", "초급", "초급", "초급"],
                "칼로리(1인분)": ["350kcal", "420kcal", "450kcal", "380kcal", "420kcal", "320kcal", "250kcal", "200kcal", "180kcal", "280kcal", "280kcal", "300kcal"],
                "인분": ["2인분", "2인분", "2인분", "3인분", "3인분", "3인분", "2인분", "2인분", "2인분", "2인분", "2인분", "2인분"],
                "보관방법": ["당일 섭취", "당일 섭취", "당일 섭취", "냉장 1일", "냉장 1일", "냉장 1일", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취"]
            };

            Object.keys(infoData).forEach(info_item => {
                info.push([info_item].concat(infoData[info_item]));
            });

            return info;
        }

        function generateTasteFeatures() {
            const taste = [
                ["특징/맛"].concat(detailMenus.map(m => m.name))
            ];

            const tasteData = {
                "주요맛": ["매콤달콤", "크리미한맛", "매콤고소", "고소한맛", "달콤간장맛", "담백한맛", "바다향", "고소한맛", "바삭한맛", "시원한맛", "깔끔한맛", "따뜻한맛"],
                "매운정도": ["보통", "순함", "보통", "순함", "순함", "순함", "순함", "순함", "순함", "순함", "순함", "순함"],
                "특징": ["쫄깃한떡과국물", "크림의부드러움", "치즈의고소함", "참치의바다맛", "불고기의달콤함", "야채의신선함", "오징어의쫄깃함", "야채의바삭함", "만두의든든함", "멸치육수깔끔", "진한멸치맛", "따뜻한국물"],
                "추천상황": ["간식타임", "색다른맛", "치즈좋아할때", "든든한한끼", "든든한한끼", "건강식", "술안주", "간식", "간식", "간단한식사", "국물생각날때", "따뜻하게"]
            };

            Object.keys(tasteData).forEach(taste_item => {
                taste.push([taste_item].concat(tasteData[taste_item]));
            });

            return taste;
        }

        function generateNutrition() {
            const nutrition = [
                ["영양정보"].concat(detailMenus.map(m => m.name))
            ];

            const nutritionData = {
                "단백질(g)": ["8", "10", "12", "18", "20", "12", "15", "6", "8", "8", "10", "8"],
                "탄수화물(g)": ["65", "68", "65", "55", "58", "50", "15", "25", "20", "45", "45", "48"],
                "지방(g)": ["8", "15", "18", "12", "15", "8", "12", "8", "8", "3", "3", "4"],
                "나트륨(mg)": ["1200", "1000", "1300", "800", "900", "600", "600", "400", "500", "800", "900", "700"],
                "식이섬유(g)": ["3", "3", "3", "4", "4", "6", "1", "4", "2", "2", "2", "2"],
                "비타민C(mg)": ["15", "15", "15", "20", "18", "35", "5", "25", "3", "5", "5", "5"],
                "칼슘(mg)": ["50", "80", "200", "60", "50", "80", "40", "60", "30", "30", "40", "35"],
                "철분(mg)": ["2", "2", "2", "3", "4", "3", "2", "1", "1", "1", "2", "1"]
            };

            Object.keys(nutritionData).forEach(nutrition_item => {
                nutrition.push([nutrition_item].concat(nutritionData[nutrition_item]));
            });

            return nutrition;
        }

        function generateServingTips() {
            const tips = [
                ["서빙/조리팁"].concat(detailMenus.map(m => m.name))
            ];

            const tipsData = {
                "서빙팁": [
                    "팔팔 끓는 상태에서 뜨겁게",
                    "크림이 분리되기 전에 바로",
                    "치즈가 녹은 상태에서 바로",
                    "적당한 크기로 썰어서 예쁘게",
                    "썰어서 모양 살려서",
                    "색깔 맞춰 예쁘게 썰어서",
                    "바삭할 때 바로 서빙",
                    "바삭한 상태로 뜨겁게",
                    "바삭할 때 바로",
                    "뜨거운 국물에 면 불지 않게",
                    "진한 육수로 뜨겁게",
                    "따뜻한 국물로"
                ],
                "보관팁": [
                    "국물과 떡 분리 보관 불가",
                    "크림이 분리되므로 보관 불가",
                    "치즈가 굳으므로 당일 섭취",
                    "랩으로 싸서 냉장 보관",
                    "랩으로 싸서 보관",
                    "당일 섭취 권장",
                    "바삭함 사라지므로 당일 섭취",
                    "당일 섭취 필수",
                    "당일 섭취 권장",
                    "면이 불므로 당일 섭취",
                    "당일 섭취 권장",
                    "당일 섭취 권장"
                ],
                "조리팁": [
                    "떡을 미리 불려야 빨리 익음",
                    "크림은 마지막에 넣어 분리 방지",
                    "치즈는 끝에 넣고 바로 서빙",
                    "밥이 너무 뜨겁지 않게 식히기",
                    "불고기는 완전히 익혀야 함",
                    "야채는 물기 제거가 중요",
                    "오징어는 너무 오래 튀기면 질김",
                    "야채는 물기 빼고 튀기기",
                    "냉동만두는 바로 튀겨도 됨",
                    "면 삶을 때 찬물로 헹구기",
                    "멸치는 내장 제거 후 우리기",
                    "육수는 미리 만들어 두기"
                ]
            };

            Object.keys(tipsData).forEach(tip_item => {
                tips.push([tip_item].concat(tipsData[tip_item]));
            });

            return tips;
        }

        function downloadRecipe() {
            // 새 워크북 생성
            const wb = XLSX.utils.book_new();

            // 각 시트 데이터 생성 및 추가
            const sheets = [
                {name: "주요식재료", data: generateIngredients()},
                {name: "양념소스", data: generateSauces()},
                {name: "육수베이스", data: generateBroth()},
                {name: "조리순서", data: generateCookingSteps()},
                {name: "조리정보", data: generateCookingInfo()},
                {name: "특징맛", data: generateTasteFeatures()},
                {name: "영양정보", data: generateNutrition()},
                {name: "서빙조리팁", data: generateServingTips()}
            ];

            sheets.forEach(sheet => {
                const ws = XLSX.utils.aoa_to_sheet(sheet.data);
                XLSX.utils.book_append_sheet(wb, ws, sheet.name);
            });

            // 파일 다운로드
            XLSX.writeFile(wb, "분식_상세레시피.xlsx");
        }

        // 페이지 로드 시 자동으로 준비 완료 상태로 변경
        window.addEventListener('load', function() {
            setTimeout(() => {
                document.getElementById('status').innerHTML = '분식 카테고리의 12개 상세메뉴 레시피가 준비되었습니다.';
                document.getElementById('status').className = 'status success';
                document.getElementById('downloadBtn').disabled = false;
            }, 1000);
        });
    </script>
</body>
</html>