<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>족발/보쌈 레시피 생성</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        .download-btn {
            background-color: #8B4513;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 10px;
            transition: background-color 0.3s;
        }
        .download-btn:hover {
            background-color: #A0522D;
        }
        .download-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .status {
            margin: 20px 0;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .processing {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>족발/보쌈 상세 레시피</h1>
        <div id="status" class="status processing">레시피 파일을 생성 중입니다...</div>
        <button id="downloadBtn" class="download-btn" disabled onclick="downloadRecipe()">
            족발보쌈_상세레시피.xlsx 다운로드
        </button>
    </div>

    <script>
        // 족발/보쌈 상세메뉴 데이터
        const detailMenus = [
            {name: "냉채족발", category: "족발", visual: "차가운 족발, 야채 고명, 쫄깃한 식감"},
            {name: "불족발", category: "족발", visual: "매운 양념, 빨간색, 불맛"},
            {name: "마늘족발", category: "족발", visual: "마늘 고명, 고소한 향"},
            {name: "마늘보쌈", category: "보쌈", visual: "삶은 돼지고기, 마늘, 쌈채소"},
            {name: "굴보쌈", category: "보쌈", visual: "삶은 돼지고기, 굴, 쌈채소"},
            {name: "회보쌈", category: "보쌈", visual: "삶은 돼지고기, 회무침, 쌈채소"},
            {name: "편육", category: "편육", visual: "얇게 썬 돼지고기, 깔끔한 비주얼"},
            {name: "수육", category: "편육", visual: "두툼하게 썬 돼지고기, 육수"},
            {name: "막국수", category: "냉면", visual: "메밀면, 빨간 양념장, 채소"},
            {name: "냉면", category: "냉면", visual: "시원한 육수, 면, 고명"},
            {name: "온면", category: "냉면", visual: "따뜻한 육수, 면, 고명"}
        ];

        // 레시피 데이터 생성 함수들
        function generateIngredients() {
            const ingredients = [
                ["식재료"].concat(detailMenus.map(m => m.name))
            ];

            const ingredientData = {
                "돼지족발": ["1kg", "1kg", "1kg", "-", "-", "-", "-", "-", "-", "-", "-"],
                "돼지목살": ["-", "-", "-", "800g", "800g", "800g", "600g", "800g", "-", "-", "-"],
                "돼지앞다리살": ["-", "-", "-", "-", "-", "-", "400g", "-", "-", "-", "-"],
                "메밀면": ["-", "-", "-", "-", "-", "-", "-", "-", "400g", "-", "-"],
                "냉면": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "400g", "400g"],
                "양파": ["1개", "1개", "1개", "1개", "1개", "1개", "1개", "1개", "1/2개", "1/2개", "1/2개"],
                "대파": ["3대", "3대", "3대", "2대", "2대", "2대", "2대", "2대", "2대", "2대", "2대"],
                "마늘": ["1통", "10쪽", "2통", "1통", "8쪽", "8쪽", "8쪽", "8쪽", "5쪽", "5쪽", "5쪽"],
                "생강": ["3조각", "3조각", "3조각", "2조각", "2조각", "2조각", "2조각", "2조각", "-", "-", "-"],
                "월계수잎": ["5장", "5장", "5장", "3장", "3장", "3장", "3장", "3장", "-", "-", "-"],
                "통후추": ["1큰술", "1큰술", "1큰술", "1작은술", "1작은술", "1작은술", "1작은술", "1작은술", "-", "-", "-"],
                "배추": ["-", "-", "-", "1/4포기", "1/4포기", "1/4포기", "-", "-", "-", "-", "-"],
                "상추": ["-", "-", "-", "1봉", "1봉", "1봉", "-", "-", "-", "-", "-"],
                "깻잎": ["-", "-", "-", "1봉", "1봉", "1봉", "-", "-", "-", "-", "-"],
                "굴": ["-", "-", "-", "-", "200g", "-", "-", "-", "-", "-", "-"],
                "횟감(광어등)": ["-", "-", "-", "-", "-", "200g", "-", "-", "-", "-", "-"],
                "오이": ["-", "-", "-", "-", "-", "-", "-", "-", "1개", "1개", "1개"],
                "당근": ["-", "-", "-", "-", "-", "-", "-", "-", "1/2개", "1/2개", "1/2개"],
                "양배추": ["-", "-", "-", "-", "-", "-", "-", "-", "1/4개", "1/4개", "1/4개"],
                "달걀": ["-", "-", "-", "-", "-", "-", "-", "-", "2개", "2개", "2개"],
                "청양고추": ["-", "3-4개", "-", "-", "-", "-", "-", "-", "2개", "1개", "1개"],
                "배": ["-", "-", "-", "-", "-", "-", "-", "-", "1/2개", "1/2개", "1/2개"]
            };

            Object.keys(ingredientData).forEach(ingredient => {
                ingredients.push([ingredient].concat(ingredientData[ingredient]));
            });

            return ingredients;
        }

        function generateSauces() {
            const sauces = [
                ["양념/소스"].concat(detailMenus.map(m => m.name))
            ];

            const sauceData = {
                "간장": ["3큰술", "3큰술", "3큰술", "-", "-", "-", "-", "-", "2큰술", "1큰술", "1큰술"],
                "소금": ["2큰술", "2큰술", "2큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1작은술", "적당량", "적당량"],
                "설탕": ["2큰술", "3큰술", "2큰술", "-", "-", "-", "-", "-", "2큰술", "1큰술", "1큰술"],
                "청주": ["1컵", "1컵", "1컵", "1/2컵", "1/2컵", "1/2컵", "1/2컵", "1/2컵", "-", "-", "-"],
                "맛술": ["-", "-", "-", "-", "-", "-", "-", "-", "1큰술", "-", "-"],
                "고추장": ["-", "3큰술", "-", "-", "-", "-", "-", "-", "2큰술", "-", "-"],
                "고춧가루": ["-", "2큰술", "-", "-", "-", "-", "-", "-", "1큰술", "-", "-"],
                "참기름": ["1큰술", "1큰술", "2큰술", "-", "-", "-", "-", "-", "1큰술", "-", "-"],
                "식초": ["2큰술", "-", "-", "-", "-", "1큰술", "-", "-", "3큰술", "2큰술", "-"],
                "겨자": ["-", "-", "-", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "-", "1작은술", "-"],
                "새우젓": ["-", "-", "-", "1작은술", "1작은술", "1작은술", "-", "-", "-", "-", "-"],
                "쌈장": ["-", "-", "-", "적당량", "적당량", "적당량", "-", "-", "-", "-", "-"],
                "다진마늘": ["1큰술", "2큰술", "3큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술"],
                "다진생강": ["1작은술", "1작은술", "1작은술", "1작은술", "1작은술", "1작은술", "1작은술", "1작은술", "-", "-", "-"],
                "올리고당": ["1큰술", "2큰술", "1큰술", "-", "-", "-", "-", "-", "1큰술", "-", "-"],
                "연겨자": ["-", "-", "-", "적당량", "적당량", "적당량", "적당량", "적당량", "-", "-", "-"]
            };

            Object.keys(sauceData).forEach(sauce => {
                sauces.push([sauce].concat(sauceData[sauce]));
            });

            return sauces;
        }

        function generateBroth() {
            const broth = [
                ["육수/베이스"].concat(detailMenus.map(m => m.name))
            ];

            const brothData = {
                "물": ["족발잠길만큼", "족발잠길만큼", "족발잠길만큼", "고기잠길만큼", "고기잠길만큼", "고기잠길만큼", "고기잠길만큼", "고기잠길만큼", "6컵", "8컵", "8컵"],
                "다시마": ["-", "-", "-", "-", "-", "-", "-", "-", "2조각", "3조각", "3조각"],
                "멸치": ["-", "-", "-", "-", "-", "-", "-", "-", "10마리", "15마리", "15마리"],
                "사골육수": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "선택사항", "기본"],
                "동치미국물": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "2컵", "-"],
                "냉면육수": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "기본", "-"]
            };

            Object.keys(brothData).forEach(item => {
                broth.push([item].concat(brothData[item]));
            });

            return broth;
        }

        function generateCookingSteps() {
            const steps = [];
            
            // 메뉴별로 개별 조리순서 생성 (단계 수가 다름)
            const cookingSteps = {
                "냉채족발": [
                    "1단계: 돼지족발 1kg을 찬물에 2시간 담가 핏물을 빼고, 털과 이물질을 깨끗이 제거한다",
                    "2단계: 큰 냄비에 족발이 잠길 만큼 물을 넣고 양파 1개, 대파 3대, 마늘 1통, 생강 3조각, 월계수잎 5장, 통후추 1큰술을 넣는다",
                    "3단계: 간장 3큰술, 소금 2큰술, 설탕 2큰술, 청주 1컵을 넣고 센 불에서 끓인다",
                    "4단계: 끓기 시작하면 중불로 줄이고 2-3시간 삶아 젓가락이 쉽게 들어갈 정도로 익힌다",
                    "5단계: 삶은 족발을 꺼내어 식힌 후 냉장고에서 2-3시간 차갑게 식힌다",
                    "6단계: 차가워진 족발을 적당한 크기로 썰어 접시에 담는다",
                    "7단계: 식초 2큰술, 참기름 1큰술, 다진마늘 1큰술, 올리고당 1큰술을 섞어 냉채소스를 만든다",
                    "8단계: 족발에 냉채소스를 뿌리고 채 썬 야채로 고명을 올려 완성한다"
                ],
                "불족발": [
                    "1단계: 기본 족발 삶기 과정을 동일하게 진행한다",
                    "2단계: 삶은 족발을 적당한 크기로 썬다",
                    "3단계: 고추장 3큰술, 고춧가루 2큰술, 설탕 3큰술, 다진마늘 2큰술, 올리고당 2큰술을 섞어 불족발 양념을 만든다",
                    "4단계: 팬에 기름을 두르고 썬 족발을 넣어 볶는다",
                    "5단계: 족발이 따뜻해지면 불족발 양념을 넣고 센 불에서 3-4분간 볶는다",
                    "6단계: 청양고추 3-4개를 어슷썰어 넣고 1분 더 볶아 완성한다"
                ],
                "마늘족발": [
                    "1단계: 기본 족발 삶기 과정을 진행하되, 마늘 2통을 통째로 넣어 함께 삶는다",
                    "2단계: 족발과 마늘이 부드러워질 때까지 충분히 삶는다",
                    "3단계: 삶은 족발을 적당한 크기로 썬다",
                    "4단계: 삶은 마늘을 으깨어 마늘페이스트를 만든다",
                    "5단계: 족발에 마늘페이스트를 발라주고 참기름 2큰술을 뿌린다",
                    "6단계: 다진마늘 3큰술을 추가로 뿌려 마늘 향을 극대화하여 완성한다"
                ],
                "마늘보쌈": [
                    "1단계: 돼지목살 800g을 찬물에 1시간 담가 핏물을 뺀다",
                    "2단계: 냄비에 고기가 잠길 만큼 물을 넣고 양파, 대파, 마늘 1통, 생강, 월계수잎을 넣는다",
                    "3단계: 청주 1/2컵과 소금 1큰술을 넣고 1시간 30분간 삶는다",
                    "4단계: 배추, 상추, 깻잎을 깨끗이 씻어 준비한다",
                    "5단계: 쌈장에 겨자 1큰술, 새우젓 1작은술, 다진마늘 1큰술을 섞어 마늘쌈장을 만든다",
                    "6단계: 삶은 고기를 적당한 두께로 썰어 쌈채소와 마늘쌈장과 함께 완성한다"
                ],
                "굴보쌈": [
                    "1단계: 기본 보쌈 고기 삶기 과정을 동일하게 진행한다",
                    "2단계: 신선한 굴 200g을 소금물에 깨끗이 씻어 준비한다",
                    "3단계: 쌈채소를 준비하고 기본 쌈장을 만든다",
                    "4단계: 삶은 고기를 썰어 접시에 담고 굴을 함께 올린다",
                    "5단계: 쌈채소와 굴, 고기를 함께 쌈장에 찍어 먹을 수 있게 완성한다"
                ],
                "회보쌈": [
                    "1단계: 기본 보쌈 고기 삶기 과정을 동일하게 진행한다",
                    "2단계: 광어 등 횟감 200g을 얇게 썰어 준비한다",
                    "3단계: 회무침용 양념(식초 1큰술, 겨자, 설탕 조금)을 만든다",
                    "4단계: 썬 회에 양념을 살짝 버무려 회무침을 만든다",
                    "5단계: 삶은 고기와 회무침을 함께 쌈채소에 싸서 먹을 수 있게 완성한다"
                ],
                "편육": [
                    "1단계: 돼지앞다리살 400g을 찬물에 담가 핏물을 뺀다",
                    "2단계: 냄비에 고기와 향신료를 넣고 1시간간 삶는다",
                    "3단계: 삶은 고기를 꺼내어 완전히 식힌다",
                    "4단계: 차가워진 고기를 0.3cm 두께로 얇게 썬다",
                    "5단계: 겨자 1큰술과 연겨자를 섞어 겨자소스를 만든다",
                    "6단계: 얇게 썬 편육을 접시에 보기 좋게 담고 겨자소스와 함께 완성한다"
                ],
                "수육": [
                    "1단계: 돼지목살 800g을 준비하여 기본 삶기 과정을 진행한다",
                    "2단계: 고기를 충분히 삶아 부드럽게 만든다",
                    "3단계: 삶은 고기를 1cm 두께로 두툼하게 썬다",
                    "4단계: 삶은 국물을 체에 걸러 맑게 만든다",
                    "5단계: 두툼한 수육을 그릇에 담고 따뜻한 육수를 곁들여 완성한다"
                ],
                "막국수": [
                    "1단계: 메밀면 400g을 끓는 물에 삶아 찬물에 헹궈 준비한다",
                    "2단계: 오이 1개, 당근 1/2개, 양배추 1/4개를 채 썬다",
                    "3단계: 달걀 2개를 삶아 반으로 자른다",
                    "4단계: 양념장(고추장 2큰술, 고춧가루 1큰술, 식초 3큰술, 설탕 2큰술, 간장 2큰술, 참기름 1큰술, 다진마늘 1큰술, 맛술 1큰술, 올리고당 1큰술)을 만든다",
                    "5단계: 그릇에 면을 담고 채소를 올린 후 양념장을 올린다",
                    "6단계: 달걀과 청양고추를 고명으로 올리고 잘 비벼서 완성한다"
                ],
                "냉면": [
                    "1단계: 냉면 400g을 찬물에 30분간 불린 후 끓는 물에 삶는다",
                    "2단계: 삶은 면을 찬물에 여러 번 헹궈 전분기를 제거한다",
                    "3단계: 멸치 15마리와 다시마 3조각으로 육수를 우린 후 차갑게 식힌다",
                    "4단계: 동치미국물 2컵을 육수에 섞어 냉면육수를 만든다",
                    "5단계: 오이, 당근, 배를 채 썰고 달걀을 삶아 준비한다",
                    "6단계: 그릇에 면을 담고 차가운 육수를 부은 후 고명을 올려 완성한다"
                ],
                "온면": [
                    "1단계: 냉면을 따뜻한 물에 불린 후 끓는 물에 삶는다",
                    "2단계: 사골육수 또는 멸치육수를 끓여 따뜻하게 준비한다",
                    "3단계: 고명용 야채와 달걀을 준비한다",
                    "4단계: 그릇에 면을 담고 뜨거운 육수를 부어 완성한다"
                ]
            };

            // 각 메뉴별 조리순서를 테이블 형태로 변환
            const maxSteps = Math.max(...Object.values(cookingSteps).map(steps => steps.length));
            
            for (let i = 1; i <= maxSteps; i++) {
                const stepRow = [`${i}단계`];
                detailMenus.forEach(menu => {
                    const menuSteps = cookingSteps[menu.name];
                    const stepText = menuSteps && menuSteps[i-1] ? menuSteps[i-1].replace(`${i}단계: `, '') : '-';
                    stepRow.push(stepText);
                });
                steps.push(stepRow);
            }

            return [["조리순서"].concat(detailMenus.map(m => m.name))].concat(steps);
        }

        function generateCookingInfo() {
            const info = [
                ["조리정보"].concat(detailMenus.map(m => m.name))
            ];

            const infoData = {
                "조리시간": ["180분", "150분", "160분", "120분", "120분", "130분", "90분", "100분", "30분", "40분", "35분"],
                "난이도": ["상급", "중급", "중급", "중급", "중급", "중급", "중급", "중급", "초급", "초급", "초급"],
                "칼로리(1인분)": ["450kcal", "480kcal", "420kcal", "380kcal", "350kcal", "320kcal", "320kcal", "350kcal", "380kcal", "280kcal", "320kcal"],
                "인분": ["3-4인분", "3-4인분", "3-4인분", "3-4인분", "3-4인분", "3-4인분", "3-4인분", "3-4인분", "2인분", "2인분", "2인분"],
                "보관방법": ["냉장 3일", "냉장 2일", "냉장 2일", "냉장 2일", "당일 섭취", "당일 섭취", "냉장 3일", "냉장 2일", "당일 섭취", "당일 섭취", "당일 섭취"]
            };

            Object.keys(infoData).forEach(info_item => {
                info.push([info_item].concat(infoData[info_item]));
            });

            return info;
        }

        function generateTasteFeatures() {
            const taste = [
                ["특징/맛"].concat(detailMenus.map(m => m.name))
            ];

            const tasteData = {
                "주요맛": ["새콤달콤", "매콤달콤", "고소한맛", "고소담백", "바다향", "회의신선함", "담백한맛", "구수한맛", "매콤새콤", "시원담백", "구수한맛"],
                "매운정도": ["순함", "매움", "순함", "순함", "순함", "순함", "순함", "순함", "보통", "순함", "순함"],
                "특징": ["차가운족발의쫄깃함", "불맛과매운맛", "마늘의진한향", "고기와마늘조화", "굴의바다향", "회의부드러움", "얇고부드러운", "두툼하고부드러운", "메밀의고소함", "시원한육수", "따뜻한국물"],
                "추천상황": ["여름철별미", "매운맛좋아할때", "마늘좋아할때", "가족모임", "특별한날", "회좋아할때", "술안주", "든든한식사", "더운날", "시원하게", "추운날"]
            };

            Object.keys(tasteData).forEach(taste_item => {
                taste.push([taste_item].concat(tasteData[taste_item]));
            });

            return taste;
        }

        function generateNutrition() {
            const nutrition = [
                ["영양정보"].concat(detailMenus.map(m => m.name))
            ];

            const nutritionData = {
                "단백질(g)": ["35", "36", "34", "32", "30", "28", "28", "30", "12", "10", "12"],
                "탄수화물(g)": ["8", "12", "10", "8", "8", "10", "6", "6", "45", "40", "42"],
                "지방(g)": ["25", "28", "23", "22", "20", "18", "18", "20", "8", "6", "8"],
                "나트륨(mg)": ["1200", "1400", "1100", "900", "950", "800", "800", "850", "1300", "800", "900"],
                "식이섬유(g)": ["2", "3", "2", "3", "4", "3", "1", "1", "6", "4", "4"],
                "비타민C(mg)": ["5", "15", "8", "12", "20", "15", "3", "3", "25", "15", "12"],
                "콜라겐(mg)": ["800", "800", "800", "300", "300", "300", "300", "300", "0", "0", "0"],
                "아연(mg)": ["5", "5", "5", "4", "6", "4", "4", "4", "1", "1", "1"]
            };

            Object.keys(nutritionData).forEach(nutrition_item => {
                nutrition.push([nutrition_item].concat(nutritionData[nutrition_item]));
            });

            return nutrition;
        }

        function generateServingTips() {
            const tips = [
                ["서빙/조리팁"].concat(detailMenus.map(m => m.name))
            ];

            const tipsData = {
                "서빙팁": [
                    "차갑게 식힌 상태에서 냉채소스와 함께",
                    "뜨거울 때 바로 양념하여 불맛 살리기",
                    "마늘 향이 진하게 나도록",
                    "따뜻한 고기에 쌈채소와 마늘쌈장",
                    "신선한 굴과 함께 바로 서빙",
                    "회무침은 직전에 만들어 신선하게",
                    "얇게 썰어 겨자소스와 함께",
                    "따뜻한 상태에서 육수와 함께",
                    "양념장을 잘 비벼서 매콤하게",
                    "차가운 육수에 시원하게",
                    "뜨거운 육수에 따뜻하게"
                ],
                "보관팁": [
                    "소스와 족발을 분리해서 보관",
                    "양념한 상태로는 오래 보관 불가",
                    "마늘페이스트 별도 보관",
                    "고기와 쌈장 분리 보관",
                    "굴은 당일 섭취 필수",
                    "회는 절대 보관하지 말 것",
                    "편육은 밀폐용기에 보관",
                    "육수와 분리해서 보관",
                    "면과 양념장 분리 보관",
                    "면과 육수 분리 보관",
                    "당일 섭취 권장"
                ],
                "조리팁": [
                    "족발 삶을 때 거품 제거가 중요",
                    "양념할 때 센 불에서 빠르게",
                    "마늘은 타지 않게 주의",
                    "고기가 퍽퍽하지 않게 적당히 삶기",
                    "굴은 소금물에 깨끗이 씻기",
                    "회는 먹기 직전에 양념하기",
                    "고기 식힐 때 랩 씌우기",
                    "육수는 맑게 걸러내기",
                    "면은 충분히 헹궈 전분기 제거",
                    "육수는 미리 차갑게 식히기",
                    "면이 불지 않게 주의"
                ]
            };

            Object.keys(tipsData).forEach(tip_item => {
                tips.push([tip_item].concat(tipsData[tip_item]));
            });

            return tips;
        }

        function downloadRecipe() {
            // 새 워크북 생성
            const wb = XLSX.utils.book_new();

            // 각 시트 데이터 생성 및 추가
            const sheets = [
                {name: "주요식재료", data: generateIngredients()},
                {name: "양념소스", data: generateSauces()},
                {name: "육수베이스", data: generateBroth()},
                {name: "조리순서", data: generateCookingSteps()},
                {name: "조리정보", data: generateCookingInfo()},
                {name: "특징맛", data: generateTasteFeatures()},
                {name: "영양정보", data: generateNutrition()},
                {name: "서빙조리팁", data: generateServingTips()}
            ];

            sheets.forEach(sheet => {
                const ws = XLSX.utils.aoa_to_sheet(sheet.data);
                XLSX.utils.book_append_sheet(wb, ws, sheet.name);
            });

            // 파일 다운로드
            XLSX.writeFile(wb, "족발보쌈_상세레시피.xlsx");
        }

        // 페이지 로드 시 자동으로 준비 완료 상태로 변경
        window.addEventListener('load', function() {
            setTimeout(() => {
                document.getElementById('status').innerHTML = '족발/보쌈 카테고리의 11개 상세메뉴 레시피가 준비되었습니다.';
                document.getElementById('status').className = 'status success';
                document.getElementById('downloadBtn').disabled = false;
            }, 1000);
        });
    </script>
</body>
</html>