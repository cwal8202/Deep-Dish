<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>찌개/탕 레시피 생성</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        .download-btn {
            background-color: #FF6B35;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 10px;
            transition: background-color 0.3s;
        }
        .download-btn:hover {
            background-color: #E55A2B;
        }
        .download-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .status {
            margin: 20px 0;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .processing {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>찌개/탕 상세 레시피</h1>
        <div id="status" class="status processing">레시피 파일을 생성 중입니다...</div>
        <button id="downloadBtn" class="download-btn" disabled onclick="downloadRecipe()">
            찌개탕_상세레시피.xlsx 다운로드
        </button>
    </div>

    <script>
        // 찌개/탕 상세메뉴 데이터
        const detailMenus = [
            {name: "부대찌개", category: "부대찌개", visual: "빨간 국물, 햄/소시지, 면 사리"},
            {name: "햄부대찌개", category: "부대찌개", visual: "빨간 국물, 햄/소시지, 면 사리"},
            {name: "치즈부대찌개", category: "부대찌개", visual: "빨간 국물, 햄/소시지, 면 사리"},
            {name: "감자탕", category: "감자탕", visual: "뼈, 감자, 우거지, 빨간 국물"},
            {name: "뼈해장국", category: "감자탕", visual: "뼈, 감자, 우거지, 빨간 국물"},
            {name: "등뼈찜", category: "감자탕", visual: "뼈, 감자, 우거지, 빨간 국물"},
            {name: "순두부찌개", category: "순두부찌개", visual: "흰 순두부, 빨간 국물, 계란"},
            {name: "해물순두부찌개", category: "순두부찌개", visual: "흰 순두부, 빨간 국물, 계란"},
            {name: "버섯순두부찌개", category: "순두부찌개", visual: "흰 순두부, 빨간 국물, 계란"},
            {name: "설렁탕", category: "맑은국물", visual: "진한 흰 국물, 고기, 면"},
            {name: "곰탕", category: "맑은국물", visual: "진한 흰 국물, 고기, 면"},
            {name: "갈비탕", category: "맑은국물", visual: "진한 흰 국물, 고기, 면"},
            {name: "삼계탕", category: "맑은국물", visual: "진한 흰 국물, 고기, 면"},
            {name: "육개장", category: "매운탕", visual: "빨간 국물, 고사리, 토란대"},
            {name: "닭개장", category: "매운탕", visual: "빨간 국물, 고사리, 토란대"},
            {name: "콩나물해장국", category: "매운탕", visual: "빨간 국물, 고사리, 토란대"}
        ];

        // 레시피 데이터 생성 함수들
        function generateIngredients() {
            const ingredients = [
                ["식재료"].concat(detailMenus.map(m => m.name))
            ];

            const ingredientData = {
                "돼지등뼈": ["-", "-", "-", "1kg", "800g", "1.2kg", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "소갈비": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "600g", "-", "-", "-", "-"],
                "소고기(양지)": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "400g", "400g", "-", "-", "300g", "-", "-"],
                "닭고기": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "1마리", "-", "1마리", "-"],
                "햄": ["150g", "200g", "150g", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "소시지": ["100g", "100g", "100g", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "순두부": ["-", "-", "-", "-", "-", "-", "1모", "1모", "1모", "-", "-", "-", "-", "-", "-", "-"],
                "김치": ["200g", "200g", "200g", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "감자": ["-", "-", "-", "4개", "3개", "5개", "-", "-", "-", "-", "-", "2개", "2개", "-", "-", "-"],
                "우거지": ["-", "-", "-", "200g", "150g", "250g", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "양파": ["1개", "1개", "1개", "1개", "1개", "1개", "1/2개", "1/2개", "1/2개", "1/2개", "1/2개", "1/2개", "1/2개", "1개", "1개", "1/2개"],
                "대파": ["2대", "2대", "2대", "2대", "2대", "2대", "1대", "1대", "1대", "1대", "1대", "1대", "1대", "2대", "2대", "2대"],
                "마늘": ["5쪽", "5쪽", "5쪽", "8쪽", "8쪽", "10쪽", "4쪽", "4쪽", "4쪽", "3쪽", "3쪽", "4쪽", "5쪽", "6쪽", "6쪽", "4쪽"],
                "생강": ["1조각", "1조각", "1조각", "2조각", "2조각", "2조각", "-", "-", "-", "1조각", "1조각", "1조각", "2조각", "1조각", "1조각", "-"],
                "계란": ["-", "-", "-", "-", "-", "-", "2개", "2개", "2개", "-", "-", "-", "-", "-", "-", "-"],
                "치즈": ["-", "-", "100g", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "라면사리": ["2개", "2개", "2개", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "해물믹스": ["-", "-", "-", "-", "-", "-", "-", "200g", "-", "-", "-", "-", "-", "-", "-", "-"],
                "버섯": ["-", "-", "-", "-", "-", "-", "-", "-", "150g", "-", "-", "-", "-", "-", "-", "-"],
                "고사리": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "100g", "100g", "-"],
                "토란대": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "100g", "100g", "-"],
                "콩나물": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "300g"],
                "찹쌀": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "1/2컵", "-", "-", "-"],
                "대추": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "5개", "-", "-", "-"],
                "인삼": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "1뿌리", "-", "-", "-"]
            };

            Object.keys(ingredientData).forEach(ingredient => {
                ingredients.push([ingredient].concat(ingredientData[ingredient]));
            });

            return ingredients;
        }

        function generateSauces() {
            const sauces = [
                ["양념/소스"].concat(detailMenus.map(m => m.name))
            ];

            const sauceData = {
                "고추장": ["2큰술", "2큰술", "2큰술", "3큰술", "3큰술", "4큰술", "1큰술", "1큰술", "1큰술", "-", "-", "-", "-", "2큰술", "2큰술", "1큰술"],
                "고춧가루": ["1큰술", "1큰술", "1큰술", "2큰술", "2큰술", "2큰술", "1큰술", "1큰술", "1큰술", "-", "-", "-", "-", "2큰술", "2큰술", "1큰술"],
                "간장": ["2큰술", "2큰술", "2큰술", "3큰술", "3큰술", "3큰술", "1큰술", "1큰술", "1큰술", "2큰술", "2큰술", "2큰술", "1큰술", "2큰술", "2큰술", "2큰술"],
                "소금": ["적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량"],
                "후추": ["조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금"],
                "참기름": ["1큰술", "1큰술", "1큰술", "2큰술", "2큰술", "2큰술", "1큰술", "1큰술", "1큰술", "-", "-", "-", "-", "1큰술", "1큰술", "1큰술"],
                "식용유": ["2큰술", "2큰술", "2큰술", "2큰술", "2큰술", "2큰술", "1큰술", "1큰술", "1큰술", "-", "-", "-", "-", "1큰술", "1큰술", "1큰술"],
                "다진마늘": ["2큰술", "2큰술", "2큰술", "3큰술", "3큰술", "3큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "2큰술", "2큰술", "1큰술"],
                "생강즙": ["-", "-", "-", "1큰술", "1큰술", "1큰술", "-", "-", "-", "1작은술", "1작은술", "1작은술", "1큰술", "1작은술", "1작은술", "-"],
                "맛술": ["1큰술", "1큰술", "1큰술", "2큰술", "2큰술", "2큰술", "-", "-", "-", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "-"],
                "된장": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "새우젓": ["-", "-", "-", "-", "-", "-", "1작은술", "1작은술", "1작은술", "-", "-", "-", "-", "-", "-", "1작은술"]
            };

            Object.keys(sauceData).forEach(sauce => {
                sauces.push([sauce].concat(sauceData[sauce]));
            });

            return sauces;
        }

        function generateBroth() {
            const broth = [
                ["육수/베이스"].concat(detailMenus.map(m => m.name))
            ];

            const brothData = {
                "물": ["6컵", "6컵", "6컵", "10컵", "8컵", "12컵", "3컵", "3컵", "3컵", "8컵", "8컵", "8컵", "10컵", "6컵", "6컵", "6컵"],
                "멸치": ["10마리", "10마리", "10마리", "-", "-", "-", "5마리", "5마리", "5마리", "-", "-", "-", "-", "8마리", "8마리", "10마리"],
                "다시마": ["2조각", "2조각", "2조각", "1조각", "1조각", "1조각", "1조각", "1조각", "1조각", "-", "-", "-", "-", "1조각", "1조각", "2조각"],
                "뼈육수": ["-", "-", "-", "기본", "기본", "기본", "-", "-", "-", "기본", "기본", "기본", "기본", "-", "-", "-"],
                "닭육수": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "기본", "-", "기본", "-"],
                "쌀뜨물": ["-", "-", "-", "2컵", "2컵", "2컵", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"]
            };

            Object.keys(brothData).forEach(item => {
                broth.push([item].concat(brothData[item]));
            });

            return broth;
        }

        function generateCookingSteps() {
            const steps = [];
            
            // 메뉴별로 개별 조리순서 생성 (단계 수가 다름)
            const cookingSteps = {
                "부대찌개": [
                    "1단계: 김치 200g은 한입 크기로 썰고, 햄 150g과 소시지 100g도 적당한 크기로 썬다",
                    "2단계: 양파 1개는 채 썰고, 대파 2대는 송송 썰어 준비한다",
                    "3단계: 냄비에 식용유를 두르고 김치를 3-4분간 볶아 신맛을 날린다",
                    "4단계: 멸치와 다시마로 우린 육수 6컵을 넣고 끓인다",
                    "5단계: 고추장 2큰술, 고춧가루 1큰술, 간장 2큰술을 넣고 간을 맞춘다",
                    "6단계: 햄과 소시지를 넣고 5분간 끓인 후 라면사리를 넣는다",
                    "7단계: 양파와 대파를 넣고 3분간 더 끓여 완성한다"
                ],
                "햄부대찌개": [
                    "1단계: 김치 200g과 햄 200g(일반보다 많이)을 한입 크기로 썬다",
                    "2단계: 양파와 대파를 썰어 준비한다",
                    "3단계: 냄비에 김치를 볶은 후 육수를 넣고 끓인다",
                    "4단계: 양념장을 풀고 햄을 넣어 끓인다",
                    "5단계: 라면사리와 채소를 넣고 끓여 완성한다"
                ],
                "치즈부대찌개": [
                    "1단계: 기본 부대찌개와 동일하게 재료를 준비하고 치즈 100g도 준비한다",
                    "2단계: 김치를 볶고 육수를 넣어 끓인다",
                    "3단계: 양념장을 풀고 햄, 소시지를 넣어 끓인다",
                    "4단계: 라면사리를 넣고 거의 다 익으면 치즈를 올린다",
                    "5단계: 치즈가 녹을 때까지 2-3분 더 끓여 완성한다"
                ],
                "감자탕": [
                    "1단계: 돼지등뼈 1kg을 찬물에 1시간 담가 핏물을 뺀다",
                    "2단계: 끓는 물에 등뼈를 넣고 10분간 삶아 잡내를 제거한 후 찬물에 헹군다",
                    "3단계: 압력솥에 등뼈와 물 10컵, 생강 2조각을 넣고 30분간 삶는다",
                    "4단계: 감자 4개는 큼직하게 썰고 우거지 200g은 적당한 크기로 썬다",
                    "5단계: 양파, 마늘을 썰고 양념장(고추장 3큰술, 고춧가루 2큰술, 간장 3큰술)을 만든다",
                    "6단계: 삶은 등뼈 국물에 감자와 우거지를 넣고 끓인다",
                    "7단계: 양념장을 풀고 20분간 더 끓여 감자가 부드러워지면 완성한다"
                ],
                "뼈해장국": [
                    "1단계: 돼지등뼈 800g의 핏물을 빼고 삶아 준비한다",
                    "2단계: 등뼈를 압력솥에서 25분간 삶는다",
                    "3단계: 감자 3개와 우거지 150g을 넣고 끓인다",
                    "4단계: 양념장을 풀고 해장국 스타일로 간을 맞춘다",
                    "5단계: 15분간 끓여 완성한다"
                ],
                "등뼈찜": [
                    "1단계: 돼지등뼈 1.2kg의 핏물을 빼고 삶아 준비한다",
                    "2단계: 압력솥에서 35분간 삶아 뼈가 무르게 만든다",
                    "3단계: 감자 5개와 우거지 250g을 크게 썬다",
                    "4단계: 진한 양념장(고추장 4큰술 포함)을 만든다",
                    "5단계: 모든 재료를 넣고 국물이 졸아들 때까지 끓인다",
                    "6단계: 양념이 잘 배고 국물이 진해지면 완성한다"
                ],
                "순두부찌개": [
                    "1단계: 순두부 1모는 부드럽게 으깨어 준비한다",
                    "2단계: 양파 1/2개와 대파 1대를 썬다",
                    "3단계: 냄비에 기름을 두르고 양파를 볶는다",
                    "4단계: 육수 3컵을 넣고 끓인 후 순두부를 넣는다",
                    "5단계: 고추장과 새우젓으로 간을 맞추고 계란 2개를 풀어 넣어 완성한다"
                ],
                "해물순두부찌개": [
                    "1단계: 순두부와 해물믹스 200g을 준비한다",
                    "2단계: 냄비에 기름을 두르고 해물을 먼저 볶는다",
                    "3단계: 육수를 넣고 끓인 후 순두부를 넣는다",
                    "4단계: 양념으로 간을 맞추고 계란을 풀어 넣어 완성한다"
                ],
                "버섯순두부찌개": [
                    "1단계: 순두부와 버섯 150g(새송이, 팽이버섯 등)을 준비한다",
                    "2단계: 냄비에 기름을 두르고 버섯을 볶는다",
                    "3단계: 육수를 넣고 끓인 후 순두부를 넣는다",
                    "4단계: 양념으로 간을 맞추고 계란을 풀어 넣어 완성한다"
                ],
                "설렁탕": [
                    "1단계: 소 양지 400g과 사골을 찬물에 2시간 담가 핏물을 뺀다",
                    "2단계: 압력솥에 고기와 물 8컵을 넣고 1시간 삶는다",
                    "3단계: 고기를 건져 한입 크기로 썰고 국물은 체에 걸러 맑게 한다",
                    "4단계: 그릇에 고기와 소면을 담고 뜨거운 국물을 부어 완성한다"
                ],
                "곰탕": [
                    "1단계: 소 양지 400g을 압력솥에서 오래 삶아 진한 국물을 만든다",
                    "2단계: 고기를 썰어 준비한다",
                    "3단계: 진한 국물에 고기를 넣고 끓여 완성한다"
                ],
                "갈비탕": [
                    "1단계: 소갈비 600g의 핏물을 빼고 찬물에 담가 둔다",
                    "2단계: 압력솥에 갈비와 물을 넣고 40분간 삶는다",
                    "3단계: 감자 2개와 당근을 넣고 15분 더 끓인다",
                    "4단계: 간을 맞추고 대파를 넣어 완성한다"
                ],
                "삼계탕": [
                    "1단계: 닭 1마리의 내장을 제거하고 깨끗이 씻는다",
                    "2단계: 닭 뱃속에 찹쌀 1/2컵, 대추 5개, 인삼 1뿌리, 마늘을 넣는다",
                    "3단계: 뱃속을 이쑤시개로 막고 압력솥에 넣는다",
                    "4단계: 물과 생강을 넣고 30분간 삶는다",
                    "5단계: 소금과 후추로 간을 맞춰 완성한다"
                ],
                "육개장": [
                    "1단계: 소고기 300g을 압력솥에서 삶아 고기와 육수를 분리한다",
                    "2단계: 고사리 100g과 토란대 100g을 불려서 준비한다",
                    "3단계: 삶은 고기를 가늘게 찢는다",
                    "4단계: 팬에 기름을 두르고 고기와 나물을 볶는다",
                    "5단계: 고춧가루와 고추장으로 양념하여 볶는다",
                    "6단계: 육수를 넣고 20분간 끓여 완성한다"
                ],
                "닭개장": [
                    "1단계: 닭고기 1마리를 삶아 살을 발라낸다",
                    "2단계: 고사리와 토란대를 불려 준비한다",
                    "3단계: 닭고기를 가늘게 찢는다",
                    "4단계: 팬에서 고기와 나물을 양념하여 볶는다",
                    "5단계: 닭육수를 넣고 끓여 완성한다"
                ],
                "콩나물해장국": [
                    "1단계: 콩나물 300g을 깨끗이 씻어 준비한다",
                    "2단계: 냄비에 멸치육수를 끓인다",
                    "3단계: 콩나물을 넣고 5분간 끓인다",
                    "4단계: 고춧가루와 새우젓으로 간을 맞춰 완성한다"
                ]
            };

            // 각 메뉴별 조리순서를 테이블 형태로 변환
            const maxSteps = Math.max(...Object.values(cookingSteps).map(steps => steps.length));
            
            for (let i = 1; i <= maxSteps; i++) {
                const stepRow = [`${i}단계`];
                detailMenus.forEach(menu => {
                    const menuSteps = cookingSteps[menu.name];
                    const stepText = menuSteps && menuSteps[i-1] ? menuSteps[i-1].replace(`${i}단계: `, '') : '-';
                    stepRow.push(stepText);
                });
                steps.push(stepRow);
            }

            return [["조리순서"].concat(detailMenus.map(m => m.name))].concat(steps);
        }

        function generateCookingInfo() {
            const info = [
                ["조리정보"].concat(detailMenus.map(m => m.name))
            ];

            const infoData = {
                "조리시간": ["40분", "40분", "45분", "90분", "80분", "100분", "25분", "30분", "25분", "120분", "120분", "90분", "60분", "60분", "60분", "30분"],
                "난이도": ["중급", "중급", "중급", "상급", "상급", "상급", "초급", "초급", "초급", "상급", "상급", "중급", "중급", "중급", "중급", "초급"],
                "칼로리(1인분)": ["380kcal", "420kcal", "450kcal", "420kcal", "380kcal", "480kcal", "220kcal", "250kcal", "200kcal", "280kcal", "320kcal", "350kcal", "400kcal", "300kcal", "280kcal", "120kcal"],
                "인분": ["3-4인분", "3-4인분", "3-4인분", "4-5인분", "3-4인분", "4-5인분", "2-3인분", "2-3인분", "2-3인분", "3-4인분", "3-4인분", "3-4인분", "2인분", "3-4인분", "3-4인분", "3-4인분"],
                "보관방법": ["냉장 2일", "냉장 2일", "냉장 2일", "냉장 3일", "냉장 3일", "냉장 3일", "당일 섭취", "당일 섭취", "당일 섭취", "냉장 3일", "냉장 3일", "냉장 3일", "당일 섭취", "냉장 2일", "냉장 2일", "냉장 2일"]
            };

            Object.keys(infoData).forEach(info_item => {
                info.push([info_item].concat(infoData[info_item]));
            });

            return info;
        }

        function generateTasteFeatures() {
            const taste = [
                ["특징/맛"].concat(detailMenus.map(m => m.name))
            ];

            const tasteData = {
                "주요맛": ["칼칼한맛", "칼칼한맛", "칼칼한맛", "진한구수", "해장용", "진한구수", "담백한맛", "시원한맛", "고소한맛", "진한백탕", "진한백탕", "진한백탕", "보양식", "매콤한맛", "매콤한맛", "시원한맛"],
                "매운정도": ["보통", "보통", "보통", "보통", "보통", "보통", "보통", "보통", "순함", "순함", "순함", "순함", "순함", "보통", "보통", "보통"],
                "특징": ["한국대표찌개", "햄맛진한", "치즈로고소함", "뼈의진한맛", "해장최고", "뼈가무른", "부드러운두부", "해물의시원함", "버섯의고소함", "진한사골맛", "깊은맛의국물", "갈비의담백함", "전통보양식", "푸짐한건더기", "닭고기담백", "아삭한콩나물"],
                "추천상황": ["술자리후", "술자리후", "가족모임", "든든한식사", "해장용", "특별한날", "가벼운식사", "영양식", "채식선호", "보양식", "보양식", "특별한날", "몸보신", "해장용", "해장용", "해장용"]
            };

            Object.keys(tasteData).forEach(taste_item => {
                taste.push([taste_item].concat(tasteData[taste_item]));
            });

            return taste;
        }

        function generateNutrition() {
            const nutrition = [
                ["영양정보"].concat(detailMenus.map(m => m.name))
            ];

            const nutritionData = {
                "단백질(g)": ["18", "22", "20", "35", "32", "38", "15", "20", "12", "25", "28", "30", "35", "25", "28", "8"],
                "탄수화물(g)": ["25", "25", "28", "20", "18", "22", "8", "10", "12", "5", "6", "8", "15", "15", "15", "12"],
                "지방(g)": ["22", "26", "30", "18", "15", "22", "12", "15", "8", "15", "18", "20", "20", "12", "10", "3"],
                "나트륨(mg)": ["1400", "1500", "1450", "1200", "1300", "1300", "1100", "1200", "900", "800", "850", "900", "900", "1300", "1200", "1100"],
                "식이섬유(g)": ["5", "5", "5", "4", "4", "5", "2", "3", "4", "1", "1", "2", "2", "6", "6", "8"],
                "비타민C(mg)": ["20", "20", "20", "15", "15", "18", "8", "12", "10", "2", "2", "5", "8", "25", "20", "15"]
            };

            Object.keys(nutritionData).forEach(nutrition_item => {
                nutrition.push([nutrition_item].concat(nutritionData[nutrition_item]));
            });

            return nutrition;
        }

        function generateServingTips() {
            const tips = [
                ["서빙/조리팁"].concat(detailMenus.map(m => m.name))
            ];

            const tipsData = {
                "서빙팁": [
                    "뚝배기에 팔팔 끓여서 라면사리와 함께",
                    "햄을 많이 넣어 진한 맛으로",
                    "치즈가 너무 녹기 전에 서빙",
                    "뼈와 함께 진한 국물로",
                    "해장용으로 뜨겁게",
                    "뼈가 무를 정도로 푹 익혀서",
                    "순두부의 부드러운 식감 살려서",
                    "해물의 시원한 맛이 우러나게",
                    "버섯의 고소한 향과 함께",
                    "진한 흰 국물로 뜨겁게",
                    "깊은 맛의 국물과 함께",
                    "갈비의 담백한 맛을 살려서",
                    "따뜻할 때 인삼과 함께",
                    "푸짐한 건더기와 함께",
                    "닭고기를 부드럽게 찢어서",
                    "아삭한 콩나물과 함께"
                ],
                "보관팁": [
                    "라면사리는 별도 보관",
                    "햄은 따로 보관 후 재가열시 추가",
                    "치즈는 서빙시 새로 추가",
                    "뼈와 국물 분리해서 보관",
                    "국물과 건더기 분리 보관",
                    "뼈는 냉동 보관 가능",
                    "순두부는 당일 섭취 권장",
                    "해물은 당일 섭취 권장",
                    "버섯은 오래 보관시 질감 변함",
                    "기름기 제거 후 보관",
                    "기름기 제거 후 냉장 보관",
                    "갈비와 국물 분리 보관",
                    "당일 섭취가 가장 좋음",
                    "나물류는 별도 보관",
                    "닭고기와 국물 분리 보관",
                    "콩나물은 금방 상하니 주의"
                ],
                "조리팁": [
                    "김치를 먼저 볶아야 맛있음",
                    "햄은 두껍게 썰어야 식감 좋음",
                    "치즈는 마지막에 넣어야 함",
                    "뼈의 핏물을 완전히 제거",
                    "압력솥 사용으로 시간 단축",
                    "장시간 끓여야 뼈가 무름",
                    "순두부는 너무 저으면 부서짐",
                    "해물은 과하게 끓이면 질김",
                    "버섯은 물이 나오지 않게 볶기",
                    "오랜 시간 끓여야 진한 맛",
                    "사골을 오래 끓여야 깊은 맛",
                    "갈비는 충분히 삶아야 부드러움",
                    "찹쌀이 터지지 않게 주의",
                    "고기는 결대로 찢어야 부드러움",
                    "닭육수를 진하게 우려야 맛있음",
                    "콩나물은 오래 끓이면 아삭함 사라짐"
                ]
            };

            Object.keys(tipsData).forEach(tip_item => {
                tips.push([tip_item].concat(tipsData[tip_item]));
            });

            return tips;
        }

        function downloadRecipe() {
            // 새 워크북 생성
            const wb = XLSX.utils.book_new();

            // 각 시트 데이터 생성 및 추가
            const sheets = [
                {name: "주요식재료", data: generateIngredients()},
                {name: "양념소스", data: generateSauces()},
                {name: "육수베이스", data: generateBroth()},
                {name: "조리순서", data: generateCookingSteps()},
                {name: "조리정보", data: generateCookingInfo()},
                {name: "특징맛", data: generateTasteFeatures()},
                {name: "영양정보", data: generateNutrition()},
                {name: "서빙조리팁", data: generateServingTips()}
            ];

            sheets.forEach(sheet => {
                const ws = XLSX.utils.aoa_to_sheet(sheet.data);
                XLSX.utils.book_append_sheet(wb, ws, sheet.name);
            });

            // 파일 다운로드
            XLSX.writeFile(wb, "찌개탕_상세레시피.xlsx");
        }

        // 페이지 로드 시 자동으로 준비 완료 상태로 변경
        window.addEventListener('load', function() {
            setTimeout(() => {
                document.getElementById('status').innerHTML = '찌개/탕 카테고리의 16개 상세메뉴 레시피가 준비되었습니다.';
                document.getElementById('status').className = 'status success';
                document.getElementById('downloadBtn').disabled = false;
            }, 1000);
        });
    </script>
</body>
</html>