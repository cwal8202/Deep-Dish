<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>튀김류 레시피 생성</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 100px auto;
            padding: 20px;
            background: linear-gradient(135deg, #FF8C00 0%, #FFD700 50%, #FFA500 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .container {
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            text-align: center;
            backdrop-filter: blur(10px);
            border: 3px solid #FF8C00;
        }
        .download-btn {
            background: linear-gradient(135deg, #FF8C00 0%, #FF6600 100%);
            color: white;
            padding: 20px 40px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: 20px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 8px 25px rgba(255,140,0,0.4);
        }
        .download-btn:hover {
            background: linear-gradient(135deg, #FF6600 0%, #CC5500 100%);
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(255,140,0,0.6);
        }
        .download-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <button id="downloadBtn" class="download-btn" onclick="downloadRecipe()">
            튀김류_상세레시피.xlsx 다운로드
        </button>
    </div>

    <script>
        // 튀김류 상세메뉴 데이터
        const detailMenus = [
            {name: "탕수육", category: "탕수육", cuisine: "중식", visual: "바삭한 돼지고기, 새콤달콤 소스"},
            {name: "새콤달콤탕수육", category: "탕수육", cuisine: "중식", visual: "탕수육, 더 진한 새콤달콤"},
            {name: "깐풍기", category: "닭튀김", cuisine: "중식", visual: "매콤한 닭튀김"},
            {name: "라조기", category: "닭튀김", cuisine: "중식", visual: "마라 향신료, 매운 닭튀김"},
            {name: "깐쇼새우", category: "새우튀김", cuisine: "중식", visual: "매콤한 새우튀김"},
            {name: "마요새우", category: "새우튀김", cuisine: "중식", visual: "마요네즈 소스, 새우튀김"},
            {name: "칠리새우", category: "새우튀김", cuisine: "중식", visual: "칠리 소스, 매운 새우"},
            {name: "유린기", category: "기타튀김", cuisine: "중식", visual: "바삭한 닭튀김, 양념소스"},
            {name: "깐풍새우", category: "기타튀김", cuisine: "중식", visual: "깐풍 소스, 새우"},
            {name: "깐풍오징어", category: "기타튀김", cuisine: "중식", visual: "깐풍 소스, 오징어"},
            {name: "돈까스", category: "돈까스", cuisine: "일식", visual: "바삭한 돼지고기, 갈색"},
            {name: "치킨가츠", category: "돈까스", cuisine: "일식", visual: "바삭한 닭고기"},
            {name: "생선까스", category: "돈까스", cuisine: "일식", visual: "바삭한 생선"},
            {name: "새우텐푸라", category: "텐푸라", cuisine: "일식", visual: "가벼운 튀김옷, 새우"},
            {name: "야채텐푸라", category: "텐푸라", cuisine: "일식", visual: "가벼운 튀김옷, 야채"},
            {name: "모둠텐푸라", category: "텐푸라", cuisine: "일식", visual: "다양한 텐푸라"},
            {name: "가라아게", category: "가라아게", cuisine: "일식", visual: "일본식 닭튀김"},
            {name: "치킨가라아게", category: "가라아게", cuisine: "일식", visual: "가라아게 스타일"},
            {name: "닭튀김", category: "가라아게", cuisine: "일식", visual: "바삭한 닭튀김"}
        ];

        // 레시피 데이터 생성 함수들
        function generateIngredients() {
            const ingredients = [
                ["식재료"].concat(detailMenus.map(m => m.name))
            ];

            const ingredientData = {
                "돼지고기(등심)": ["400g", "400g", "-", "-", "-", "-", "-", "-", "-", "-", "400g", "-", "-", "-", "-", "-", "-", "-", "-"],
                "닭고기": ["-", "-", "500g", "500g", "-", "-", "-", "500g", "-", "-", "-", "400g", "-", "-", "-", "-", "400g", "400g", "400g"],
                "새우": ["-", "-", "-", "-", "10마리", "10마리", "10마리", "-", "8마리", "-", "-", "-", "-", "8마리", "-", "5마리", "-", "-", "-"],
                "오징어": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "2마리", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "생선(흰살)": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "300g", "-", "-", "-", "-", "-", "-"],
                "양파": ["1개", "1개", "1개", "1개", "1/2개", "1/2개", "1/2개", "1/2개", "1/2개", "1/2개", "-", "-", "-", "-", "1개", "1/2개", "-", "-", "-"],
                "피망": ["2개", "2개", "2개", "2개", "1개", "1개", "1개", "1개", "1개", "1개", "-", "-", "-", "-", "2개", "1개", "-", "-", "-"],
                "당근": ["1개", "1개", "1/2개", "1/2개", "1/4개", "1/4개", "1/4개", "1/4개", "1/4개", "1/4개", "-", "-", "-", "-", "1/2개", "1/4개", "-", "-", "-"],
                "대파": ["2대", "2대", "2대", "2대", "1대", "1대", "1대", "2대", "1대", "1대", "-", "-", "-", "-", "-", "-", "1대", "1대", "1대"],
                "마늘": ["5쪽", "5쪽", "5쪽", "8쪽", "4쪽", "4쪽", "4쪽", "5쪽", "4쪽", "4쪽", "3쪽", "3쪽", "3쪽", "3쪽", "3쪽", "3쪽", "5쪽", "5쪽", "5쪽"],
                "생강": ["2조각", "2조각", "2조각", "2조각", "1조각", "1조각", "1조각", "2조각", "1조각", "1조각", "1조각", "1조각", "1조각", "1조각", "1조각", "1조각", "2조각", "2조각", "2조각"],
                "청양고추": ["-", "-", "3개", "5개", "2개", "-", "3개", "2개", "2개", "2개", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "달걀": ["2개", "2개", "1개", "1개", "1개", "1개", "1개", "1개", "1개", "1개", "2개", "2개", "2개", "2개", "1개", "2개", "1개", "1개", "1개"],
                "밀가루": ["1컵", "1컵", "1컵", "1컵", "1컵", "1컵", "1컵", "1컵", "1컵", "1컵", "1컵", "1컵", "1컵", "1컵", "1컵", "1컵", "1컵", "1컵", "1컵"],
                "전분": ["1/2컵", "1/2컵", "1/2컵", "1/2컵", "1/2컵", "1/2컵", "1/2컵", "1/2컵", "1/2컵", "1/2컵", "-", "-", "-", "1/2컵", "1/2컵", "1/2컵", "1/2컵", "1/2컵", "1/2컵"],
                "빵가루": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "2컵", "2컵", "2컵", "-", "-", "-", "-", "-", "-"],
                "호박": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "1/2개", "1/4개", "-", "-", "-"],
                "가지": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "1개", "1/2개", "-", "-", "-"],
                "고구마": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "1개", "1/2개", "-", "-", "-"]
            };

            Object.keys(ingredientData).forEach(ingredient => {
                ingredients.push([ingredient].concat(ingredientData[ingredient]));
            });

            return ingredients;
        }

        function generateSauces() {
            const sauces = [
                ["양념/소스"].concat(detailMenus.map(m => m.name))
            ];

            const sauceData = {
                "케첩": ["5큰술", "6큰술", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "식초": ["3큰술", "4큰술", "1큰술", "-", "1큰술", "-", "2큰술", "2큰술", "1큰술", "1큰술", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "설탕": ["4큰술", "5큰술", "2큰술", "1큰술", "2큰술", "3큰술", "2큰술", "2큰술", "2큰술", "2큰술", "-", "-", "-", "-", "-", "-", "1큰술", "1큰술", "1큰술"],
                "간장": ["-", "-", "2큰술", "3큰술", "2큰술", "1큰술", "2큰술", "2큰술", "2큰술", "2큰술", "-", "-", "-", "-", "-", "-", "3큰술", "3큰술", "3큰술"],
                "굴소스": ["-", "-", "1큰술", "1큰술", "1큰술", "-", "1큰술", "1큰술", "1큰술", "1큰술", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "고추장": ["-", "-", "2큰술", "-", "1큰술", "-", "1큰술", "-", "1큰술", "1큰술", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "고춧가루": ["-", "-", "1큰술", "2큰술", "1큰술", "-", "1큰술", "-", "1큰술", "1큰술", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "마요네즈": ["-", "-", "-", "-", "-", "5큰술", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "칠리소스": ["-", "-", "-", "-", "-", "-", "3큰술", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "소금": ["적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량"],
                "후추": ["조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금", "조금"],
                "식용유": ["튀김용", "튀김용", "튀김용", "튀김용", "튀김용", "튀김용", "튀김용", "튀김용", "튀김용", "튀김용", "튀김용", "튀김용", "튀김용", "튀김용", "튀김용", "튀김용", "튀김용", "튀김용", "튀김용"],
                "참기름": ["-", "-", "1큰술", "1큰술", "1큰술", "-", "1큰술", "1큰술", "1큰술", "1큰술", "-", "-", "-", "-", "-", "-", "1큰술", "1큰술", "1큰술"],
                "다진마늘": ["1큰술", "1큰술", "2큰술", "3큰술", "2큰술", "1큰술", "2큰술", "2큰술", "2큰술", "2큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "2큰술", "2큰술", "2큰술"],
                "다진생강": ["1작은술", "1작은술", "1큰술", "1큰술", "1작은술", "1작은술", "1작은술", "1큰술", "1작은술", "1작은술", "1작은술", "1작은술", "1작은술", "1작은술", "1작은술", "1작은술", "1큰술", "1큰술", "1큰술"],
                "물전분": ["3큰술", "3큰술", "2큰술", "2큰술", "2큰술", "-", "2큰술", "2큰술", "2큰술", "2큰술", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "청주": ["2큰술", "2큰술", "2큰술", "2큰술", "1큰술", "1큰술", "1큰술", "2큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "-", "-", "2큰술", "2큰술", "2큰술"],
                "미림": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "1큰술", "1큰술", "1큰술"],
                "돈까스소스": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "적당량", "적당량", "적당량", "-", "-", "-", "-", "-", "-"],
                "텐푸라소스": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "적당량", "적당량", "적당량", "-", "-", "-"]
            };

            Object.keys(sauceData).forEach(sauce => {
                sauces.push([sauce].concat(sauceData[sauce]));
            });

            return sauces;
        }

        function generateBroth() {
            const broth = [
                ["육수/베이스"].concat(detailMenus.map(m => m.name))
            ];

            const brothData = {
                "물": ["1컵", "1컵", "1컵", "1컵", "1/2컵", "1/2컵", "1/2컵", "1컵", "1/2컵", "1/2컵", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "찬물": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "얼음물", "얼음물", "얼음물", "-", "-", "-"],
                "얼음": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "적당량", "적당량", "적당량", "-", "-", "-"]
            };

            Object.keys(brothData).forEach(item => {
                broth.push([item].concat(brothData[item]));
            });

            return broth;
        }

        function generateCookingSteps() {
            const steps = [];
            
            // 메뉴별로 개별 조리순서 생성 (단계 수가 다름)
            const cookingSteps = {
                "탕수육": [
                    "1단계: 돼지등심 400g을 한입 크기로 썰어 소금, 후추로 밑간한다",
                    "2단계: 밀가루 1컵과 전분 1/2컵, 달걀 2개, 물을 섞어 튀김옷을 만든다",
                    "3단계: 고기에 튀김옷을 입혀 170도 기름에서 바삭하게 튀긴다",
                    "4단계: 양파, 당근, 피망을 적당한 크기로 썬다",
                    "5단계: 팬에 케첩 5큰술, 식초 3큰술, 설탕 4큰술, 물 1컵을 끓인다",
                    "6단계: 야채를 넣고 끓인 후 물전분으로 농도를 맞춘다",
                    "7단계: 튀긴 고기를 접시에 담고 소스를 부어 완성한다"
                ],
                "새콤달콤탕수육": [
                    "1단계: 기본 탕수육과 동일하게 고기를 준비하고 튀긴다",
                    "2단계: 소스에 식초 4큰술, 설탕 5큰술로 더 새콤달콤하게 만든다",
                    "3단계: 케첩 6큰술로 단맛을 더 강화한다",
                    "4단계: 야채와 함께 끓인 후 농도를 맞춘다",
                    "5단계: 튀긴 고기에 새콤달콤한 소스를 부어 완성한다"
                ],
                "깐풍기": [
                    "1단계: 닭고기 500g을 한입 크기로 썰어 밑간한다",
                    "2단계: 튀김옷을 입혀 바삭하게 튀긴다",
                    "3단계: 청양고추 3개와 피망을 썬다",
                    "4단계: 팬에 기름을 두르고 마늘, 생강을 볶는다",
                    "5단계: 고추장 2큰술, 고춧가루 1큰술, 간장, 설탕을 넣고 볶는다",
                    "6단계: 튀긴 닭고기와 야채를 넣고 볶아 완성한다"
                ],
                "라조기": [
                    "1단계: 닭고기를 준비하여 튀김옷을 입혀 튀긴다",
                    "2단계: 마라 양념(간장 3큰술, 고춧가루 2큰술, 마늘, 생강)을 만든다",
                    "3단계: 청양고추 5개를 많이 넣어 매운맛을 강화한다",
                    "4단계: 팬에서 매운 양념을 볶아 향을 낸다",
                    "5단계: 튀긴 닭고기를 넣고 볶아 라조기를 완성한다"
                ],
                "깐쇼새우": [
                    "1단계: 새우 10마리를 손질하여 등을 갈라 내장을 제거한다",
                    "2단계: 새우에 밑간 후 튀김옷을 입혀 튀긴다",
                    "3단계: 청양고추 2개와 피망을 썬다",
                    "4단계: 깐쇼 양념(고추장, 간장, 설탕, 식초)을 만든다",
                    "5단계: 팬에서 양념을 볶은 후 튀긴 새우를 넣어 완성한다"
                ],
                "마요새우": [
                    "1단계: 새우를 손질하여 튀김옷을 입혀 바삭하게 튀긴다",
                    "2단계: 마요네즈 5큰술에 설탕 3큰술을 섞어 마요소스를 만든다",
                    "3단계: 튀긴 새우에 마요소스를 버무려 완성한다"
                ],
                "칠리새우": [
                    "1단계: 새우를 손질하여 튀김옷을 입혀 튀긴다",
                    "2단계: 칠리소스 3큰술, 식초 2큰술, 설탕 2큰술을 섞는다",
                    "3단계: 청양고추 3개를 넣어 매운맛을 강화한다",
                    "4단계: 팬에서 소스를 끓인 후 튀긴 새우를 넣어 완성한다"
                ],
                "유린기": [
                    "1단계: 닭고기 500g을 한입 크기로 썰어 청주로 밑간한다",
                    "2단계: 튀김옷을 입혀 170도에서 바삭하게 튀긴다",
                    "3단계: 유린기 소스(간장, 식초, 설탕, 물)를 끓여 만든다",
                    "4단계: 튀긴 닭고기를 접시에 담고 뜨거운 소스를 부어 완성한다"
                ],
                "깐풍새우": [
                    "1단계: 새우 8마리를 손질하여 튀긴다",
                    "2단계: 깐풍 양념을 만들어 볶는다",
                    "3단계: 튀긴 새우를 넣고 볶아 완성한다"
                ],
                "깐풍오징어": [
                    "1단계: 오징어 2마리를 링 모양으로 썰어 튀긴다",
                    "2단계: 깐풍 양념을 만들어 볶는다",
                    "3단계: 튀긴 오징어를 넣고 볶아 완성한다"
                ],
                "돈까스": [
                    "1단계: 돼지등심 400g을 두드려 얇게 편다",
                    "2단계: 소금, 후추로 밑간한다",
                    "3단계: 밀가루, 달걀물, 빵가루 순으로 옷을 입힌다",
                    "4단계: 170도 기름에서 노릇하게 튀긴다",
                    "5단계: 기름을 빼고 돈까스소스와 함께 완성한다"
                ],
                "치킨가츠": [
                    "1단계: 닭가슴살 400g을 두드려 편다",
                    "2단계: 돈까스와 동일한 방법으로 빵가루 옷을 입힌다",
                    "3단계: 바삭하게 튀겨 완성한다"
                ],
                "생선까스": [
                    "1단계: 흰살생선 300g을 준비한다",
                    "2단계: 빵가루 옷을 입혀 바삭하게 튀긴다",
                    "3단계: 돈까스소스와 함께 완성한다"
                ],
                "새우텐푸라": [
                    "1단계: 새우 8마리를 손질하여 꼬리만 남기고 준비한다",
                    "2단계: 찬물과 밀가루, 달걀로 가벼운 텐푸라 반죽을 만든다",
                    "3단계: 새우에 반죽을 입혀 170도에서 가볍게 튀긴다",
                    "4단계: 텐푸라소스와 함께 바로 서빙한다"
                ],
                "야채텐푸라": [
                    "1단계: 호박, 가지, 고구마, 양파 등을 적당한 크기로 썬다",
                    "2단계: 텐푸라 반죽을 만든다",
                    "3단계: 야채에 반죽을 입혀 가볍게 튀긴다",
                    "4단계: 텐푸라소스와 함께 완성한다"
                ],
                "모둠텐푸라": [
                    "1단계: 새우와 다양한 야채를 준비한다",
                    "2단계: 텐푸라 반죽을 만든다",
                    "3단계: 재료별로 순서대로 튀긴다",
                    "4단계: 모둠으로 담아 텐푸라소스와 함께 완성한다"
                ],
                "가라아게": [
                    "1단계: 닭고기 400g을 한입 크기로 썬다",
                    "2단계: 간장, 청주, 마늘, 생강으로 30분간 재운다",
                    "3단계: 전분을 묻혀 170도에서 튀긴다",
                    "4단계: 바삭한 가라아게를 완성한다"
                ],
                "치킨가라아게": [
                    "1단계: 가라아게와 동일한 방법으로 준비한다",
                    "2단계: 닭고기를 양념에 재운다",
                    "3단계: 전분을 묻혀 바삭하게 튀긴다"
                ],
                "닭튀김": [
                    "1단계: 닭고기를 준비하여 양념한다",
                    "2단계: 밀가루와 전분을 섞어 옷을 입힌다",
                    "3단계: 바삭하게 튀겨 완성한다"
                ]
            };

            // 각 메뉴별 조리순서를 테이블 형태로 변환
            const maxSteps = Math.max(...Object.values(cookingSteps).map(steps => steps.length));
            
            for (let i = 1; i <= maxSteps; i++) {
                const stepRow = [`${i}단계`];
                detailMenus.forEach(menu => {
                    const menuSteps = cookingSteps[menu.name];
                    const stepText = menuSteps && menuSteps[i-1] ? menuSteps[i-1].replace(`${i}단계: `, '') : '-';
                    stepRow.push(stepText);
                });
                steps.push(stepRow);
            }

            return [["조리순서"].concat(detailMenus.map(m => m.name))].concat(steps);
        }

        function generateCookingInfo() {
            const info = [
                ["조리정보"].concat(detailMenus.map(m => m.name))
            ];

            const infoData = {
                "조리시간": ["40분", "40분", "30분", "35분", "25분", "20분", "25분", "35분", "25분", "25분", "25분", "25분", "25분", "20분", "25분", "30분", "35분", "35분", "30분"],
                "난이도": ["중급", "중급", "중급", "중급", "중급", "초급", "중급", "중급", "중급", "중급", "중급", "중급", "중급", "중급", "중급", "중급", "중급", "중급", "중급"],
                "칼로리(1인분)": ["520kcal", "580kcal", "480kcal", "500kcal", "320kcal", "380kcal", "350kcal", "450kcal", "340kcal", "360kcal", "480kcal", "420kcal", "380kcal", "280kcal", "320kcal", "350kcal", "380kcal", "380kcal", "400kcal"],
                "인분": ["2-3인분", "2-3인분", "2-3인분", "2-3인분", "2인분", "2인분", "2인분", "2-3인분", "2인분", "2인분", "2인분", "2인분", "2인분", "2인분", "2인분", "2-3인분", "2인분", "2인분", "2인분"],
                "보관방법": ["당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취", "당일 섭취"]
            };

            Object.keys(infoData).forEach(info_item => {
                info.push([info_item].concat(infoData[info_item]));
            });

            return info;
        }

        function generateTasteFeatures() {
            const taste = [
                ["특징/맛"].concat(detailMenus.map(m => m.name))
            ];

            const tasteData = {
                "주요맛": ["새콤달콤", "새콤달콤", "매콤달콤", "매콤한맛", "매콤한맛", "달콤크리미", "매콤한맛", "달콤새콤", "매콤한맛", "매콤한맛", "고소한맛", "고소한맛", "고소한맛", "담백한맛", "고소한맛", "담백한맛", "고소한맛", "고소한맛", "고소한맛"],
                "매운정도": ["순함", "순함", "보통", "매움", "보통", "순함", "매움", "순함", "보통", "보통", "순함", "순함", "순함", "순함", "순함", "순함", "순함", "순함", "순함"],
                "특징": ["바삭한탕수육", "더달콤한탕수육", "매콤한닭튀김", "마라향매운맛", "매콤한새우", "크리미한새우", "칠리매운새우", "바삭한유린기", "깐풍새우", "깐풍오징어", "바삭한돈까스", "바삭한치킨", "바삭한생선", "가벼운튀김", "야채의달콤함", "다양한텐푸라", "일본식닭튀김", "가라아게스타일", "바삭한닭튀김"],
                "추천상황": ["중식대표요리", "달콤한맛좋을때", "매운맛좋을때", "매운맛극한", "매콤한해산물", "크리미한맛", "매운해산물", "특별한날", "매운새우좋을때", "매운오징어", "일식대표", "가벼운일식", "생선좋아할때", "일식전채", "야채좋아할때", "일식코스", "일본가정식", "일본식주점", "바삭한닭"]
            };

            Object.keys(tasteData).forEach(taste_item => {
                taste.push([taste_item].concat(tasteData[taste_item]));
            });

            return taste;
        }

        function generateNutrition() {
            const nutrition = [
                ["영양정보"].concat(detailMenus.map(m => m.name))
            ];

            const nutritionData = {
                "단백질(g)": ["25", "25", "30", "32", "20", "22", "20", "28", "18", "16", "28", "32", "26", "18", "8", "15", "28", "28", "30"],
                "탄수화물(g)": ["45", "55", "35", "30", "25", "30", "28", "38", "22", "20", "35", "30", "28", "20", "35", "40", "25", "25", "28"],
                "지방(g)": ["25", "30", "22", "25", "18", "25", "20", "20", "20", "22", "25", "20", "18", "15", "18", "20", "20", "20", "22"],
                "나트륨(mg)": ["1000", "1200", "1400", "1600", "1200", "800", "1300", "1100", "1200", "1100", "800", "700", "600", "500", "400", "600", "900", "900", "800"],
                "식이섬유(g)": ["4", "5", "3", "3", "2", "1", "2", "3", "2", "1", "2", "1", "1", "1", "6", "5", "1", "1", "1"],
                "비타민C(mg)": ["25", "30", "20", "25", "15", "8", "20", "18", "12", "10", "5", "3", "2", "5", "40", "35", "2", "2", "3"],
                "칼슘(mg)": ["40", "45", "50", "60", "80", "60", "70", "45", "70", "40", "30", "25", "120", "100", "80", "100", "30", "30", "35"],
                "철분(mg)": ["3", "3", "4", "5", "3", "2", "3", "3", "3", "2", "3", "3", "2", "2", "2", "3", "3", "3", "4"],
                "아연(mg)": ["4", "4", "4", "5", "3", "3", "3", "4", "3", "2", "4", "3", "2", "2", "1", "2", "3", "3", "4"]
            };

            Object.keys(nutritionData).forEach(nutrition_item => {
                nutrition.push([nutrition_item].concat(nutritionData[nutrition_item]));
            });

            return nutrition;
        }

        function generateServingTips() {
            const tips = [
                ["서빙/조리팁"].concat(detailMenus.map(m => m.name))
            ];

            const tipsData = {
                "서빙팁": [
                    "바삭할 때 소스와 함께",
                    "더 달콤한 소스로 풍성하게",
                    "매콤하게 뜨거울 때",
                    "매운맛 경고와 함께",
                    "매콤한 새우 바삭하게",
                    "크리미한 소스로 부드럽게",
                    "칠리의 매운맛과 함께",
                    "뜨거운 소스와 바삭한 닭",
                    "매콤한 깐풍 소스와 함께",
                    "매콤한 오징어 쫄깃하게",
                    "바삭함과 돈까스소스",
                    "부드러운 치킨가츠",
                    "생선의 담백함 살려서",
                    "가벼운 튀김옷으로 바로",
                    "야채 본연의 맛 살려서",
                    "다양한 재료 골고루",
                    "일본식 간장과 함께",
                    "바삭한 가라아게 스타일",
                    "바삭한 닭튀김으로"
                ],
                "보관팁": [
                    "바삭함 사라지므로 당일 섭취",
                    "소스와 분리 보관 불가",
                    "바삭함 유지 어려움",
                    "매운맛이 더 강해질 수 있음",
                    "새우는 당일 섭취 필수",
                    "마요소스 분리될 수 있음",
                    "칠리소스와 분리 어려움",
                    "소스와 분리 불가",
                    "당일 섭취 권장",
                    "오징어 질길 수 있음",
                    "바삭함 사라짐",
                    "바삭함 유지 어려움",
                    "생선 비린내 날 수 있음",
                    "텐푸라는 즉시 섭취",
                    "야채 물러질 수 있음",
                    "즉시 섭취 권장",
                    "바삭함 사라짐",
                    "당일 섭취 필수",
                    "바삭함 유지 어려움"
                ],
                "조리팁": [
                    "고기 이중 튀김으로 바삭함",
                    "소스 단맛 조절 중요",
                    "닭고기 완전히 익혀야 함",
                    "마라 향신료 양 조절",
                    "새우 과하게 튀기면 질김",
                    "마요네즈 온도 주의",
                    "칠리소스 타지 않게 주의",
                    "소스는 뜨겁게 부어야 함",
                    "새우 튀김 온도 중요",
                    "오징어 센 불에서 빠르게",
                    "고기 두드려 부드럽게",
                    "닭고기 두께 균일하게",
                    "생선 수분 제거 중요",
                    "반죽 너무 저으면 안됨",
                    "야채 수분 제거 후 튀김",
                    "재료별 튀김 시간 다름",
                    "양념 시간 충분히",
                    "전분만 사용이 포인트",
                    "두 번 튀기면 더 바삭"
                ]
            };

            Object.keys(tipsData).forEach(tip_item => {
                tips.push([tip_item].concat(tipsData[tip_item]));
            });

            return tips;
        }

        function downloadRecipe() {
            // 새 워크북 생성
            const wb = XLSX.utils.book_new();

            // 각 시트 데이터 생성 및 추가
            const sheets = [
                {name: "주요식재료", data: generateIngredients()},
                {name: "양념소스", data: generateSauces()},
                {name: "육수베이스", data: generateBroth()},
                {name: "조리순서", data: generateCookingSteps()},
                {name: "조리정보", data: generateCookingInfo()},
                {name: "특징맛", data: generateTasteFeatures()},
                {name: "영양정보", data: generateNutrition()},
                {name: "서빙조리팁", data: generateServingTips()}
            ];

            sheets.forEach(sheet => {
                const ws = XLSX.utils.aoa_to_sheet(sheet.data);
                XLSX.utils.book_append_sheet(wb, ws, sheet.name);
            });

            // 파일 다운로드
            XLSX.writeFile(wb, "튀김류_상세레시피.xlsx");
        }
    </script>
</body>
</html>