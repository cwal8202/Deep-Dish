<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¼ë©´ ëŒ€ë¶„ë¥˜ í†µí•© ë ˆì‹œí”¼ ìƒì„±</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 50px auto;
            padding: 20px;
            background: linear-gradient(135deg, #ffcc00 0%, #ff6600 50%, #cc3300 100%);
            min-height: 100vh;
        }
        .container {
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            text-align: center;
            backdrop-filter: blur(10px);
        }
        h1 {
            color: #cc3300;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            font-size: 2.2em;
        }
        .category-info {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #ff6600;
        }
        .category-list {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .category-item {
            background: linear-gradient(135deg, #ff6600 0%, #ff8800 100%);
            color: white;
            padding: 10px 15px;
            border-radius: 25px;
            margin: 5px;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(255,102,0,0.3);
        }
        .download-btn {
            background: linear-gradient(135deg, #cc3300 0%, #ff4400 100%);
            color: white;
            padding: 18px 35px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            margin: 15px;
            transition: all 0.3s;
            box-shadow: 0 6px 20px rgba(204,51,0,0.4);
        }
        .download-btn:hover {
            background: linear-gradient(135deg, #aa2200 0%, #dd3300 100%);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(204,51,0,0.6);
        }
        .download-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .status {
            margin: 25px 0;
            padding: 20px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 16px;
        }
        .success {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            color: #155724;
            border: 2px solid #28a745;
        }
        .processing {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            color: #856404;
            border: 2px solid #ffc107;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸœ ë¼ë©´ ëŒ€ë¶„ë¥˜ í†µí•© ë ˆì‹œí”¼ ğŸ²</h1>
        
        <div class="category-info">
            <h3>í¬í•¨ëœ ì¤‘ë¶„ë¥˜ ì¹´í…Œê³ ë¦¬</h3>
            <div class="category-list">
                <div class="category-item">ë´‰ì§€ë¼ë©´</div>
                <div class="category-item">ìƒë¼ë©´</div>
                <div class="category-item">ë§¤ì¥ë¼ë©´</div>
            </div>
            <p><strong>ì´ 11ê°œ ìƒì„¸ë©”ë‰´</strong>ì˜ ì™„ì „í•œ ë ˆì‹œí”¼ê°€ í¬í•¨ë©ë‹ˆë‹¤</p>
        </div>
        
        <div id="status" class="status processing">ë¼ë©´ ëŒ€ë¶„ë¥˜ í†µí•© ë ˆì‹œí”¼ íŒŒì¼ì„ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...</div>
        <button id="downloadBtn" class="download-btn" disabled onclick="downloadRecipe()">
            ë¼ë©´ëŒ€ë¶„ë¥˜_í†µí•©ë ˆì‹œí”¼.xlsx ë‹¤ìš´ë¡œë“œ
        </button>
    </div>

    <script>
        // ë¼ë©´ ëŒ€ë¶„ë¥˜ ì „ì²´ ìƒì„¸ë©”ë‰´ ë°ì´í„°
        const detailMenus = [
            {name: "ì‹ ë¼ë©´", category: "ë´‰ì§€ë¼ë©´", subCategory: "ê¸°ë³¸ë¼ë©´", visual: "ë¹¨ê°„ êµ­ë¬¼, ë©´, ê±´ë”ê¸°"},
            {name: "ë„ˆêµ¬ë¦¬", category: "ë´‰ì§€ë¼ë©´", subCategory: "ê¸°ë³¸ë¼ë©´", visual: "ì§„í•œ êµ­ë¬¼, ë‘êº¼ìš´ ë©´, ë¯¸ì—­"},
            {name: "ì§œíŒŒê²Œí‹°", category: "ë´‰ì§€ë¼ë©´", subCategory: "ê¸°ë³¸ë¼ë©´", visual: "ê²€ì€ ì§œì¥, ë³¶ìŒë©´"},
            {name: "ì»µë¼ë©´", category: "ë´‰ì§€ë¼ë©´", subCategory: "ì»µë¼ë©´", visual: "ì»µ ìš©ê¸°, ê°„í¸í•¨"},
            {name: "ìš©ê¸°ë©´", category: "ë´‰ì§€ë¼ë©´", subCategory: "ì»µë¼ë©´", visual: "í”Œë¼ìŠ¤í‹± ìš©ê¸°, í° ì‚¬ì´ì¦ˆ"},
            {name: "ìƒë¼ë©´", category: "ìƒë¼ë©´", subCategory: "ìƒë¼ë©´", visual: "ì«„ê¹ƒí•œ ìƒë©´, ë§‘ì€ êµ­ë¬¼"},
            {name: "ì«„ë©´", category: "ìƒë¼ë©´", subCategory: "ìƒë¼ë©´", visual: "ì«„ê¹ƒí•œ ë©´, ë§¤ì½¤í•œ ì–‘ë…"},
            {name: "ëƒ‰ë¼ë©´", category: "ìƒë¼ë©´", subCategory: "ìƒë¼ë©´", visual: "ì°¨ê°€ìš´ êµ­ë¬¼, ì‹œì›í•¨"},
            {name: "ë¼ë©˜", category: "ë§¤ì¥ë¼ë©´", subCategory: "ë¼ë©˜", visual: "ì§„í•œ ëˆì½”ì¸ , ì¼ë³¸ì‹"},
            {name: "ìš°ë™", category: "ë§¤ì¥ë¼ë©´", subCategory: "ë¼ë©˜", visual: "ë‘êº¼ìš´ ë©´, ë§‘ì€ êµ­ë¬¼"},
            {name: "ì†Œë°”", category: "ë§¤ì¥ë¼ë©´", subCategory: "ë¼ë©˜", visual: "ë©”ë°€ë©´, ì¯”ìœ "}
        ];

        // ë ˆì‹œí”¼ ë°ì´í„° ìƒì„± í•¨ìˆ˜ë“¤
        function generateIngredients() {
            const ingredients = [
                ["ì‹ì¬ë£Œ"].concat(detailMenus.map(m => m.name))
            ];

            const ingredientData = {
                "ì‹ ë¼ë©´": ["1ë´‰", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "ë„ˆêµ¬ë¦¬": ["-", "1ë´‰", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "ì§œíŒŒê²Œí‹°": ["-", "-", "1ë´‰", "-", "-", "-", "-", "-", "-", "-", "-"],
                "ì»µë¼ë©´": ["-", "-", "-", "1ê°œ", "-", "-", "-", "-", "-", "-", "-"],
                "ìš©ê¸°ë©´": ["-", "-", "-", "-", "1ê°œ", "-", "-", "-", "-", "-", "-"],
                "ìƒë¼ë©´": ["-", "-", "-", "-", "-", "1ì¸ë¶„", "-", "-", "-", "-", "-"],
                "ì«„ë©´": ["-", "-", "-", "-", "-", "-", "1ì¸ë¶„", "-", "-", "-", "-"],
                "ë¼ë©´": ["-", "-", "-", "-", "-", "-", "-", "1ì¸ë¶„", "1ì¸ë¶„", "1ì¸ë¶„", "-"],
                "ìš°ë™ë©´": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "1ì¸ë¶„", "-"],
                "ì†Œë°”ë©´": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "1ì¸ë¶„"],
                "ë¬¼": ["550ml", "550ml", "500ml", "ì»µ í‘œì‹œì„ ", "ìš©ê¸° í‘œì‹œì„ ", "6ì»µ", "2ì»µ", "6ì»µ", "6ì»µ", "6ì»µ", "4ì»µ"],
                "ê³„ë€": ["1ê°œ", "1ê°œ", "1ê°œ", "1ê°œ", "1ê°œ", "1ê°œ", "-", "1ê°œ", "1ê°œ", "1ê°œ", "-"],
                "ëŒ€íŒŒ": ["1ëŒ€", "1ëŒ€", "1/2ëŒ€", "1/2ëŒ€", "1/2ëŒ€", "1ëŒ€", "1ëŒ€", "2ëŒ€", "2ëŒ€", "2ëŒ€", "1ëŒ€"],
                "ì–‘íŒŒ": ["-", "-", "-", "-", "-", "1/2ê°œ", "1/2ê°œ", "1/2ê°œ", "1/2ê°œ", "1/2ê°œ", "-"],
                "ë‹¹ê·¼": ["-", "-", "-", "-", "-", "1/4ê°œ", "1/4ê°œ", "-", "1/4ê°œ", "1/4ê°œ", "-"],
                "ì–‘ë°°ì¶”": ["-", "-", "-", "-", "-", "-", "1/4ê°œ", "-", "-", "-", "-"],
                "ì˜¤ì´": ["-", "-", "-", "-", "-", "-", "1/2ê°œ", "1/2ê°œ", "-", "-", "-"],
                "ìˆ™ì£¼": ["-", "-", "-", "-", "-", "-", "100g", "-", "-", "-", "-"],
                "ë¼ì§€ê³ ê¸°": ["-", "-", "-", "-", "-", "-", "-", "-", "100g", "-", "-"],
                "ì–´ë¬µ": ["-", "-", "-", "-", "-", "-", "-", "-", "100g", "100g", "-"],
                "ë©¸ì¹˜": ["-", "-", "-", "-", "-", "10ë§ˆë¦¬", "-", "2ì»µ", "15ë§ˆë¦¬", "15ë§ˆë¦¬", "-"],
                "ë‹¤ì‹œë§ˆ": ["-", "-", "-", "-", "-", "1ì¡°ê°", "-", "1ì¡°ê°", "2ì¡°ê°", "2ì¡°ê°", "-"],
                "ë¯¸ì—­": ["-", "ì ë‹¹ëŸ‰", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "ê¹€": ["ì ë‹¹ëŸ‰", "ì ë‹¹ëŸ‰", "-", "-", "-", "-", "-", "ì ë‹¹ëŸ‰", "-", "-", "-"],
                "ë‚˜ë£¨í† ": ["-", "-", "-", "-", "-", "-", "-", "-", "ì ë‹¹ëŸ‰", "-", "-"],
                "ì°¨ìŠˆ": ["-", "-", "-", "-", "-", "-", "-", "-", "ì ë‹¹ëŸ‰", "-", "-"],
                "ì½©ë‚˜ë¬¼": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "100g", "-"]
            };

            Object.keys(ingredientData).forEach(ingredient => {
                ingredients.push([ingredient].concat(ingredientData[ingredient]));
            });

            return ingredients;
        }

        function generateSauces() {
            const sauces = [
                ["ì–‘ë…/ì†ŒìŠ¤"].concat(detailMenus.map(m => m.name))
            ];

            const sauceData = {
                "ë¼ë©´ìŠ¤í”„": ["1ë´‰", "1ë´‰", "-", "1ë´‰", "1ë´‰", "-", "-", "-", "-", "-", "-"],
                "ê±´ë”ê¸°ìŠ¤í”„": ["1ë´‰", "1ë´‰", "-", "1ë´‰", "1ë´‰", "-", "-", "-", "-", "-", "-"],
                "ì§œì¥ë¶„ë§": ["-", "-", "1ë´‰", "-", "-", "-", "-", "-", "-", "-", "-"],
                "ê¸°ë¦„": ["-", "-", "1ë´‰", "-", "-", "-", "-", "-", "-", "-", "-"],
                "ê°„ì¥": ["-", "-", "-", "-", "-", "2í°ìˆ ", "-", "-", "3í°ìˆ ", "2í°ìˆ ", "-"],
                "ì†Œê¸ˆ": ["-", "-", "-", "-", "-", "ì ë‹¹ëŸ‰", "ì ë‹¹ëŸ‰", "ì ë‹¹ëŸ‰", "ì ë‹¹ëŸ‰", "ì ë‹¹ëŸ‰", "ì ë‹¹ëŸ‰"],
                "ì„¤íƒ•": ["-", "-", "-", "-", "-", "-", "2í°ìˆ ", "1í°ìˆ ", "-", "-", "-"],
                "ì‹ì´ˆ": ["-", "-", "-", "-", "-", "-", "2í°ìˆ ", "3í°ìˆ ", "-", "-", "-"],
                "ê³ ì¶”ì¥": ["-", "-", "-", "-", "-", "-", "2í°ìˆ ", "-", "-", "-", "-"],
                "ê³ ì¶§ê°€ë£¨": ["-", "-", "-", "-", "-", "-", "1í°ìˆ ", "-", "-", "-", "-"],
                "ì°¸ê¸°ë¦„": ["-", "-", "-", "-", "-", "1í°ìˆ ", "1í°ìˆ ", "1í°ìˆ ", "1í°ìˆ ", "1í°ìˆ ", "-"],
                "ê¹¨ì†Œê¸ˆ": ["-", "-", "-", "-", "-", "1í°ìˆ ", "1í°ìˆ ", "-", "-", "-", "-"],
                "ë‹¤ì§„ë§ˆëŠ˜": ["-", "-", "-", "-", "-", "1í°ìˆ ", "1í°ìˆ ", "-", "1í°ìˆ ", "1í°ìˆ ", "-"],
                "ìƒê°•ì¦™": ["-", "-", "-", "-", "-", "-", "-", "-", "1ì‘ì€ìˆ ", "1ì‘ì€ìˆ ", "-"],
                "ë¯¸ì†Œ": ["-", "-", "-", "-", "-", "-", "-", "-", "ì„ íƒì‚¬í•­", "-", "-"],
                "ì¯”ìœ ": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "3í°ìˆ "],
                "ì™€ì‚¬ë¹„": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "ì ë‹¹ëŸ‰"],
                "í›„ì¶”": ["-", "-", "-", "-", "-", "ì¡°ê¸ˆ", "-", "-", "ì¡°ê¸ˆ", "ì¡°ê¸ˆ", "-"]
            };

            Object.keys(sauceData).forEach(sauce => {
                sauces.push([sauce].concat(sauceData[sauce]));
            });

            return sauces;
        }

        function generateBroth() {
            const broth = [
                ["ìœ¡ìˆ˜/ë² ì´ìŠ¤"].concat(detailMenus.map(m => m.name))
            ];

            const brothData = {
                "ë¬¼": ["550ml", "550ml", "500ml", "í‘œì‹œì„ ê¹Œì§€", "í‘œì‹œì„ ê¹Œì§€", "6ì»µ", "2ì»µ", "6ì»µ", "6ì»µ", "6ì»µ", "4ì»µ"],
                "ë©¸ì¹˜ìœ¡ìˆ˜": ["-", "-", "-", "-", "-", "ê¸°ë³¸", "-", "ê¸°ë³¸", "ê¸°ë³¸", "ê¸°ë³¸", "-"],
                "ë‹¤ì‹œë§ˆìœ¡ìˆ˜": ["-", "-", "-", "-", "-", "ê¸°ë³¸", "-", "ê¸°ë³¸", "ê¸°ë³¸", "ê¸°ë³¸", "-"],
                "ëˆì½”ì¸ ìœ¡ìˆ˜": ["-", "-", "-", "-", "-", "-", "-", "-", "ì„ íƒì‚¬í•­", "-", "-"],
                "ë©¸ì¹˜ë‹¤ì‹œë§ˆìœ¡ìˆ˜": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "ê¸°ë³¸"],
                "ì°¬ë¬¼": ["-", "-", "-", "-", "-", "-", "-", "ì–¼ìŒë¬¼", "-", "-", "-"],
                "ì–¼ìŒ": ["-", "-", "-", "-", "-", "-", "-", "ì ë‹¹ëŸ‰", "-", "-", "-"]
            };

            Object.keys(brothData).forEach(item => {
                broth.push([item].concat(brothData[item]));
            });

            return broth;
        }

        function generateCookingSteps() {
            const steps = [];
            
            // ë©”ë‰´ë³„ë¡œ ê°œë³„ ì¡°ë¦¬ìˆœì„œ ìƒì„± (ë‹¨ê³„ ìˆ˜ê°€ ë‹¤ë¦„)
            const cookingSteps = {
                "ì‹ ë¼ë©´": [
                    "1ë‹¨ê³„: ëƒ„ë¹„ì— ë¬¼ 550mlë¥¼ ë„£ê³  ë“ì¸ë‹¤",
                    "2ë‹¨ê³„: ë¬¼ì´ ë“ìœ¼ë©´ ë©´ì„ ë„£ê³  4ë¶„ê°„ ë“ì¸ë‹¤",
                    "3ë‹¨ê³„: ìŠ¤í”„ì™€ ê±´ë”ê¸°ë¥¼ ë„£ê³  ì˜ ì„ëŠ”ë‹¤",
                    "4ë‹¨ê³„: ê³„ë€ì„ í’€ì–´ ë„£ê³  ëŒ€íŒŒë¥¼ ì†¡ì†¡ ì°ì–´ ë„£ëŠ”ë‹¤",
                    "5ë‹¨ê³„: 1ë¶„ ë” ë“ì¸ í›„ ê·¸ë¦‡ì— ë‹´ì•„ ì™„ì„±í•œë‹¤"
                ],
                "ë„ˆêµ¬ë¦¬": [
                    "1ë‹¨ê³„: ëƒ„ë¹„ì— ë¬¼ 550mlë¥¼ ë„£ê³  ë“ì¸ë‹¤",
                    "2ë‹¨ê³„: ë¬¼ì´ ë“ìœ¼ë©´ ë©´ê³¼ ë¯¸ì—­ì„ ë„£ê³  ë“ì¸ë‹¤",
                    "3ë‹¨ê³„: 4ë¶„ê°„ ë“ì¸ í›„ ìŠ¤í”„ë¥¼ ë„£ëŠ”ë‹¤",
                    "4ë‹¨ê³„: ê³„ë€ê³¼ ëŒ€íŒŒë¥¼ ë„£ê³  1ë¶„ ë” ë“ì¸ë‹¤",
                    "5ë‹¨ê³„: ê·¸ë¦‡ì— ë‹´ê³  ê¹€ì„ ì˜¬ë ¤ ì™„ì„±í•œë‹¤"
                ],
                "ì§œíŒŒê²Œí‹°": [
                    "1ë‹¨ê³„: ëƒ„ë¹„ì— ë¬¼ 500mlë¥¼ ë„£ê³  ë“ì¸ë‹¤",
                    "2ë‹¨ê³„: ë©´ì„ ë„£ê³  4ë¶„ê°„ ë“ì¸ë‹¤",
                    "3ë‹¨ê³„: ë¬¼ì„ 8ìˆŸê°€ë½ ì •ë„ ë‚¨ê¸°ê³  ë²„ë¦°ë‹¤",
                    "4ë‹¨ê³„: ì§œì¥ë¶„ë§ê³¼ ê¸°ë¦„ì„ ë„£ê³  ì˜ ì„ëŠ”ë‹¤",
                    "5ë‹¨ê³„: ëŒ€íŒŒë¥¼ ë„£ê³  ë³¶ë“¯ì´ ì„ì–´ ì™„ì„±í•œë‹¤"
                ],
                "ì»µë¼ë©´": [
                    "1ë‹¨ê³„: ì»µë¼ë©´ ëšœê»‘ì„ ì—´ê³  ìŠ¤í”„ë¥¼ ë„£ëŠ”ë‹¤",
                    "2ë‹¨ê³„: í‘œì‹œì„ ê¹Œì§€ ë“ëŠ” ë¬¼ì„ ë¶“ëŠ”ë‹¤",
                    "3ë‹¨ê³„: ëšœê»‘ì„ ë®ê³  3-4ë¶„ê°„ ê¸°ë‹¤ë¦°ë‹¤",
                    "4ë‹¨ê³„: ì˜ ì €ì–´ì¤€ í›„ ë°”ë¡œ ì„­ì·¨í•œë‹¤"
                ],
                "ìš©ê¸°ë©´": [
                    "1ë‹¨ê³„: ìš©ê¸°ë©´ì„ ê°œë´‰í•˜ê³  ìŠ¤í”„ë¥¼ ë„£ëŠ”ë‹¤",
                    "2ë‹¨ê³„: í‘œì‹œì„ ê¹Œì§€ ë“ëŠ” ë¬¼ì„ ë¶“ëŠ”ë‹¤",
                    "3ë‹¨ê³„: ëšœê»‘ì„ ë®ê³  4-5ë¶„ê°„ ê¸°ë‹¤ë¦°ë‹¤",
                    "4ë‹¨ê³„: ì˜ ì €ì–´ì¤€ í›„ ì™„ì„±í•œë‹¤"
                ],
                "ìƒë¼ë©´": [
                    "1ë‹¨ê³„: ë©¸ì¹˜ 10ë§ˆë¦¬ì™€ ë‹¤ì‹œë§ˆ 1ì¡°ê°ìœ¼ë¡œ ìœ¡ìˆ˜ë¥¼ ìš°ë¦°ë‹¤",
                    "2ë‹¨ê³„: ìœ¡ìˆ˜ê°€ ë“ìœ¼ë©´ ë©¸ì¹˜ì™€ ë‹¤ì‹œë§ˆë¥¼ ê±´ì ¸ë‚¸ë‹¤",
                    "3ë‹¨ê³„: ìƒë¼ë©´ì„ ë„£ê³  3-4ë¶„ê°„ ë“ì¸ë‹¤",
                    "4ë‹¨ê³„: ê°„ì¥ 2í°ìˆ , ì†Œê¸ˆìœ¼ë¡œ ê°„ì„ ë§ì¶˜ë‹¤",
                    "5ë‹¨ê³„: ì–‘íŒŒ, ë‹¹ê·¼ì„ ë„£ê³  2ë¶„ ë” ë“ì¸ë‹¤",
                    "6ë‹¨ê³„: ê³„ë€ê³¼ ëŒ€íŒŒë¥¼ ë„£ê³  1ë¶„ ë“ì—¬ ì™„ì„±í•œë‹¤"
                ],
                "ì«„ë©´": [
                    "1ë‹¨ê³„: ì«„ë©´ì„ ë“ëŠ” ë¬¼ì— 3-4ë¶„ê°„ ì‚¶ëŠ”ë‹¤",
                    "2ë‹¨ê³„: ì°¬ë¬¼ì— í—¹ê¶ˆ ì „ë¶„ê¸°ë¥¼ ì œê±°í•œë‹¤",
                    "3ë‹¨ê³„: ì–‘ë°°ì¶”, ë‹¹ê·¼, ì˜¤ì´, ìˆ™ì£¼ë¥¼ ì±„ ì¬ë‹¤",
                    "4ë‹¨ê³„: ê³ ì¶”ì¥ 2í°ìˆ , ì‹ì´ˆ 2í°ìˆ , ì„¤íƒ• 2í°ìˆ , ê³ ì¶§ê°€ë£¨ 1í°ìˆ ì„ ì„ì–´ ì–‘ë…ì¥ì„ ë§Œë“ ë‹¤",
                    "5ë‹¨ê³„: ë©´ê³¼ ì•¼ì±„ë¥¼ ì„ê³  ì–‘ë…ì¥ì„ ë„£ëŠ”ë‹¤",
                    "6ë‹¨ê³„: ì°¸ê¸°ë¦„ê³¼ ê¹¨ì†Œê¸ˆì„ ë„£ê³  ì˜ ë¹„ë²¼ ì™„ì„±í•œë‹¤"
                ],
                "ëƒ‰ë¼ë©´": [
                    "1ë‹¨ê³„: ë¼ë©´ì„ ì‚¶ì•„ ì°¬ë¬¼ì— í—¹ê¶ˆ ì¤€ë¹„í•œë‹¤",
                    "2ë‹¨ê³„: ë©¸ì¹˜ì™€ ë‹¤ì‹œë§ˆë¡œ ìœ¡ìˆ˜ë¥¼ ìš°ë ¤ ì‹íŒë‹¤",
                    "3ë‹¨ê³„: ì°¨ê°€ìš´ ìœ¡ìˆ˜ì— ì‹ì´ˆ 3í°ìˆ , ì„¤íƒ• 1í°ìˆ ì„ ë„£ëŠ”ë‹¤",
                    "4ë‹¨ê³„: ì˜¤ì´ë¥¼ ì±„ ì°ì–´ ì¤€ë¹„í•œë‹¤",
                    "5ë‹¨ê³„: ê·¸ë¦‡ì— ë©´ì„ ë‹´ê³  ì°¨ê°€ìš´ êµ­ë¬¼ì„ ë¶€ì€ë‹¤",
                    "6ë‹¨ê³„: ì˜¤ì´ì™€ ê³„ë€ì„ ì˜¬ë¦¬ê³  ì–¼ìŒì„ ë„£ì–´ ì™„ì„±í•œë‹¤"
                ],
                "ë¼ë©˜": [
                    "1ë‹¨ê³„: ë©¸ì¹˜ 15ë§ˆë¦¬ì™€ ë‹¤ì‹œë§ˆ 2ì¡°ê°ìœ¼ë¡œ ì§„í•œ ìœ¡ìˆ˜ë¥¼ ìš°ë¦°ë‹¤",
                    "2ë‹¨ê³„: ë¼ì§€ê³ ê¸° 100gì„ ë³¶ì•„ ì¤€ë¹„í•œë‹¤",
                    "3ë‹¨ê³„: ë¼ë©´ì„ ë“ëŠ” ë¬¼ì— 3ë¶„ê°„ ì‚¶ëŠ”ë‹¤",
                    "4ë‹¨ê³„: ê·¸ë¦‡ì— ê°„ì¥ 3í°ìˆ ê³¼ ëœ¨ê±°ìš´ ìœ¡ìˆ˜ë¥¼ ë„£ëŠ”ë‹¤",
                    "5ë‹¨ê³„: ì‚¶ì€ ë©´ì„ ë„£ê³  ë¼ì§€ê³ ê¸°, ì–´ë¬µì„ ì˜¬ë¦°ë‹¤",
                    "6ë‹¨ê³„: ê³„ë€, ëŒ€íŒŒ, ë‚˜ë£¨í† , ì°¨ìŠˆë¥¼ ì˜¬ë ¤ ì™„ì„±í•œë‹¤"
                ],
                "ìš°ë™": [
                    "1ë‹¨ê³„: ë©¸ì¹˜ì™€ ë‹¤ì‹œë§ˆë¡œ ë§‘ì€ ìœ¡ìˆ˜ë¥¼ ìš°ë¦°ë‹¤",
                    "2ë‹¨ê³„: ìš°ë™ë©´ì„ ë“ëŠ” ë¬¼ì— ì‚¶ëŠ”ë‹¤",
                    "3ë‹¨ê³„: ì–´ë¬µê³¼ ì½©ë‚˜ë¬¼ì„ ì¤€ë¹„í•œë‹¤",
                    "4ë‹¨ê³„: ìœ¡ìˆ˜ì— ê°„ì¥ê³¼ ì†Œê¸ˆìœ¼ë¡œ ê°„ì„ ë§ì¶˜ë‹¤",
                    "5ë‹¨ê³„: ê·¸ë¦‡ì— ë©´ì„ ë‹´ê³  ëœ¨ê±°ìš´ ìœ¡ìˆ˜ë¥¼ ë¶“ëŠ”ë‹¤",
                    "6ë‹¨ê³„: ì–´ë¬µ, ì½©ë‚˜ë¬¼, ëŒ€íŒŒë¥¼ ì˜¬ë ¤ ì™„ì„±í•œë‹¤"
                ],
                "ì†Œë°”": [
                    "1ë‹¨ê³„: ì†Œë°”ë©´ì„ ë“ëŠ” ë¬¼ì— ì‚¶ëŠ”ë‹¤",
                    "2ë‹¨ê³„: ì°¬ë¬¼ì— ì—¬ëŸ¬ ë²ˆ í—¹ê¶ˆ ì „ë¶„ê¸°ë¥¼ ì œê±°í•œë‹¤",
                    "3ë‹¨ê³„: ë©¸ì¹˜ë‹¤ì‹œë§ˆ ìœ¡ìˆ˜ë¥¼ ìš°ë ¤ ì‹íŒë‹¤",
                    "4ë‹¨ê³„: ì°¨ê°€ìš´ ìœ¡ìˆ˜ì— ì¯”ìœ  3í°ìˆ ì„ ë„£ì–´ êµ­ë¬¼ì„ ë§Œë“ ë‹¤",
                    "5ë‹¨ê³„: ê·¸ë¦‡ì— ë©´ì„ ë‹´ê³  ì°¨ê°€ìš´ êµ­ë¬¼ì„ ë¶€ë¥¸ë‹¤",
                    "6ë‹¨ê³„: ëŒ€íŒŒì™€ ì™€ì‚¬ë¹„ë¥¼ ê³ë“¤ì—¬ ì™„ì„±í•œë‹¤"
                ]
            };

            // ê° ë©”ë‰´ë³„ ì¡°ë¦¬ìˆœì„œë¥¼ í…Œì´ë¸” í˜•íƒœë¡œ ë³€í™˜
            const maxSteps = Math.max(...Object.values(cookingSteps).map(steps => steps.length));
            
            for (let i = 1; i <= maxSteps; i++) {
                const stepRow = [`${i}ë‹¨ê³„`];
                detailMenus.forEach(menu => {
                    const menuSteps = cookingSteps[menu.name];
                    const stepText = menuSteps && menuSteps[i-1] ? menuSteps[i-1].replace(`${i}ë‹¨ê³„: `, '') : '-';
                    stepRow.push(stepText);
                });
                steps.push(stepRow);
            }

            return [["ì¡°ë¦¬ìˆœì„œ"].concat(detailMenus.map(m => m.name))].concat(steps);
        }

        function generateCookingInfo() {
            const info = [
                ["ì¡°ë¦¬ì •ë³´"].concat(detailMenus.map(m => m.name))
            ];

            const infoData = {
                "ì¡°ë¦¬ì‹œê°„": ["8ë¶„", "8ë¶„", "8ë¶„", "5ë¶„", "6ë¶„", "20ë¶„", "15ë¶„", "25ë¶„", "30ë¶„", "20ë¶„", "15ë¶„"],
                "ë‚œì´ë„": ["ì´ˆê¸‰", "ì´ˆê¸‰", "ì´ˆê¸‰", "ì´ˆê¸‰", "ì´ˆê¸‰", "ì´ˆê¸‰", "ì´ˆê¸‰", "ì´ˆê¸‰", "ì¤‘ê¸‰", "ì´ˆê¸‰", "ì´ˆê¸‰"],
                "ì¹¼ë¡œë¦¬(1ì¸ë¶„)": ["510kcal", "530kcal", "540kcal", "480kcal", "520kcal", "420kcal", "380kcal", "350kcal", "650kcal", "480kcal", "320kcal"],
                "ì¸ë¶„": ["1ì¸ë¶„", "1ì¸ë¶„", "1ì¸ë¶„", "1ì¸ë¶„", "1ì¸ë¶„", "1ì¸ë¶„", "1ì¸ë¶„", "1ì¸ë¶„", "1ì¸ë¶„", "1ì¸ë¶„", "1ì¸ë¶„"],
                "ë³´ê´€ë°©ë²•": ["ë‹¹ì¼ ì„­ì·¨", "ë‹¹ì¼ ì„­ì·¨", "ë‹¹ì¼ ì„­ì·¨", "ë‹¹ì¼ ì„­ì·¨", "ë‹¹ì¼ ì„­ì·¨", "ë‹¹ì¼ ì„­ì·¨", "ë‹¹ì¼ ì„­ì·¨", "ë‹¹ì¼ ì„­ì·¨", "ë‹¹ì¼ ì„­ì·¨", "ë‹¹ì¼ ì„­ì·¨", "ë‹¹ì¼ ì„­ì·¨"]
            };

            Object.keys(infoData).forEach(info_item => {
                info.push([info_item].concat(infoData[info_item]));
            });

            return info;
        }

        function generateTasteFeatures() {
            const taste = [
                ["íŠ¹ì§•/ë§›"].concat(detailMenus.map(m => m.name))
            ];

            const tasteData = {
                "ì£¼ìš”ë§›": ["ë§¤ì½¤í•œë§›", "êµ¬ìˆ˜í•œë§›", "ì§œì¥ë§›", "ë§¤ì½¤í•œë§›", "ë§¤ì½¤í•œë§›", "ë‹´ë°±í•œë§›", "ë§¤ì½¤ìƒˆì½¤", "ì‹œì›í•œë§›", "ì§„í•œë§›", "ë‹´ë°±í•œë§›", "ê³ ì†Œí•œë§›"],
                "ë§¤ìš´ì •ë„": ["ë§¤ì›€", "ë³´í†µ", "ìˆœí•¨", "ë§¤ì›€", "ë§¤ì›€", "ìˆœí•¨", "ë³´í†µ", "ìˆœí•¨", "ë³´í†µ", "ìˆœí•¨", "ìˆœí•¨"],
                "íŠ¹ì§•": ["í•œêµ­ëŒ€í‘œë¼ë©´", "ë‘êº¼ìš´ë©´ê³¼ë¯¸ì—­", "ì§œì¥ë©´ìŠ¤íƒ€ì¼", "ê°„í¸í•œì»µë¼ë©´", "í°ìš©ê¸°ê°„í¸í•¨", "ì«„ê¹ƒí•œìƒë©´", "ì«„ë©´ì˜ë§¤ì½¤í•¨", "ì‹œì›í•œëƒ‰ë©´", "ì¼ë³¸ë¼ë©˜ìŠ¤íƒ€ì¼", "ë¶€ë“œëŸ¬ìš´ìš°ë™", "ë©”ë°€ì†Œë°”í–¥"],
                "ì¶”ì²œìƒí™©": ["ê°„í¸ì‹ì‚¬", "ë“ ë“ í•œí•œë¼", "ê°„ì‹", "ê°„í¸ê°„ì‹", "ë“ ë“ í•œê°„ì‹", "ì œëŒ€ë¡œëœì‹ì‚¬", "ë§¤ìš´ë§›ì¢‹ì„ë•Œ", "ë”ìš´ë‚ ", "ì§„ì§œë¼ë©˜ë§›", "ë”°ëœ»í•œêµ­ë¬¼", "ê¹”ë”í•œì‹ì‚¬"]
            };

            Object.keys(tasteData).forEach(taste_item => {
                taste.push([taste_item].concat(tasteData[taste_item]));
            });

            return taste;
        }

        function generateNutrition() {
            const nutrition = [
                ["ì˜ì–‘ì •ë³´"].concat(detailMenus.map(m => m.name))
            ];

            const nutritionData = {
                "ë‹¨ë°±ì§ˆ(g)": ["12", "13", "11", "11", "12", "15", "12", "10", "25", "18", "12"],
                "íƒ„ìˆ˜í™”ë¬¼(g)": ["80", "82", "85", "75", "80", "65", "60", "55", "75", "70", "50"],
                "ì§€ë°©(g)": ["15", "16", "18", "14", "16", "8", "10", "6", "25", "12", "2"],
                "ë‚˜íŠ¸ë¥¨(mg)": ["1800", "1900", "1600", "1700", "1750", "1200", "1400", "1000", "2200", "1500", "800"],
                "ì‹ì´ì„¬ìœ (g)": ["4", "5", "3", "3", "4", "3", "6", "4", "5", "4", "8"],
                "ë¹„íƒ€ë¯¼C(mg)": ["2", "8", "5", "2", "3", "15", "25", "20", "10", "12", "5"],
                "ì¹¼ìŠ˜(mg)": ["50", "80", "40", "45", "50", "60", "80", "50", "100", "80", "30"],
                "ì² ë¶„(mg)": ["3", "4", "2", "3", "3", "2", "3", "2", "5", "3", "2"]
            };

            Object.keys(nutritionData).forEach(nutrition_item => {
                nutrition.push([nutrition_item].concat(nutritionData[nutrition_item]));
            });

            return nutrition;
        }

        function generateServingTips() {
            const tips = [
                ["ì„œë¹™/ì¡°ë¦¬íŒ"].concat(detailMenus.map(m => m.name))
            ];

            const tipsData = {
                "ì„œë¹™íŒ": [
                    "ëœ¨ê±°ìš¸ ë•Œ ë°”ë¡œ ê¹€ê³¼ í•¨ê»˜",
                    "ë¯¸ì—­ê³¼ í•¨ê»˜ êµ¬ìˆ˜í•˜ê²Œ",
                    "ë³¶ë“¯ì´ ë¹„ë²¼ì„œ ìœ¤ê¸°ë‚˜ê²Œ",
                    "ëœ¨ê±°ìš¸ ë•Œ ë°”ë¡œ ì„­ì·¨",
                    "ëœ¨ê±°ìš¸ ë•Œ ë°”ë¡œ ì„­ì·¨",
                    "ì«„ê¹ƒí•œ ë©´ë°œ ì‚´ë ¤ì„œ",
                    "ë§¤ì½¤í•˜ê²Œ ì˜ ë¹„ë²¼ì„œ",
                    "ì‹œì›í•˜ê²Œ ì–¼ìŒê³¼ í•¨ê»˜",
                    "ì¼ë³¸ì‹ í† í•‘ í’ì„±í•˜ê²Œ",
                    "ë”°ëœ»í•œ êµ­ë¬¼ê³¼ í•¨ê»˜",
                    "ì°¨ê°€ìš´ ì†Œë°”ì™€ ì¯”ìœ  ë”°ë¡œ"
                ],
                "ë³´ê´€íŒ": [
                    "ë©´ì´ ë¶ˆë¯€ë¡œ ë‹¹ì¼ ì„­ì·¨",
                    "ë©´ì´ ë¶ˆë¯€ë¡œ ë‹¹ì¼ ì„­ì·¨",
                    "ë³¶ìŒë©´ì€ ë³´ê´€ ë¶ˆê°€",
                    "ë‹¹ì¼ ì„­ì·¨ í•„ìˆ˜",
                    "ë‹¹ì¼ ì„­ì·¨ í•„ìˆ˜",
                    "ë©´ì´ ë¶ˆë¯€ë¡œ ë°”ë¡œ ì„­ì·¨",
                    "ì–‘ë…í•œ ìƒíƒœë¡œëŠ” ë³´ê´€ ë¶ˆê°€",
                    "ë‹¹ì¼ ì„­ì·¨ ê¶Œì¥",
                    "ë©´ê³¼ êµ­ë¬¼ ë¶„ë¦¬ ë¶ˆê°€",
                    "ë©´ì´ ë¶ˆë¯€ë¡œ ë‹¹ì¼ ì„­ì·¨",
                    "ë©´ê³¼ ì¯”ìœ  ë¶„ë¦¬ ë³´ê´€"
                ],
                "ì¡°ë¦¬íŒ": [
                    "ë©´ì„ ë„ˆë¬´ ì˜¤ë˜ ë“ì´ì§€ ë§ ê²ƒ",
                    "ë¯¸ì—­ì€ ë¯¸ë¦¬ ë¶ˆë ¤ë‘ë©´ ë” ì¢‹ìŒ",
                    "ë¬¼ì„ ì™„ì „íˆ ë²„ë¦¬ì§€ ë§ê³  ì¡°ê¸ˆ ë‚¨ê¸°ê¸°",
                    "ë¬¼ì˜ ì–‘ì„ ì •í™•íˆ ì§€í‚¤ê¸°",
                    "ëšœê»‘ì„ ê¼­ ë®ê³  ê¸°ë‹¤ë¦¬ê¸°",
                    "ìœ¡ìˆ˜ë¥¼ ì§„í•˜ê²Œ ìš°ë ¤ì•¼ ë§›ìˆìŒ",
                    "ì•¼ì±„ëŠ” ì•„ì‚­í•¨ì„ ì‚´ë¦¬ê¸°",
                    "ìœ¡ìˆ˜ëŠ” ë¯¸ë¦¬ ì°¨ê°‘ê²Œ ì‹íˆê¸°",
                    "ìœ¡ìˆ˜ê°€ ì§„í•´ì•¼ ì§„ì§œ ë¼ë©˜ë§›",
                    "ë©´ì´ ë¶ˆì§€ ì•Šê²Œ ì£¼ì˜",
                    "ì†Œë°”ëŠ” ì¶©ë¶„íˆ í—¹ê¶ˆì•¼ í•¨"
                ]
            };

            Object.keys(tipsData).forEach(tip_item => {
                tips.push([tip_item].concat(tipsData[tip_item]));
            });

            return tips;
        }

        function downloadRecipe() {
            // ìƒˆ ì›Œí¬ë¶ ìƒì„±
            const wb = XLSX.utils.book_new();

            // ê° ì‹œíŠ¸ ë°ì´í„° ìƒì„± ë° ì¶”ê°€
            const sheets = [
                {name: "ì£¼ìš”ì‹ì¬ë£Œ", data: generateIngredients()},
                {name: "ì–‘ë…ì†ŒìŠ¤", data: generateSauces()},
                {name: "ìœ¡ìˆ˜ë² ì´ìŠ¤", data: generateBroth()},
                {name: "ì¡°ë¦¬ìˆœì„œ", data: generateCookingSteps()},
                {name: "ì¡°ë¦¬ì •ë³´", data: generateCookingInfo()},
                {name: "íŠ¹ì§•ë§›", data: generateTasteFeatures()},
                {name: "ì˜ì–‘ì •ë³´", data: generateNutrition()},
                {name: "ì„œë¹™ì¡°ë¦¬íŒ", data: generateServingTips()}
            ];

            sheets.forEach(sheet => {
                const ws = XLSX.utils.aoa_to_sheet(sheet.data);
                XLSX.utils.book_append_sheet(wb, ws, sheet.name);
            });

            // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
            XLSX.writeFile(wb, "ë¼ë©´ëŒ€ë¶„ë¥˜_í†µí•©ë ˆì‹œí”¼.xlsx");
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ ì¤€ë¹„ ì™„ë£Œ ìƒíƒœë¡œ ë³€ê²½
        window.addEventListener('load', function() {
            setTimeout(() => {
                document.getElementById('status').innerHTML = 'ë¼ë©´ ëŒ€ë¶„ë¥˜ì˜ 3ê°œ ì¤‘ë¶„ë¥˜, 11ê°œ ìƒì„¸ë©”ë‰´ í†µí•© ë ˆì‹œí”¼ê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.';
                document.getElementById('status').className = 'status success';
                document.getElementById('downloadBtn').disabled = false;
            }, 1500);
        });
    </script>
</body>
</html>