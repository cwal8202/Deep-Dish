<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>죽/도시락 레시피 생성</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        .download-btn {
            background-color: #228B22;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 10px;
            transition: background-color 0.3s;
        }
        .download-btn:hover {
            background-color: #32CD32;
        }
        .download-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .status {
            margin: 20px 0;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .processing {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>죽/도시락 상세 레시피</h1>
        <div id="status" class="status processing">레시피 파일을 생성 중입니다...</div>
        <button id="downloadBtn" class="download-btn" disabled onclick="downloadRecipe()">
            죽도시락_상세레시피.xlsx 다운로드
        </button>
    </div>

    <script>
        // 죽/도시락 상세메뉴 데이터
        const detailMenus = [
            {name: "전복죽", category: "전복죽", visual: "진한 전복 국물, 쌀알, 전복 조각"},
            {name: "전복버터구이", category: "전복죽", visual: "구운 전복, 버터 향, 고소한 색"},
            {name: "소고기야채죽", category: "고기죽", visual: "소고기 조각, 야채, 진한 죽"},
            {name: "닭죽", category: "고기죽", visual: "부드러운 닭고기, 흰 죽, 구수함"},
            {name: "삼계죽", category: "고기죽", visual: "인삼, 닭고기, 영양 죽"},
            {name: "단호박죽", category: "채소죽", visual: "노란 단호박, 부드러운 질감"},
            {name: "녹두죽", category: "채소죽", visual: "연한 녹색, 고소한 녹두"},
            {name: "팥죽", category: "채소죽", visual: "빨간 팥, 달콤한 죽"},
            {name: "제육도시락", category: "도시락", visual: "제육볶음, 밥, 반찬들"},
            {name: "불고기도시락", category: "도시락", visual: "불고기, 밥, 반찬들"},
            {name: "생선구이도시락", category: "도시락", visual: "구운 생선, 밥, 반찬들"}
        ];

        // 레시피 데이터 생성 함수들
        function generateIngredients() {
            const ingredients = [
                ["식재료"].concat(detailMenus.map(m => m.name))
            ];

            const ingredientData = {
                "쌀": ["1컵", "-", "1컵", "1컵", "1컵", "1컵", "1컵", "1컵", "2컵", "2컵", "2컵"],
                "전복": ["3-4마리", "2-3마리", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "소고기(불고기용)": ["-", "-", "150g", "-", "-", "-", "-", "-", "200g", "250g", "-"],
                "닭고기": ["-", "-", "-", "300g", "1마리", "-", "-", "-", "-", "-", "-"],
                "생선(고등어/삼치)": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "1마리"],
                "단호박": ["-", "-", "-", "-", "-", "400g", "-", "-", "-", "-", "-"],
                "녹두": ["-", "-", "-", "-", "-", "-", "1컵", "-", "-", "-", "-"],
                "팥": ["-", "-", "-", "-", "-", "-", "-", "1컵", "-", "-", "-"],
                "당근": ["-", "-", "1/2개", "-", "-", "-", "-", "-", "1/2개", "1/2개", "1/2개"],
                "양파": ["1/2개", "-", "1/2개", "1/2개", "1/2개", "1/4개", "-", "-", "1개", "1개", "1/2개"],
                "대파": ["1대", "-", "1대", "1대", "1대", "1대", "-", "-", "2대", "2대", "1대"],
                "마늘": ["3쪽", "3쪽", "3쪽", "3쪽", "3쪽", "2쪽", "-", "-", "5쪽", "5쪽", "3쪽"],
                "생강": ["1조각", "-", "1조각", "1조각", "2조각", "-", "-", "-", "1조각", "1조각", "-"],
                "버터": ["-", "30g", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "인삼": ["-", "-", "-", "-", "1뿌리", "-", "-", "-", "-", "-", "-"],
                "대추": ["-", "-", "-", "-", "5개", "-", "-", "5개", "-", "-", "-"],
                "찹쌀": ["-", "-", "-", "-", "1/4컵", "-", "-", "-", "-", "-", "-"],
                "우유": ["-", "-", "-", "-", "-", "1/2컵", "-", "-", "-", "-", "-"],
                "설탕": ["-", "-", "-", "-", "-", "2큰술", "-", "3큰술", "-", "-", "-"],
                "계란": ["-", "-", "-", "-", "-", "-", "-", "-", "2개", "2개", "1개"],
                "김치": ["-", "-", "-", "-", "-", "-", "-", "-", "적당량", "-", "-"],
                "시금치": ["-", "-", "-", "-", "-", "-", "-", "-", "1봉", "1봉", "1봉"],
                "콩나물": ["-", "-", "-", "-", "-", "-", "-", "-", "100g", "100g", "100g"],
                "무": ["-", "-", "1/4개", "-", "-", "-", "-", "-", "-", "-", "-"],
                "애호박": ["-", "-", "1/2개", "-", "-", "-", "-", "-", "-", "-", "-"]
            };

            Object.keys(ingredientData).forEach(ingredient => {
                ingredients.push([ingredient].concat(ingredientData[ingredient]));
            });

            return ingredients;
        }

        function generateSauces() {
            const sauces = [
                ["양념/소스"].concat(detailMenus.map(m => m.name))
            ];

            const sauceData = {
                "소금": ["적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량", "적당량"],
                "간장": ["1큰술", "-", "2큰술", "1큰술", "1큰술", "-", "-", "-", "3큰술", "3큰술", "2큰술"],
                "참기름": ["1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "-", "1큰술", "-", "1큰술", "1큰술", "1큰술"],
                "식용유": ["2큰술", "1큰술", "2큰술", "1큰술", "1큰술", "1큰술", "1큰술", "-", "2큰술", "2큰술", "2큰술"],
                "다진마늘": ["1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "1큰술", "-", "-", "2큰술", "2큰술", "1큰술"],
                "생강즙": ["1작은술", "-", "1작은술", "1작은술", "1큰술", "-", "-", "-", "1작은술", "1작은술", "-"],
                "고추장": ["-", "-", "-", "-", "-", "-", "-", "-", "2큰술", "-", "-"],
                "설탕": ["-", "-", "1큰술", "-", "-", "2큰술", "-", "3큰술", "1큰술", "2큰술", "1큰술"],
                "고춧가루": ["-", "-", "-", "-", "-", "-", "-", "-", "1큰술", "-", "-"],
                "굴소스": ["-", "-", "1작은술", "-", "-", "-", "-", "-", "1작은술", "1큰술", "-"],
                "후추": ["조금", "조금", "조금", "조금", "조금", "-", "-", "-", "조금", "조금", "조금"],
                "맛술": ["-", "-", "1큰술", "-", "-", "-", "-", "-", "1큰술", "2큰술", "1큰술"],
                "올리고당": ["-", "-", "-", "-", "-", "-", "-", "-", "1큰술", "1큰술", "-"],
                "레몬즙": ["-", "1큰술", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "계피가루": ["-", "-", "-", "-", "-", "-", "-", "1작은술", "-", "-", "-"]
            };

            Object.keys(sauceData).forEach(sauce => {
                sauces.push([sauce].concat(sauceData[sauce]));
            });

            return sauces;
        }

        function generateBroth() {
            const broth = [
                ["육수/베이스"].concat(detailMenus.map(m => m.name))
            ];

            const brothData = {
                "물": ["6컵", "적당량", "8컵", "8컵", "10컵", "4컵", "6컵", "8컵", "-", "-", "-"],
                "전복내장우린물": ["2컵", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "닭육수": ["-", "-", "-", "기본", "기본", "-", "-", "-", "-", "-", "-"],
                "소고기육수": ["-", "-", "기본", "-", "-", "-", "-", "-", "-", "-", "-"],
                "멸치육수": ["-", "-", "-", "-", "-", "-", "기본", "-", "-", "-", "-"],
                "찬물": ["-", "-", "-", "-", "-", "-", "-", "팥 불리기용", "-", "-", "-"]
            };

            Object.keys(brothData).forEach(item => {
                broth.push([item].concat(brothData[item]));
            });

            return broth;
        }

        function generateCookingSteps() {
            const steps = [];
            
            // 메뉴별로 개별 조리순서 생성 (단계 수가 다름)
            const cookingSteps = {
                "전복죽": [
                    "1단계: 전복 3-4마리를 손질하여 내장을 분리하고, 내장으로 우린 물 2컵을 만든다",
                    "2단계: 쌀 1컵을 30분간 불린 후 물기를 빼고 참기름 1큰술로 볶는다",
                    "3단계: 전복은 적당한 크기로 썰어 다진마늘, 참기름으로 밑간한다",
                    "4단계: 볶은 쌀에 전복내장물과 물 6컵을 넣고 센 불에서 끓인다",
                    "5단계: 끓기 시작하면 중약불로 줄이고 30분간 저어가며 끓인다",
                    "6단계: 쌀이 퍼지면 전복을 넣고 5분 더 끓인다",
                    "7단계: 간장 1큰술과 소금으로 간을 맞추고 완성한다"
                ],
                "전복버터구이": [
                    "1단계: 전복 2-3마리를 손질하여 껍질에서 분리한다",
                    "2단계: 전복 속살에 칼집을 내어 부드럽게 만든다",
                    "3단계: 다진마늘, 소금, 후추로 밑간한다",
                    "4단계: 팬에 버터 30g을 녹이고 전복을 넣어 구운다",
                    "5단계: 앞뒤로 2-3분씩 구워 겉은 바삭하게 속은 부드럽게 만든다",
                    "6단계: 레몬즙을 뿌리고 참기름을 살짝 둘러 완성한다"
                ],
                "소고기야채죽": [
                    "1단계: 쌀 1컵을 30분간 불린 후 참기름으로 볶는다",
                    "2단계: 소고기 150g을 잘게 썰어 간장, 다진마늘로 밑간한다",
                    "3단계: 당근, 무, 애호박을 잘게 썰어 준비한다",
                    "4단계: 팬에 기름을 두르고 소고기를 볶은 후 야채를 넣어 볶는다",
                    "5단계: 볶은 쌀에 소고기육수 8컵을 넣고 끓인다",
                    "6단계: 중약불에서 30분간 저어가며 끓인다",
                    "7단계: 볶은 소고기와 야채를 넣고 10분 더 끓인다",
                    "8단계: 소금과 간장으로 간을 맞춰 완성한다"
                ],
                "닭죽": [
                    "1단계: 닭고기 300g을 삶아 살을 발라내고 국물을 우린다",
                    "2단계: 쌀 1컵을 불려서 참기름으로 볶는다",
                    "3단계: 발라낸 닭고기를 잘게 찢어 준비한다",
                    "4단계: 볶은 쌀에 닭육수 8컵을 넣고 끓인다",
                    "5단계: 중약불에서 25분간 저어가며 끓인다",
                    "6단계: 찢은 닭고기를 넣고 5분 더 끓여 완성한다"
                ],
                "삼계죽": [
                    "1단계: 닭 1마리에 찹쌀 1/4컵, 인삼 1뿌리, 대추 5개를 넣어 삼계탕을 만든다",
                    "2단계: 삼계탕을 1시간 끓여 닭이 무르게 만든다",
                    "3단계: 닭고기를 발라내고 국물은 체에 걸러 맑게 만든다",
                    "4단계: 쌀 1컵을 불려 참기름으로 볶는다",
                    "5단계: 볶은 쌀에 삼계탕 국물 10컵을 넣고 끓인다",
                    "6단계: 중약불에서 30분간 끓인 후 발라낸 닭고기를 넣는다",
                    "7단계: 인삼과 대추도 함께 넣고 5분 더 끓여 완성한다"
                ],
                "단호박죽": [
                    "1단계: 단호박 400g을 껍질을 벗기고 씨를 제거한 후 잘게 썬다",
                    "2단계: 썬 단호박을 찜기에 넣어 15분간 쪄서 부드럽게 만든다",
                    "3단계: 쪄진 단호박을 으깨어 페이스트로 만든다",
                    "4단계: 쌀 1컵을 불려서 믹서기에 갈아 쌀물을 만든다",
                    "5단계: 냄비에 단호박페이스트와 쌀물, 물 4컵을 넣고 끓인다",
                    "6단계: 중약불에서 20분간 저어가며 끓인다",
                    "7단계: 우유 1/2컵과 설탕 2큰술을 넣어 부드럽고 달콤하게 완성한다"
                ],
                "녹두죽": [
                    "1단계: 녹두 1컵을 찬물에 4시간 불린다",
                    "2단계: 불린 녹두를 믹서기에 갈아 녹두물을 만든다",
                    "3단계: 녹두물을 체에 걸러 앙금과 분리한다",
                    "4단계: 냄비에 녹두앙금과 멸치육수 6컵을 넣고 끓인다",
                    "5단계: 중약불에서 30분간 저어가며 끓인다",
                    "6단계: 소금과 참기름으로 간을 맞춰 완성한다"
                ],
                "팥죽": [
                    "1단계: 팥 1컵을 찬물에 하룻밤 불린다",
                    "2단계: 불린 팥을 물 8컵과 함께 1시간 삶는다",
                    "3단계: 삶은 팥을 체에 걸러 팥물과 팥앙금을 분리한다",
                    "4단계: 팥물에 쌀 1컵(불린 것)을 넣고 끓인다",
                    "5단계: 중약불에서 30분간 끓인 후 팥앙금을 넣는다",
                    "6단계: 설탕 3큰술, 계피가루, 대추를 넣고 10분 더 끓여 완성한다"
                ],
                "제육도시락": [
                    "1단계: 밥 2컵을 짓고, 돼지고기 200g을 제육볶음용으로 양념한다",
                    "2단계: 팬에서 제육볶음을 만든다 (고추장, 간장, 설탕, 고춧가루 사용)",
                    "3단계: 계란 2개로 계란말이를 만든다",
                    "4단계: 시금치나물, 콩나물무침, 김치를 준비한다",
                    "5단계: 도시락 용기에 밥을 담고 제육볶음을 올린다",
                    "6단계: 계란말이와 반찬들을 예쁘게 담아 완성한다"
                ],
                "불고기도시락": [
                    "1단계: 밥 2컵을 짓고, 소고기 250g을 불고기용으로 얇게 썬다",
                    "2단계: 불고기 양념(간장, 설탕, 맛술, 다진마늘, 굴소스)을 만든다",
                    "3단계: 고기에 양념을 재우고 30분간 둔다",
                    "4단계: 팬에 양념한 고기를 볶아 불고기를 만든다",
                    "5단계: 계란지단과 각종 나물반찬을 준비한다",
                    "6단계: 도시락에 밥과 불고기, 반찬들을 담아 완성한다"
                ],
                "생선구이도시락": [
                    "1단계: 밥 2컵을 짓고, 생선 1마리를 손질한다",
                    "2단계: 생선에 소금을 뿌려 30분간 절인 후 물기를 닦는다",
                    "3단계: 팬에 기름을 두르고 생선을 앞뒤로 구워 익힌다",
                    "4단계: 간단한 반찬들(나물, 계란지단 등)을 준비한다",
                    "5단계: 도시락에 밥과 구운 생선, 반찬들을 담아 완성한다"
                ]
            };

            // 각 메뉴별 조리순서를 테이블 형태로 변환
            const maxSteps = Math.max(...Object.values(cookingSteps).map(steps => steps.length));
            
            for (let i = 1; i <= maxSteps; i++) {
                const stepRow = [`${i}단계`];
                detailMenus.forEach(menu => {
                    const menuSteps = cookingSteps[menu.name];
                    const stepText = menuSteps && menuSteps[i-1] ? menuSteps[i-1].replace(`${i}단계: `, '') : '-';
                    stepRow.push(stepText);
                });
                steps.push(stepRow);
            }

            return [["조리순서"].concat(detailMenus.map(m => m.name))].concat(steps);
        }

        function generateCookingInfo() {
            const info = [
                ["조리정보"].concat(detailMenus.map(m => m.name))
            ];

            const infoData = {
                "조리시간": ["60분", "20분", "70분", "50분", "120분", "45분", "60분", "90분", "40분", "45분", "30분"],
                "난이도": ["중급", "초급", "중급", "초급", "상급", "초급", "중급", "중급", "중급", "중급", "초급"],
                "칼로리(1인분)": ["280kcal", "180kcal", "250kcal", "220kcal", "350kcal", "180kcal", "200kcal", "300kcal", "650kcal", "680kcal", "580kcal"],
                "인분": ["2인분", "1인분", "2-3인분", "2인분", "2인분", "2인분", "2인분", "2-3인분", "1인분", "1인분", "1인분"],
                "보관방법": ["냉장 1일", "당일 섭취", "냉장 1일", "냉장 1일", "냉장 1일", "냉장 2일", "냉장 1일", "냉장 2일", "당일 섭취", "당일 섭취", "당일 섭취"]
            };

            Object.keys(infoData).forEach(info_item => {
                info.push([info_item].concat(infoData[info_item]));
            });

            return info;
        }

        function generateTasteFeatures() {
            const taste = [
                ["특징/맛"].concat(detailMenus.map(m => m.name))
            ];

            const tasteData = {
                "주요맛": ["진한바다맛", "고소버터맛", "구수한맛", "담백한맛", "보양식맛", "달콤한맛", "고소한맛", "달콤한맛", "매콤달콤", "달콤간장맛", "담백한맛"],
                "매운정도": ["순함", "순함", "순함", "순함", "순함", "순함", "순함", "순함", "보통", "순함", "순함"],
                "특징": ["전복의진한맛", "버터의고소함", "야채의영양", "부드러운닭맛", "인삼의보양효과", "단호박의달콤함", "녹두의고소함", "팥의달콤함", "매콤한제육", "달콤한불고기", "고소한생선"],
                "추천상황": ["보양식", "간단안주", "영양식", "소화불량시", "몸보신용", "아이간식", "여름보양식", "겨울간식", "든든한끼", "든든한끼", "건강식"]
            };

            Object.keys(tasteData).forEach(taste_item => {
                taste.push([taste_item].concat(tasteData[taste_item]));
            });

            return taste;
        }

        function generateNutrition() {
            const nutrition = [
                ["영양정보"].concat(detailMenus.map(m => m.name))
            ];

            const nutritionData = {
                "단백질(g)": ["18", "15", "12", "15", "25", "4", "8", "6", "25", "28", "22"],
                "탄수화물(g)": ["35", "5", "38", "32", "40", "35", "32", "55", "80", "85", "75"],
                "지방(g)": ["8", "12", "6", "5", "8", "3", "4", "2", "25", "22", "18"],
                "나트륨(mg)": ["600", "400", "800", "500", "700", "200", "300", "150", "1200", "1000", "800"],
                "식이섬유(g)": ["2", "1", "4", "2", "3", "5", "6", "8", "4", "3", "2"],
                "비타민C(mg)": ["5", "3", "15", "8", "12", "25", "8", "5", "20", "15", "8"],
                "칼슘(mg)": ["80", "60", "40", "50", "80", "60", "40", "30", "100", "80", "120"],
                "철분(mg)": ["3", "2", "2", "1", "3", "1", "3", "4", "4", "5", "2"],
                "타우린(mg)": ["200", "150", "-", "-", "-", "-", "-", "-", "-", "-", "-"]
            };

            Object.keys(nutritionData).forEach(nutrition_item => {
                nutrition.push([nutrition_item].concat(nutritionData[nutrition_item]));
            });

            return nutrition;
        }

        function generateServingTips() {
            const tips = [
                ["서빙/조리팁"].concat(detailMenus.map(m => m.name))
            ];

            const tipsData = {
                "서빙팁": [
                    "뜨거울 때 전복 조각과 함께",
                    "따뜻할 때 바로 서빙",
                    "뜨거운 상태에서 야채와 함께",
                    "부드러운 상태로 따뜻하게",
                    "인삼과 대추를 보이게 담아서",
                    "따뜻하거나 차갑게 모두 가능",
                    "따뜻한 상태에서 고소하게",
                    "따뜻하게 계피 향과 함께",
                    "따뜻한 밥에 뜨거운 제육과 함께",
                    "따뜻한 상태에서 반찬과 균형있게",
                    "생선이 식기 전에 바로"
                ],
                "보관팁": [
                    "전복은 따로 보관 후 서빙시 추가",
                    "당일 섭취 필수, 보관 불가",
                    "야채와 고기 분리해서 보관",
                    "닭고기 따로 보관",
                    "국물과 건더기 분리 보관",
                    "밀폐용기에 보관 가능",
                    "완전히 식힌 후 냉장 보관",
                    "팥앙금 따로 보관 가능",
                    "제육과 밥 분리 보관",
                    "고기와 밥 분리 보관",
                    "생선은 당일 섭취 권장"
                ],
                "조리팁": [
                    "전복 내장으로 깊은 맛 내기",
                    "버터가 타지 않게 중불 사용",
                    "야채는 너무 익히지 말 것",
                    "닭고기는 푹 삶아 부드럽게",
                    "삼계탕 국물을 진하게 우려야 함",
                    "단호박은 충분히 쪄야 부드러움",
                    "녹두는 충분히 불려야 부드러움",
                    "팥은 하룻밤 불리는 게 중요",
                    "제육은 센 불에서 빠르게 볶기",
                    "불고기는 센 불에서 빠르게",
                    "생선은 중불에서 천천히 굽기"
                ]
            };

            Object.keys(tipsData).forEach(tip_item => {
                tips.push([tip_item].concat(tipsData[tip_item]));
            });

            return tips;
        }

        function downloadRecipe() {
            // 새 워크북 생성
            const wb = XLSX.utils.book_new();

            // 각 시트 데이터 생성 및 추가
            const sheets = [
                {name: "주요식재료", data: generateIngredients()},
                {name: "양념소스", data: generateSauces()},
                {name: "육수베이스", data: generateBroth()},
                {name: "조리순서", data: generateCookingSteps()},
                {name: "조리정보", data: generateCookingInfo()},
                {name: "특징맛", data: generateTasteFeatures()},
                {name: "영양정보", data: generateNutrition()},
                {name: "서빙조리팁", data: generateServingTips()}
            ];

            sheets.forEach(sheet => {
                const ws = XLSX.utils.aoa_to_sheet(sheet.data);
                XLSX.utils.book_append_sheet(wb, ws, sheet.name);
            });

            // 파일 다운로드
            XLSX.writeFile(wb, "죽도시락_상세레시피.xlsx");
        }

        // 페이지 로드 시 자동으로 준비 완료 상태로 변경
        window.addEventListener('load', function() {
            setTimeout(() => {
                document.getElementById('status').innerHTML = '죽/도시락 카테고리의 11개 상세메뉴 레시피가 준비되었습니다.';
                document.getElementById('status').className = 'status success';
                document.getElementById('downloadBtn').disabled = false;
            }, 1000);
        });
    </script>
</body>
</html>