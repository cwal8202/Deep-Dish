<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>êµ¬ì´/ê³ ê¸° ë ˆì‹œí”¼ ìƒì„±</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        .container {
            background: linear-gradient(135deg, #2c1810 0%, #8b4513 100%);
            color: white;
        }
        h1 {
            color: white;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        .download-btn {
            background-color: #DC143C;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 10px;
            transition: background-color 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        .download-btn:hover {
            background-color: #B22222;
        }
        .download-btn:disabled {
            background-color: #666666;
            cursor: not-allowed;
        }
        .status {
            margin: 20px 0;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .success {
            background-color: rgba(212, 237, 218, 0.9);
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .processing {
            background-color: rgba(255, 243, 205, 0.9);
            color: #856404;
            border: 1px solid #ffeaa7;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”¥ êµ¬ì´/ê³ ê¸° ìƒì„¸ ë ˆì‹œí”¼ ğŸ¥©</h1>
        <div id="status" class="status processing">ë ˆì‹œí”¼ íŒŒì¼ì„ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...</div>
        <button id="downloadBtn" class="download-btn" disabled onclick="downloadRecipe()">
            êµ¬ì´ê³ ê¸°_ìƒì„¸ë ˆì‹œí”¼.xlsx ë‹¤ìš´ë¡œë“œ
        </button>
    </div>

    <script>
        // êµ¬ì´/ê³ ê¸° ìƒì„¸ë©”ë‰´ ë°ì´í„°
        const detailMenus = [
            {name: "ì‚¼ê²¹ì‚´", category: "ì‚¼ê²¹ì‚´", visual: "ë‘íˆ¼í•œ ì‚¼ê²¹ì‚´, ê¸°ë¦„ê¸°, êµ¬ì›Œì§„ ë©´"},
            {name: "ëª©ì‚´", category: "ì‚¼ê²¹ì‚´", visual: "ë¶€ë“œëŸ¬ìš´ ëª©ì‚´, ì ë‹¹í•œ ê¸°ë¦„ê¸°"},
            {name: "í•­ì •ì‚´", category: "ì‚¼ê²¹ì‚´", visual: "ì«„ê¹ƒí•œ í•­ì •ì‚´, ì§„í•œ ìƒ‰ê¹”"},
            {name: "LAê°ˆë¹„", category: "ê°ˆë¹„", visual: "ì–‘ë… ê°ˆë¹„, ë‹¬ì½¤í•œ ìƒ‰ê¹”"},
            {name: "ë¼ì§€ê°ˆë¹„", category: "ê°ˆë¹„", visual: "ì–‘ë…ëœ ë¼ì§€ê°ˆë¹„, ë¹¨ê°„ ì–‘ë…"},
            {name: "ìƒê°ˆë¹„", category: "ê°ˆë¹„", visual: "ìƒê°ˆë¹„, ì†Œê¸ˆêµ¬ì´, ë‹´ë°±í•œ ìƒ‰"},
            {name: "ë¶ˆê³ ê¸°", category: "ë¶ˆê³ ê¸°", visual: "ì–‡ì€ ê³ ê¸°, ë‹¬ì½¤í•œ ì–‘ë…"},
            {name: "ë‹­ë¶ˆê³ ê¸°", category: "ë¶ˆê³ ê¸°", visual: "ë‹­ê³ ê¸°, ë¹¨ê°„ ì–‘ë…"},
            {name: "ì˜¤ì§•ì–´ë¶ˆê³ ê¸°", category: "ë¶ˆê³ ê¸°", visual: "ì˜¤ì§•ì–´, ë§¤ì½¤í•œ ì–‘ë…"},
            {name: "ë‹­ê°ˆë¹„", category: "ë‹­ìš”ë¦¬", visual: "ë§¤ìš´ ë‹­ê°ˆë¹„, ë¹¨ê°„ ì–‘ë…"},
            {name: "ë‹­ë°œ", category: "ë‹­ìš”ë¦¬", visual: "ë§¤ìš´ ë‹­ë°œ, ì«„ê¹ƒí•œ ì‹ê°"},
            {name: "ì°œë‹­", category: "ë‹­ìš”ë¦¬", visual: "ê°„ì¥ ë‹­ì°œ, ì•¼ì±„ ê³ ëª…"}
        ];

        // ë ˆì‹œí”¼ ë°ì´í„° ìƒì„± í•¨ìˆ˜ë“¤
        function generateIngredients() {
            const ingredients = [
                ["ì‹ì¬ë£Œ"].concat(detailMenus.map(m => m.name))
            ];

            const ingredientData = {
                "ì‚¼ê²¹ì‚´": ["600g", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "ëª©ì‚´": ["-", "600g", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "í•­ì •ì‚´": ["-", "-", "500g", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "LAê°ˆë¹„": ["-", "-", "-", "800g", "-", "-", "-", "-", "-", "-", "-", "-"],
                "ë¼ì§€ê°ˆë¹„": ["-", "-", "-", "-", "800g", "-", "-", "-", "-", "-", "-", "-"],
                "ì†Œê°ˆë¹„(ìƒê°ˆë¹„)": ["-", "-", "-", "-", "-", "800g", "-", "-", "-", "-", "-", "-"],
                "ì†Œê³ ê¸°(ë¶ˆê³ ê¸°ìš©)": ["-", "-", "-", "-", "-", "-", "500g", "-", "-", "-", "-", "-"],
                "ë‹­ê³ ê¸°": ["-", "-", "-", "-", "-", "-", "-", "600g", "-", "600g", "-", "1ë§ˆë¦¬"],
                "ë‹­ê°ˆë¹„": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "ë‹­ë°œ": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "600g", "-"],
                "ì˜¤ì§•ì–´": ["-", "-", "-", "-", "-", "-", "-", "-", "2ë§ˆë¦¬", "-", "-", "-"],
                "ì–‘íŒŒ": ["1ê°œ", "1ê°œ", "1ê°œ", "1ê°œ", "1ê°œ", "1/2ê°œ", "1ê°œ", "1ê°œ", "1ê°œ", "1ê°œ", "1ê°œ", "1ê°œ"],
                "ëŒ€íŒŒ": ["2ëŒ€", "2ëŒ€", "2ëŒ€", "2ëŒ€", "2ëŒ€", "1ëŒ€", "2ëŒ€", "2ëŒ€", "2ëŒ€", "2ëŒ€", "2ëŒ€", "2ëŒ€"],
                "ë§ˆëŠ˜": ["1í†µ", "1í†µ", "8ìª½", "10ìª½", "10ìª½", "8ìª½", "8ìª½", "8ìª½", "6ìª½", "10ìª½", "10ìª½", "8ìª½"],
                "ìƒê°•": ["2ì¡°ê°", "2ì¡°ê°", "1ì¡°ê°", "2ì¡°ê°", "2ì¡°ê°", "1ì¡°ê°", "1ì¡°ê°", "1ì¡°ê°", "1ì¡°ê°", "2ì¡°ê°", "2ì¡°ê°", "2ì¡°ê°"],
                "ë‹¹ê·¼": ["-", "-", "-", "1ê°œ", "1ê°œ", "-", "1/2ê°œ", "1/2ê°œ", "1/2ê°œ", "1ê°œ", "-", "2ê°œ"],
                "ê°ì": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "2ê°œ", "-", "3ê°œ"],
                "ì–‘ë°°ì¶”": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "1/4ê°œ", "-", "-"],
                "ë²„ì„¯": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "100g", "-", "200g"],
                "ì²­ì–‘ê³ ì¶”": ["-", "-", "-", "-", "3ê°œ", "-", "-", "3ê°œ", "2ê°œ", "4ê°œ", "5ê°œ", "-"],
                "ë°°": ["-", "-", "-", "1/2ê°œ", "1/2ê°œ", "-", "1/2ê°œ", "-", "-", "-", "-", "-"],
                "ì‚¬ê³¼": ["-", "-", "-", "1/2ê°œ", "-", "-", "1/2ê°œ", "-", "-", "-", "-", "-"],
                "ë¬´": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "1/4ê°œ"]
            };

            Object.keys(ingredientData).forEach(ingredient => {
                ingredients.push([ingredient].concat(ingredientData[ingredient]));
            });

            return ingredients;
        }

        function generateSauces() {
            const sauces = [
                ["ì–‘ë…/ì†ŒìŠ¤"].concat(detailMenus.map(m => m.name))
            ];

            const sauceData = {
                "ì†Œê¸ˆ": ["ì ë‹¹ëŸ‰", "ì ë‹¹ëŸ‰", "ì ë‹¹ëŸ‰", "-", "-", "ì ë‹¹ëŸ‰", "-", "-", "-", "-", "-", "ì ë‹¹ëŸ‰"],
                "í›„ì¶”": ["ì ë‹¹ëŸ‰", "ì ë‹¹ëŸ‰", "ì ë‹¹ëŸ‰", "-", "-", "ì ë‹¹ëŸ‰", "ì¡°ê¸ˆ", "ì¡°ê¸ˆ", "ì¡°ê¸ˆ", "ì¡°ê¸ˆ", "ì¡°ê¸ˆ", "ì¡°ê¸ˆ"],
                "ê°„ì¥": ["-", "-", "-", "1/2ì»µ", "1/2ì»µ", "-", "1/2ì»µ", "1/3ì»µ", "1/4ì»µ", "1/3ì»µ", "1/3ì»µ", "1/2ì»µ"],
                "ê³ ì¶”ì¥": ["-", "-", "-", "-", "3í°ìˆ ", "-", "-", "2í°ìˆ ", "2í°ìˆ ", "3í°ìˆ ", "3í°ìˆ ", "-"],
                "ê³ ì¶§ê°€ë£¨": ["-", "-", "-", "-", "2í°ìˆ ", "-", "-", "1í°ìˆ ", "1í°ìˆ ", "2í°ìˆ ", "2í°ìˆ ", "-"],
                "ì„¤íƒ•": ["-", "-", "-", "3í°ìˆ ", "2í°ìˆ ", "-", "2í°ìˆ ", "2í°ìˆ ", "1í°ìˆ ", "2í°ìˆ ", "2í°ìˆ ", "2í°ìˆ "],
                "ì˜¬ë¦¬ê³ ë‹¹": ["-", "-", "-", "2í°ìˆ ", "2í°ìˆ ", "-", "2í°ìˆ ", "1í°ìˆ ", "1í°ìˆ ", "1í°ìˆ ", "1í°ìˆ ", "1í°ìˆ "],
                "ë§›ìˆ ": ["-", "-", "-", "3í°ìˆ ", "3í°ìˆ ", "-", "2í°ìˆ ", "2í°ìˆ ", "2í°ìˆ ", "2í°ìˆ ", "2í°ìˆ ", "2í°ìˆ "],
                "ì°¸ê¸°ë¦„": ["1í°ìˆ ", "1í°ìˆ ", "1í°ìˆ ", "2í°ìˆ ", "2í°ìˆ ", "1í°ìˆ ", "2í°ìˆ ", "1í°ìˆ ", "1í°ìˆ ", "1í°ìˆ ", "1í°ìˆ ", "1í°ìˆ "],
                "ì‹ìš©ìœ ": ["ì ë‹¹ëŸ‰", "ì ë‹¹ëŸ‰", "ì ë‹¹ëŸ‰", "1í°ìˆ ", "2í°ìˆ ", "ì ë‹¹ëŸ‰", "2í°ìˆ ", "2í°ìˆ ", "2í°ìˆ ", "2í°ìˆ ", "2í°ìˆ ", "2í°ìˆ "],
                "ë‹¤ì§„ë§ˆëŠ˜": ["2í°ìˆ ", "2í°ìˆ ", "2í°ìˆ ", "3í°ìˆ ", "3í°ìˆ ", "1í°ìˆ ", "2í°ìˆ ", "2í°ìˆ ", "1í°ìˆ ", "3í°ìˆ ", "3í°ìˆ ", "2í°ìˆ "],
                "ë‹¤ì§„ìƒê°•": ["1í°ìˆ ", "1í°ìˆ ", "1ì‘ì€ìˆ ", "1í°ìˆ ", "1í°ìˆ ", "1ì‘ì€ìˆ ", "1ì‘ì€ìˆ ", "1ì‘ì€ìˆ ", "1ì‘ì€ìˆ ", "1í°ìˆ ", "1í°ìˆ ", "1í°ìˆ "],
                "êµ´ì†ŒìŠ¤": ["-", "-", "-", "-", "-", "-", "1í°ìˆ ", "1í°ìˆ ", "1í°ìˆ ", "-", "-", "-"],
                "ë§ˆìš”ë„¤ì¦ˆ": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "ê²¨ì": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"],
                "ìƒˆìš°ì “": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "1í°ìˆ ", "-"],
                "ë¬¼ì—¿": ["-", "-", "-", "1í°ìˆ ", "1í°ìˆ ", "-", "-", "-", "-", "-", "-", "-"],
                "ë‹¤ì‹œë§ˆ": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "2ì¡°ê°"],
                "ì›”ê³„ìˆ˜ì": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "3ì¥"]
            };

            Object.keys(sauceData).forEach(sauce => {
                sauces.push([sauce].concat(sauceData[sauce]));
            });

            return sauces;
        }

        function generateBroth() {
            const broth = [
                ["ìœ¡ìˆ˜/ë² ì´ìŠ¤"].concat(detailMenus.map(m => m.name))
            ];

            const brothData = {
                "ë¬¼": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "2ì»µ", "4ì»µ"],
                "ì°œìš©ë¬¼": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "ê¸°ë³¸"],
                "ìœ¡ìˆ˜": ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "ë‹­ìœ¡ìˆ˜"]
            };

            Object.keys(brothData).forEach(item => {
                broth.push([item].concat(brothData[item]));
            });

            return broth;
        }

        function generateCookingSteps() {
            const steps = [];
            
            // ë©”ë‰´ë³„ë¡œ ê°œë³„ ì¡°ë¦¬ìˆœì„œ ìƒì„± (ë‹¨ê³„ ìˆ˜ê°€ ë‹¤ë¦„)
            const cookingSteps = {
                "ì‚¼ê²¹ì‚´": [
                    "1ë‹¨ê³„: ì‚¼ê²¹ì‚´ 600gì„ ì ë‹¹í•œ ë‘ê»˜(1cm)ë¡œ ì°ì–´ ì¤€ë¹„í•œë‹¤",
                    "2ë‹¨ê³„: ì–‘íŒŒ 1ê°œì™€ ëŒ€íŒŒ 2ëŒ€ë¥¼ ì ë‹¹í•œ í¬ê¸°ë¡œ ì¬ë‹¤",
                    "3ë‹¨ê³„: ë§ˆëŠ˜ 1í†µì„ í†µë§ˆëŠ˜ë¡œ ì¤€ë¹„í•˜ê±°ë‚˜ í¸ìœ¼ë¡œ ì¬ë‹¤",
                    "4ë‹¨ê³„: íŒ¬ì´ë‚˜ ë¶ˆíŒì„ ì¤‘ë¶ˆë¡œ ë‹¬êµ°ë‹¤",
                    "5ë‹¨ê³„: ì‚¼ê²¹ì‚´ì„ ì˜¬ë ¤ í•œìª½ë©´ì„ 3-4ë¶„ê°„ êµ½ëŠ”ë‹¤",
                    "6ë‹¨ê³„: ë’¤ì§‘ì–´ì„œ ë°˜ëŒ€í¸ë„ 3-4ë¶„ê°„ êµ¬ì›Œ ë…¸ë¦‡í•˜ê²Œ ë§Œë“ ë‹¤",
                    "7ë‹¨ê³„: ì†Œê¸ˆ, í›„ì¶”ë¡œ ê°„ì„ í•˜ê³  ì°¸ê¸°ë¦„ì„ ì‚´ì§ ë‘˜ëŸ¬ ì™„ì„±í•œë‹¤"
                ],
                "ëª©ì‚´": [
                    "1ë‹¨ê³„: ëª©ì‚´ 600gì„ 2cm ë‘ê»˜ë¡œ ë‘íˆ¼í•˜ê²Œ ì¬ë‹¤",
                    "2ë‹¨ê³„: ê³ ê¸°ì— ì†Œê¸ˆ, í›„ì¶”ë¡œ ë°‘ê°„ì„ í•œë‹¤",
                    "3ë‹¨ê³„: íŒ¬ì„ ë‹¬êµ¬ê³  ëª©ì‚´ì„ ì˜¬ë¦°ë‹¤",
                    "4ë‹¨ê³„: ì¤‘ë¶ˆì—ì„œ í•œìª½ë©´ì„ 4-5ë¶„ê°„ êµ½ëŠ”ë‹¤",
                    "5ë‹¨ê³„: ë’¤ì§‘ì–´ì„œ ë°˜ëŒ€í¸ë„ êµ¬ì›Œ ì™„ì„±í•œë‹¤"
                ],
                "í•­ì •ì‚´": [
                    "1ë‹¨ê³„: í•­ì •ì‚´ 500gì„ 1.5cm ë‘ê»˜ë¡œ ì¬ë‹¤",
                    "2ë‹¨ê³„: ê³ ê¸°ì— ì†Œê¸ˆ, í›„ì¶”, ì°¸ê¸°ë¦„ìœ¼ë¡œ ë°‘ê°„í•œë‹¤",
                    "3ë‹¨ê³„: íŒ¬ì„ ê°•ë¶ˆë¡œ ë‹¬êµ°ë‹¤",
                    "4ë‹¨ê³„: í•­ì •ì‚´ì„ ì˜¬ë ¤ ê²‰ë©´ì„ ë¹ ë¥´ê²Œ êµ¬ì›Œ ì‹œì–´ë§í•œë‹¤",
                    "5ë‹¨ê³„: ì¤‘ë¶ˆë¡œ ì¤„ì—¬ ì†ê¹Œì§€ ìµí˜€ ì™„ì„±í•œë‹¤"
                ],
                "LAê°ˆë¹„": [
                    "1ë‹¨ê³„: LAê°ˆë¹„ 800gì— í•ë¬¼ì„ ë¹¼ê¸° ìœ„í•´ ì°¬ë¬¼ì— 30ë¶„ê°„ ë‹´ê°€ë‘”ë‹¤",
                    "2ë‹¨ê³„: ë°° 1/2ê°œì™€ ì‚¬ê³¼ 1/2ê°œë¥¼ ê°ˆì•„ ê³¼ì¼ì¦™ì„ ë§Œë“ ë‹¤",
                    "3ë‹¨ê³„: ê°„ì¥ 1/2ì»µ, ì„¤íƒ• 3í°ìˆ , ì˜¬ë¦¬ê³ ë‹¹ 2í°ìˆ , ë§›ìˆ  3í°ìˆ , ë¬¼ì—¿ 1í°ìˆ ì„ ì„ëŠ”ë‹¤",
                    "4ë‹¨ê³„: ê³¼ì¼ì¦™, ë‹¤ì§„ë§ˆëŠ˜ 3í°ìˆ , ë‹¤ì§„ìƒê°• 1í°ìˆ , ì°¸ê¸°ë¦„ 2í°ìˆ ì„ ë„£ì–´ ì–‘ë…ì¥ì„ ì™„ì„±í•œë‹¤",
                    "5ë‹¨ê³„: ê°ˆë¹„ì— ì–‘ë…ì¥ì„ ë°œë¼ 2ì‹œê°„ ì´ìƒ ì¬ìš´ë‹¤",
                    "6ë‹¨ê³„: íŒ¬ì´ë‚˜ ê·¸ë¦´ì— ì–‘ë…í•œ ê°ˆë¹„ë¥¼ ì˜¬ë¦°ë‹¤",
                    "7ë‹¨ê³„: ì¤‘ë¶ˆì—ì„œ ì•ë’¤ë¡œ ê°ê° 8-10ë¶„ì”© êµ¬ì›Œ ì™„ì„±í•œë‹¤"
                ],
                "ë¼ì§€ê°ˆë¹„": [
                    "1ë‹¨ê³„: ë¼ì§€ê°ˆë¹„ 800gì„ ì°¬ë¬¼ì— ë‹´ê°€ í•ë¬¼ì„ ëº€ë‹¤",
                    "2ë‹¨ê³„: ê³ ì¶”ì¥ 3í°ìˆ , ê°„ì¥ 1/2ì»µ, ê³ ì¶§ê°€ë£¨ 2í°ìˆ ì„ ê¸°ë³¸ìœ¼ë¡œ í•œ ì–‘ë…ì¥ì„ ë§Œë“ ë‹¤",
                    "3ë‹¨ê³„: ì„¤íƒ• 2í°ìˆ , ì˜¬ë¦¬ê³ ë‹¹ 2í°ìˆ , ë§›ìˆ  3í°ìˆ , ë¬¼ì—¿ 1í°ìˆ ì„ ë„£ëŠ”ë‹¤",
                    "4ë‹¨ê³„: ë‹¤ì§„ë§ˆëŠ˜, ë‹¤ì§„ìƒê°•, ì°¸ê¸°ë¦„ì„ ë„£ê³  ì²­ì–‘ê³ ì¶” 3ê°œë¥¼ ì˜ê²Œ ì°ì–´ ë„£ëŠ”ë‹¤",
                    "5ë‹¨ê³„: ê°ˆë¹„ì— ì–‘ë…ì„ ë°œë¼ 1ì‹œê°„ ì´ìƒ ì¬ìš´ë‹¤",
                    "6ë‹¨ê³„: íŒ¬ì— ê¸°ë¦„ì„ ë‘ë¥´ê³  ì–‘ë… ê°ˆë¹„ë¥¼ êµ½ëŠ”ë‹¤",
                    "7ë‹¨ê³„: ì¤‘ë¶ˆì—ì„œ ë’¤ì§‘ì–´ê°€ë©° 15ë¶„ê°„ êµ¬ì›Œ ì™„ì„±í•œë‹¤"
                ],
                "ìƒê°ˆë¹„": [
                    "1ë‹¨ê³„: ì†Œê°ˆë¹„ 800gì„ ì°¬ë¬¼ì— ë‹´ê°€ í•ë¬¼ì„ ì™„ì „íˆ ëº€ë‹¤",
                    "2ë‹¨ê³„: ê°ˆë¹„ë¥¼ í‚¤ì¹œíƒ€ì›”ë¡œ ë¬¼ê¸°ë¥¼ ì œê±°í•œë‹¤",
                    "3ë‹¨ê³„: íŒ¬ì´ë‚˜ ê·¸ë¦´ì„ ë‹¬êµ°ë‹¤",
                    "4ë‹¨ê³„: ê°ˆë¹„ì— ì†Œê¸ˆ, í›„ì¶”ë¥¼ ë¿Œë¦°ë‹¤",
                    "5ë‹¨ê³„: ì¤‘ë¶ˆì—ì„œ í•œìª½ë©´ì„ 10ë¶„ê°„ êµ¬ìš´ë‹¤",
                    "6ë‹¨ê³„: ë’¤ì§‘ì–´ì„œ ë°˜ëŒ€í¸ë„ 8-10ë¶„ê°„ êµ¬ì›Œ ì™„ì„±í•œë‹¤"
                ],
                "ë¶ˆê³ ê¸°": [
                    "1ë‹¨ê³„: ì†Œê³ ê¸° 500gì„ ì–‡ê²Œ(0.3cm) ì¬ë‹¤",
                    "2ë‹¨ê³„: ë°° 1/2ê°œë¥¼ ê°ˆì•„ ê³¼ì¼ì¦™ì„ ë§Œë“ ë‹¤",
                    "3ë‹¨ê³„: ê°„ì¥ 1/2ì»µ, ì„¤íƒ• 2í°ìˆ , ì˜¬ë¦¬ê³ ë‹¹ 2í°ìˆ , ë§›ìˆ  2í°ìˆ ì„ ì„ëŠ”ë‹¤",
                    "4ë‹¨ê³„: ê³¼ì¼ì¦™, ë‹¤ì§„ë§ˆëŠ˜, ì°¸ê¸°ë¦„, êµ´ì†ŒìŠ¤ 1í°ìˆ ì„ ë„£ì–´ ë¶ˆê³ ê¸° ì–‘ë…ì„ ë§Œë“ ë‹¤",
                    "5ë‹¨ê³„: ì¬ ê³ ê¸°ì— ì–‘ë…ì„ ë°œë¼ 30ë¶„ê°„ ì¬ìš´ë‹¤",
                    "6ë‹¨ê³„: íŒ¬ì— ê¸°ë¦„ì„ ë‘ë¥´ê³  ì–‘íŒŒì™€ ë‹¹ê·¼ì„ ë¨¼ì € ë³¶ëŠ”ë‹¤",
                    "7ë‹¨ê³„: ì–‘ë…í•œ ê³ ê¸°ë¥¼ ë„£ê³  ì„¼ë¶ˆì—ì„œ ë¹ ë¥´ê²Œ ë³¶ì•„ ì™„ì„±í•œë‹¤"
                ],
                "ë‹­ë¶ˆê³ ê¸°": [
                    "1ë‹¨ê³„: ë‹­ê³ ê¸° 600gì„ í•œì… í¬ê¸°ë¡œ ì¬ë‹¤",
                    "2ë‹¨ê³„: ê°„ì¥ 1/3ì»µ, ê³ ì¶”ì¥ 2í°ìˆ , ê³ ì¶§ê°€ë£¨ 1í°ìˆ ë¡œ ì–‘ë…ì¥ì„ ë§Œë“ ë‹¤",
                    "3ë‹¨ê³„: ì„¤íƒ•, ì˜¬ë¦¬ê³ ë‹¹, ë§›ìˆ , ë‹¤ì§„ë§ˆëŠ˜ì„ ë„£ì–´ ì–‘ë…ì„ ì™„ì„±í•œë‹¤",
                    "4ë‹¨ê³„: ë‹­ê³ ê¸°ì— ì–‘ë…ì„ ë°œë¼ 1ì‹œê°„ ì¬ìš´ë‹¤",
                    "5ë‹¨ê³„: íŒ¬ì—ì„œ ì–‘ë… ë‹­ê³ ê¸°ë¥¼ ë³¶ì•„ ì™„ì„±í•œë‹¤"
                ],
                "ì˜¤ì§•ì–´ë¶ˆê³ ê¸°": [
                    "1ë‹¨ê³„: ì˜¤ì§•ì–´ 2ë§ˆë¦¬ë¥¼ ì†ì§ˆí•˜ì—¬ ë§ ëª¨ì–‘ìœ¼ë¡œ ì¬ë‹¤",
                    "2ë‹¨ê³„: ê°„ì¥ 1/4ì»µ, ê³ ì¶”ì¥ 2í°ìˆ , ê³ ì¶§ê°€ë£¨ 1í°ìˆ ë¡œ ì–‘ë…ì„ ë§Œë“ ë‹¤",
                    "3ë‹¨ê³„: ì–‘íŒŒ, ë‹¹ê·¼, ì²­ì–‘ê³ ì¶”ë¥¼ ì±„ ì¬ë‹¤",
                    "4ë‹¨ê³„: íŒ¬ì— ê¸°ë¦„ì„ ë‘ë¥´ê³  ì•¼ì±„ë¥¼ ë¨¼ì € ë³¶ëŠ”ë‹¤",
                    "5ë‹¨ê³„: ì˜¤ì§•ì–´ë¥¼ ë„£ê³  ì–‘ë…ì¥ìœ¼ë¡œ ë¹ ë¥´ê²Œ ë³¶ì•„ ì™„ì„±í•œë‹¤"
                ],
                "ë‹­ê°ˆë¹„": [
                    "1ë‹¨ê³„: ë‹­ê³ ê¸° 600gì„ í•œì… í¬ê¸°ë¡œ ì¬ë‹¤",
                    "2ë‹¨ê³„: ê³ ì¶”ì¥ 3í°ìˆ , ê°„ì¥ 1/3ì»µ, ê³ ì¶§ê°€ë£¨ 2í°ìˆ ë¡œ ë§¤ìš´ ì–‘ë…ì„ ë§Œë“ ë‹¤",
                    "3ë‹¨ê³„: ì„¤íƒ•, ì˜¬ë¦¬ê³ ë‹¹, ë§›ìˆ , ë‹¤ì§„ë§ˆëŠ˜, ë‹¤ì§„ìƒê°•ì„ ë„£ëŠ”ë‹¤",
                    "4ë‹¨ê³„: ê°ì 2ê°œ, ì–‘ë°°ì¶” 1/4ê°œ, ë‹¹ê·¼ 1ê°œë¥¼ ì ë‹¹íˆ ì¬ë‹¤",
                    "5ë‹¨ê³„: ë‹­ê³ ê¸°ì— ì–‘ë…ì„ ë°œë¼ 30ë¶„ê°„ ì¬ìš´ë‹¤",
                    "6ë‹¨ê³„: íŒ¬ì— ì–‘ë… ë‹­ê³ ê¸°ë¥¼ ë¨¼ì € ë³¶ëŠ”ë‹¤",
                    "7ë‹¨ê³„: ì•¼ì±„ë¥¼ ë„£ê³  í•¨ê»˜ ë³¶ì•„ ì™„ì„±í•œë‹¤"
                ],
                "ë‹­ë°œ": [
                    "1ë‹¨ê³„: ë‹­ë°œ 600gì„ ê¹¨ë—ì´ ì†ì§ˆí•˜ê³  ë“ëŠ” ë¬¼ì— 5ë¶„ê°„ ë°ì¹œë‹¤",
                    "2ë‹¨ê³„: ë°ì¹œ ë‹­ë°œì„ ì°¬ë¬¼ì— í—¹ê¶ˆ ì¤€ë¹„í•œë‹¤",
                    "3ë‹¨ê³„: ê³ ì¶”ì¥, ê°„ì¥, ê³ ì¶§ê°€ë£¨, ìƒˆìš°ì “ìœ¼ë¡œ ë§¤ìš´ ì–‘ë…ì„ ë§Œë“ ë‹¤",
                    "4ë‹¨ê³„: ì„¤íƒ•, ì˜¬ë¦¬ê³ ë‹¹, ë§›ìˆ , ë‹¤ì§„ë§ˆëŠ˜ì„ ë„£ëŠ”ë‹¤",
                    "5ë‹¨ê³„: ëƒ„ë¹„ì— ë‹­ë°œê³¼ ì–‘ë…, ë¬¼ 2ì»µì„ ë„£ê³  ë“ì¸ë‹¤",
                    "6ë‹¨ê³„: ì¤‘ë¶ˆì—ì„œ 30ë¶„ê°„ ì¡°ë ¤ ì–‘ë…ì´ ë°°ë„ë¡ í•œë‹¤",
                    "7ë‹¨ê³„: êµ­ë¬¼ì´ ì¡¸ì•„ë“¤ë©´ ì²­ì–‘ê³ ì¶”ë¥¼ ë„£ê³  ë§ˆë¬´ë¦¬í•œë‹¤"
                ],
                "ì°œë‹­": [
                    "1ë‹¨ê³„: ë‹­ 1ë§ˆë¦¬ë¥¼ ì ë‹¹í•œ í¬ê¸°ë¡œ í† ë§‰ë‚¸ë‹¤",
                    "2ë‹¨ê³„: ê°ì 3ê°œ, ë‹¹ê·¼ 2ê°œ, ë¬´ 1/4ê°œë¥¼ í¼ì§í•˜ê²Œ ì¬ë‹¤",
                    "3ë‹¨ê³„: ê°„ì¥ 1/2ì»µ, ì„¤íƒ• 2í°ìˆ , ì˜¬ë¦¬ê³ ë‹¹ 1í°ìˆ , ë§›ìˆ  2í°ìˆ ë¡œ ì°œë‹­ ì–‘ë…ì„ ë§Œë“ ë‹¤",
                    "4ë‹¨ê³„: ë‹¤ì§„ë§ˆëŠ˜, ë‹¤ì§„ìƒê°•, ì°¸ê¸°ë¦„ì„ ë„£ëŠ”ë‹¤",
                    "5ë‹¨ê³„: ëƒ„ë¹„ì— ë‹­ê³ ê¸°ë¥¼ ë„£ê³  ì–‘ë…ì¥ì„ ë¶€ì–´ ë²„ë¬´ë¦°ë‹¤",
                    "6ë‹¨ê³„: ë¬¼ 4ì»µê³¼ ë‹¤ì‹œë§ˆ, ì›”ê³„ìˆ˜ìì„ ë„£ê³  ë“ì¸ë‹¤",
                    "7ë‹¨ê³„: ë“ê¸° ì‹œì‘í•˜ë©´ ì¤‘ë¶ˆë¡œ ì¤„ì´ê³  30ë¶„ê°„ ì¡°ë¦°ë‹¤",
                    "8ë‹¨ê³„: ì•¼ì±„ë¥¼ ë„£ê³  15ë¶„ ë” ì¡°ë ¤ ë¶€ë“œëŸ½ê²Œ ì™„ì„±í•œë‹¤"
                ]
            };

            // ê° ë©”ë‰´ë³„ ì¡°ë¦¬ìˆœì„œë¥¼ í…Œì´ë¸” í˜•íƒœë¡œ ë³€í™˜
            const maxSteps = Math.max(...Object.values(cookingSteps).map(steps => steps.length));
            
            for (let i = 1; i <= maxSteps; i++) {
                const stepRow = [`${i}ë‹¨ê³„`];
                detailMenus.forEach(menu => {
                    const menuSteps = cookingSteps[menu.name];
                    const stepText = menuSteps && menuSteps[i-1] ? menuSteps[i-1].replace(`${i}ë‹¨ê³„: `, '') : '-';
                    stepRow.push(stepText);
                });
                steps.push(stepRow);
            }

            return [["ì¡°ë¦¬ìˆœì„œ"].concat(detailMenus.map(m => m.name))].concat(steps);
        }

        function generateCookingInfo() {
            const info = [
                ["ì¡°ë¦¬ì •ë³´"].concat(detailMenus.map(m => m.name))
            ];

            const infoData = {
                "ì¡°ë¦¬ì‹œê°„": ["20ë¶„", "15ë¶„", "12ë¶„", "180ë¶„", "120ë¶„", "30ë¶„", "90ë¶„", "60ë¶„", "20ë¶„", "80ë¶„", "50ë¶„", "60ë¶„"],
                "ë‚œì´ë„": ["ì´ˆê¸‰", "ì´ˆê¸‰", "ì´ˆê¸‰", "ìƒê¸‰", "ì¤‘ê¸‰", "ì´ˆê¸‰", "ì¤‘ê¸‰", "ì¤‘ê¸‰", "ì´ˆê¸‰", "ì¤‘ê¸‰", "ì¤‘ê¸‰", "ì¤‘ê¸‰"],
                "ì¹¼ë¡œë¦¬(1ì¸ë¶„)": ["480kcal", "420kcal", "380kcal", "450kcal", "420kcal", "380kcal", "320kcal", "280kcal", "180kcal", "350kcal", "250kcal", "320kcal"],
                "ì¸ë¶„": ["3-4ì¸ë¶„", "3-4ì¸ë¶„", "2-3ì¸ë¶„", "4-5ì¸ë¶„", "4-5ì¸ë¶„", "3-4ì¸ë¶„", "3-4ì¸ë¶„", "3-4ì¸ë¶„", "2-3ì¸ë¶„", "3-4ì¸ë¶„", "3-4ì¸ë¶„", "3-4ì¸ë¶„"],
                "ë³´ê´€ë°©ë²•": ["ë‹¹ì¼ ì„­ì·¨", "ë‹¹ì¼ ì„­ì·¨", "ë‹¹ì¼ ì„­ì·¨", "ëƒ‰ì¥ 2ì¼", "ëƒ‰ì¥ 2ì¼", "ë‹¹ì¼ ì„­ì·¨", "ëƒ‰ì¥ 2ì¼", "ëƒ‰ì¥ 2ì¼", "ë‹¹ì¼ ì„­ì·¨", "ëƒ‰ì¥ 2ì¼", "ëƒ‰ì¥ 2ì¼", "ëƒ‰ì¥ 2ì¼"]
            };

            Object.keys(infoData).forEach(info_item => {
                info.push([info_item].concat(infoData[info_item]));
            });

            return info;
        }

        function generateTasteFeatures() {
            const taste = [
                ["íŠ¹ì§•/ë§›"].concat(detailMenus.map(m => m.name))
            ];

            const tasteData = {
                "ì£¼ìš”ë§›": ["ê³ ì†Œí•œë§›", "ë¶€ë“œëŸ¬ìš´ë§›", "ì«„ê¹ƒí•œë§›", "ë‹¬ì½¤ê°„ì¥ë§›", "ë§¤ì½¤ë‹¬ì½¤", "ë‹´ë°±í•œë§›", "ë‹¬ì½¤ê°„ì¥ë§›", "ë§¤ì½¤í•œë§›", "ë°”ë‹¤í–¥ë§¤ì½¤", "ë§¤ì½¤í•œë§›", "ë§¤ì½¤ì«„ê¹ƒ", "ë‹¬ì½¤ê°„ì¥ë§›"],
                "ë§¤ìš´ì •ë„": ["ìˆœí•¨", "ìˆœí•¨", "ìˆœí•¨", "ìˆœí•¨", "ë³´í†µ", "ìˆœí•¨", "ìˆœí•¨", "ë³´í†µ", "ë³´í†µ", "ë§¤ì›€", "ë§¤ì›€", "ìˆœí•¨"],
                "íŠ¹ì§•": ["ì‚¼ê²¹ì‚´ì˜ê¸°ë¦„ë§›", "ëª©ì‚´ì˜ë¶€ë“œëŸ¬ì›€", "í•­ì •ì‚´ì«„ê¹ƒí•¨", "ê³¼ì¼ì˜ë‹¨ë§›", "ë§¤ì½¤í•œì–‘ë…", "ì†Œê°ˆë¹„ë³¸ì—°ë§›", "ë¶ˆê³ ê¸°ë‹¬ì½¤í•¨", "ë‹­ê³ ê¸°ë¶€ë“œëŸ¬ì›€", "ì˜¤ì§•ì–´ì«„ê¹ƒí•¨", "ë§¤ìš´ë‹­ê°ˆë¹„", "ë‹­ë°œì«„ê¹ƒí•¨", "ë‹­ì°œë¶€ë“œëŸ¬ì›€"],
                "ì¶”ì²œìƒí™©": ["íšŒì‹ìë¦¬", "ê°€ì¡±ì‹ì‚¬", "íŠ¹ë³„í•œë‚ ", "íŠ¹ë³„í•œë‚ ", "íšŒì‹ìë¦¬", "ê³ ê¸‰ì‹ì‚¬", "ê°€ì¡±ì‹ì‚¬", "ê°€ì¡±ì‹ì‚¬", "ìˆ ì•ˆì£¼", "ë§¤ìš´ë§›ì¢‹ì„ë•Œ", "ìˆ ì•ˆì£¼", "ê°€ì¡±ëª¨ì„"]
            };

            Object.keys(tasteData).forEach(taste_item => {
                taste.push([taste_item].concat(tasteData[taste_item]));
            });

            return taste;
        }

        function generateNutrition() {
            const nutrition = [
                ["ì˜ì–‘ì •ë³´"].concat(detailMenus.map(m => m.name))
            ];

            const nutritionData = {
                "ë‹¨ë°±ì§ˆ(g)": ["20", "25", "28", "30", "28", "32", "28", "30", "18", "28", "22", "35"],
                "íƒ„ìˆ˜í™”ë¬¼(g)": ["2", "2", "1", "15", "12", "1", "12", "10", "8", "15", "8", "20"],
                "ì§€ë°©(g)": ["45", "32", "25", "22", "25", "20", "18", "15", "6", "18", "12", "15"],
                "ë‚˜íŠ¸ë¥¨(mg)": ["400", "400", "450", "1200", "1400", "350", "1000", "1100", "800", "1300", "1500", "1100"],
                "ì‹ì´ì„¬ìœ (g)": ["0", "0", "0", "2", "3", "0", "2", "2", "1", "4", "1", "5"],
                "ë¹„íƒ€ë¯¼C(mg)": ["2", "2", "1", "15", "20", "1", "12", "15", "8", "25", "15", "20"],
                "ì² ë¶„(mg)": ["2", "3", "4", "3", "3", "4", "3", "2", "1", "3", "2", "3"],
                "ì•„ì—°(mg)": ["4", "5", "6", "5", "4", "6", "5", "3", "2", "3", "2", "4"],
                "ì½œë ˆìŠ¤í…Œë¡¤(mg)": ["80", "70", "75", "85", "80", "85", "70", "65", "150", "70", "180", "80"]
            };

            Object.keys(nutritionData).forEach(nutrition_item => {
                nutrition.push([nutrition_item].concat(nutritionData[nutrition_item]));
            });

            return nutrition;
        }

        function generateServingTips() {
            const tips = [
                ["ì„œë¹™/ì¡°ë¦¬íŒ"].concat(detailMenus.map(m => m.name))
            ];

            const tipsData = {
                "ì„œë¹™íŒ": [
                    "ëœ¨ê±°ìš¸ ë•Œ ë°”ë¡œ ìŒˆì±„ì†Œì™€ í•¨ê»˜",
                    "ë¶€ë“œëŸ¬ìš´ ì‹ê° ì‚´ë ¤ ëœ¨ê²ê²Œ",
                    "ì«„ê¹ƒí•œ ì‹ê°ì´ ë§¤ë ¥ì ìœ¼ë¡œ",
                    "ì–‘ë…ì´ ì˜ ë°°ì–´ë“  ìƒíƒœë¡œ",
                    "ë§¤ì½¤ë‹¬ì½¤í•˜ê²Œ ëœ¨ê±°ìš¸ ë•Œ",
                    "ë‹´ë°±í•œ ì†Œê°ˆë¹„ ë³¸ì—°ì˜ ë§›ìœ¼ë¡œ",
                    "ë‹¬ì½¤í•œ ì–‘ë…ê³¼ í•¨ê»˜ ë”°ëœ»í•˜ê²Œ",
                    "ë§¤ì½¤í•œ ì–‘ë…ì´ ë°°ì–´ë“  ìƒíƒœë¡œ",
                    "ì«„ê¹ƒí•œ ì˜¤ì§•ì–´ì™€ ì•¼ì±„ ì¡°í™”ë¡­ê²Œ",
                    "ë§¤ìš´ ì–‘ë…ê³¼ ì•¼ì±„ ë“¬ë¿",
                    "ë§¤ì½¤ì«„ê¹ƒí•˜ê²Œ ëœ¨ê±°ìš¸ ë•Œ",
                    "ë¶€ë“œëŸ¬ìš´ ë‹­ê³ ê¸°ì™€ êµ­ë¬¼ í•¨ê»˜"
                ],
                "ë³´ê´€íŒ": [
                    "ê¸°ë¦„ê¸°ê°€ êµ³ìœ¼ë¯€ë¡œ ë‹¹ì¼ ì„­ì·¨",
                    "ë‹¹ì¼ ì„­ì·¨ê°€ ê°€ì¥ ë§›ìˆìŒ",
                    "ë‹¹ì¼ ì„­ì·¨ ê¶Œì¥",
                    "ì–‘ë…ê³¼ ê³ ê¸° ë¶„ë¦¬í•´ì„œ ë³´ê´€",
                    "ì–‘ë… ìƒíƒœë¡œ ëƒ‰ì¥ ë³´ê´€ ê°€ëŠ¥",
                    "ë‹¹ì¼ ì„­ì·¨ê°€ ê°€ì¥ ì¢‹ìŒ",
                    "ì–‘ë…ê³¼ ê³ ê¸° í•¨ê»˜ ë³´ê´€ ê°€ëŠ¥",
                    "ì–‘ë… ìƒíƒœë¡œ ë³´ê´€ ê°€ëŠ¥",
                    "ë‹¹ì¼ ì„­ì·¨ ê¶Œì¥",
                    "êµ­ë¬¼ê³¼ í•¨ê»˜ ëƒ‰ì¥ ë³´ê´€",
                    "êµ­ë¬¼ê³¼ í•¨ê»˜ ë³´ê´€ ê°€ëŠ¥",
                    "êµ­ë¬¼ê³¼ ë¶„ë¦¬í•´ì„œ ë³´ê´€"
                ],
                "ì¡°ë¦¬íŒ": [
                    "ê¸°ë¦„ê¸° ì œê±°í•˜ë©° êµ¬ìš°ë©´ ë” ë‹´ë°±",
                    "ë‘íˆ¼í•˜ê²Œ ì°ì–´ì•¼ ë¶€ë“œëŸ¬ì›€ ìœ ì§€",
                    "ì„¼ ë¶ˆì—ì„œ ê²‰ë©´ ì‹œì–´ë§ì´ ì¤‘ìš”",
                    "ê³¼ì¼ì¦™ìœ¼ë¡œ ê³ ê¸°ë¥¼ ë¶€ë“œëŸ½ê²Œ",
                    "ì–‘ë… ì‹œê°„ì´ ê¸¸ìˆ˜ë¡ ë§›ìˆìŒ",
                    "í•ë¬¼ ì œê±°ê°€ ë‹´ë°±í•¨ì˜ í•µì‹¬",
                    "ê³ ê¸°ë¥¼ ë„ˆë¬´ ì–‡ê²Œ ì°ì§€ ë§ ê²ƒ",
                    "ë‹­ê³ ê¸°ëŠ” ì™„ì „íˆ ìµí˜€ì•¼ ì•ˆì „",
                    "ì˜¤ì§•ì–´ëŠ” ë„ˆë¬´ ì˜¤ë˜ ë³¶ìœ¼ë©´ ì§ˆê¹€",
                    "ì•¼ì±„ì™€ ê³ ê¸° ì¡°ë¦¬ ì‹œê°„ ì°¨ì´ ê³ ë ¤",
                    "ë‹­ë°œì€ ë¯¸ë¦¬ ë°ì³ì•¼ ë¶€ë“œëŸ¬ì›€",
                    "ì•½í•œ ë¶ˆì—ì„œ ì˜¤ë˜ ì¡°ë ¤ì•¼ ë¶€ë“œëŸ¬ì›€"
                ]
            };

            Object.keys(tipsData).forEach(tip_item => {
                tips.push([tip_item].concat(tipsData[tip_item]));
            });

            return tips;
        }

        function downloadRecipe() {
            // ìƒˆ ì›Œí¬ë¶ ìƒì„±
            const wb = XLSX.utils.book_new();

            // ê° ì‹œíŠ¸ ë°ì´í„° ìƒì„± ë° ì¶”ê°€
            const sheets = [
                {name: "ì£¼ìš”ì‹ì¬ë£Œ", data: generateIngredients()},
                {name: "ì–‘ë…ì†ŒìŠ¤", data: generateSauces()},
                {name: "ìœ¡ìˆ˜ë² ì´ìŠ¤", data: generateBroth()},
                {name: "ì¡°ë¦¬ìˆœì„œ", data: generateCookingSteps()},
                {name: "ì¡°ë¦¬ì •ë³´", data: generateCookingInfo()},
                {name: "íŠ¹ì§•ë§›", data: generateTasteFeatures()},
                {name: "ì˜ì–‘ì •ë³´", data: generateNutrition()},
                {name: "ì„œë¹™ì¡°ë¦¬íŒ", data: generateServingTips()}
            ];

            sheets.forEach(sheet => {
                const ws = XLSX.utils.aoa_to_sheet(sheet.data);
                XLSX.utils.book_append_sheet(wb, ws, sheet.name);
            });

            // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
            XLSX.writeFile(wb, "êµ¬ì´ê³ ê¸°_ìƒì„¸ë ˆì‹œí”¼.xlsx");
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ ì¤€ë¹„ ì™„ë£Œ ìƒíƒœë¡œ ë³€ê²½
        window.addEventListener('load', function() {
            setTimeout(() => {
                document.getElementById('status').innerHTML = 'êµ¬ì´/ê³ ê¸° ì¹´í…Œê³ ë¦¬ì˜ 12ê°œ ìƒì„¸ë©”ë‰´ ë ˆì‹œí”¼ê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.';
                document.getElementById('status').className = 'status success';
                document.getElementById('downloadBtn').disabled = false;
            }, 1000);
        });
    </script>
</body>
</html>